(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},1538:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>d,originalPathname:()=>u,pages:()=>c,routeModule:()=>f,tree:()=>h});var i=r(7096),n=r(6132),s=r(7284),o=r.n(s),a=r(2564),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let h=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,8203)),"/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,8154)),"/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/app/page.tsx"],u="/page",d={require:r,loadChunk:()=>Promise.resolve()},f=new i.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:h}})},5562:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,3579,23)),Promise.resolve().then(r.t.bind(r,619,23)),Promise.resolve().then(r.t.bind(r,1459,23)),Promise.resolve().then(r.t.bind(r,3456,23)),Promise.resolve().then(r.t.bind(r,847,23)),Promise.resolve().then(r.t.bind(r,7303,23))},6182:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8469,23)),Promise.resolve().then(r.bind(r,2727)),Promise.resolve().then(r.bind(r,6980)),Promise.resolve().then(r.bind(r,4959))},2141:(e,t,r)=>{Promise.resolve().then(r.bind(r,4359))},8465:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let i=r(143);r(4218);let n=i._(r(3641));function s(e){return{default:(null==e?void 0:e.default)||e}}function o(e,t){let r=n.default,i={loading:e=>{let{error:t,isLoading:r,pastDelay:i}=e;return null}};"function"==typeof e&&(i.loader=e),Object.assign(i,t);let o=i.loader;return r({...i,loader:()=>null!=o?o().then(s):Promise.resolve(s(()=>null))})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9480:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NoSSR",{enumerable:!0,get:function(){return n}});let i=r(5158);function n(e){let{children:t}=e;return(0,i.throwWithNoSSR)(),t}},3641:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let i=r(143),n=i._(r(4218)),s=r(9480),o=function(e){let t=Object.assign({loader:null,loading:null,ssr:!0},e);function r(e){let r=t.loading,i=n.default.createElement(r,{isLoading:!0,pastDelay:!0,error:null}),o=t.ssr?n.default.Fragment:s.NoSSR,a=t.lazy;return n.default.createElement(n.default.Suspense,{fallback:i},n.default.createElement(o,null,n.default.createElement(a,e)))}return t.lazy=n.default.lazy(t.loader),r.displayName="LoadableComponent",r}},3978:(e,t,r)=>{"use strict";var i;e.exports=(i=r(4218),(()=>{var e={"./node_modules/css-mediaquery/index.js":/*!**********************************************!*\
  !*** ./node_modules/css-mediaquery/index.js ***!
  \**********************************************/(e,t)=>{t.match=function(e,t){return a(e).some(function(e){var r=e.inverse,i="all"===e.type||t.type===e.type;if(i&&r||!(i||r))return!1;var n=e.expressions.every(function(e){var r=e.feature,i=e.modifier,n=e.value,s=t[r];if(!s)return!1;switch(r){case"orientation":case"scan":return s.toLowerCase()===n.toLowerCase();case"width":case"height":case"device-width":case"device-height":n=c(n),s=c(s);break;case"resolution":n=h(n),s=h(s);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":n=l(n),s=l(s);break;case"grid":case"color":case"color-index":case"monochrome":n=parseInt(n,10)||1,s=parseInt(s,10)||0}switch(i){case"min":return s>=n;case"max":return s<=n;default:return s===n}});return n&&!r||!n&&r})},t.parse=a;var r=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,i=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,n=/^(?:(min|max)-)?(.+)/,s=/(em|rem|px|cm|mm|in|pt|pc)?$/,o=/(dpi|dpcm|dppx)?$/;function a(e){return e.split(",").map(function(e){var t=(e=e.trim()).match(r),s=t[1],o=t[2],a=t[3]||"",l={};return l.inverse=!!s&&"not"===s.toLowerCase(),l.type=o?o.toLowerCase():"all",a=a.match(/\([^\)]+\)/g)||[],l.expressions=a.map(function(e){var t=e.match(i),r=t[1].toLowerCase().match(n);return{modifier:r[1],feature:r[2],value:t[2]}}),l})}function l(e){var t,r=Number(e);return r||(r=(t=e.match(/^(\d+)\s*\/\s*(\d+)$/))[1]/t[2]),r}function h(e){var t=parseFloat(e);switch(String(e).match(o)[1]){case"dpcm":return t/2.54;case"dppx":return 96*t;default:return t}}function c(e){var t=parseFloat(e);switch(String(e).match(s)[1]){case"em":case"rem":return 16*t;case"cm":return 96*t/2.54;case"mm":return 96*t/2.54/10;case"in":return 96*t;case"pt":return 72*t;case"pc":return 72*t/12;default:return t}}},"./node_modules/hyphenate-style-name/index.js":/*!****************************************************!*\
  !*** ./node_modules/hyphenate-style-name/index.js ***!
  \****************************************************/(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var i=/[A-Z]/g,n=/^ms-/,s={};function o(e){return"-"+e.toLowerCase()}let a=function(e){if(s.hasOwnProperty(e))return s[e];var t=e.replace(i,o);return s[e]=n.test(t)?"-"+t:t}},"./node_modules/matchmediaquery/index.js":/*!***********************************************!*\
  !*** ./node_modules/matchmediaquery/index.js ***!
  \***********************************************/(e,t,r)=>{var i=r(/*! css-mediaquery */"./node_modules/css-mediaquery/index.js").match;function n(e,t,r){var n,s=this;function o(e){s.matches=e.matches,s.media=e.media}this.matches=i(e,t),this.media=e,this.addListener=function(e){n&&n.addListener(e)},this.removeListener=function(e){n&&n.removeListener(e)},this.dispose=function(){n&&n.removeListener(o)}}e.exports=function(e,t,r){return new n(e,t,r)}},"./node_modules/object-assign/index.js":/*!*********************************************!*\
  !*** ./node_modules/object-assign/index.js ***!
  \*********************************************/e=>{/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=!function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var i=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==i.join(""))return!1;var n={};if("abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},n)).join(""))return!1;return!0}catch(e){return!1}}()?function(e,n){for(var s,o,a=function(e){if(null==e)throw TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var h in s=Object(arguments[l]))r.call(s,h)&&(a[h]=s[h]);if(t){o=t(s);for(var c=0;c<o.length;c++)i.call(s,o[c])&&(a[o[c]]=s[o[c]])}}return a}:Object.assign},"./node_modules/prop-types/checkPropTypes.js":/*!***************************************************!*\
  !*** ./node_modules/prop-types/checkPropTypes.js ***!
  \***************************************************/(e,t,r)=>{var i=function(){},n=r(/*! ./lib/ReactPropTypesSecret */"./node_modules/prop-types/lib/ReactPropTypesSecret.js"),s={},o=r(/*! ./lib/has */"./node_modules/prop-types/lib/has.js");function a(e,t,r,a,l){for(var h in e)if(o(e,h)){var c;try{if("function"!=typeof e[h]){var u=Error((a||"React class")+": "+r+" type `"+h+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[h]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw u.name="Invariant Violation",u}c=e[h](t,h,a,r,null,n)}catch(e){c=e}if(!c||c instanceof Error||i((a||"React class")+": type specification of "+r+" `"+h+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof c+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),c instanceof Error&&!(c.message in s)){s[c.message]=!0;var d=l?l():"";i("Failed "+r+" type: "+c.message+(null!=d?d:""))}}}i=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw Error(t)}catch(e){}},a.resetWarningCache=function(){s={}},e.exports=a},"./node_modules/prop-types/factoryWithTypeCheckers.js":/*!************************************************************!*\
  !*** ./node_modules/prop-types/factoryWithTypeCheckers.js ***!
  \************************************************************/(e,t,r)=>{var i=r(/*! react-is */"./node_modules/react-is/index.js"),n=r(/*! object-assign */"./node_modules/object-assign/index.js"),s=r(/*! ./lib/ReactPropTypesSecret */"./node_modules/prop-types/lib/ReactPropTypesSecret.js"),o=r(/*! ./lib/has */"./node_modules/prop-types/lib/has.js"),a=r(/*! ./checkPropTypes */"./node_modules/prop-types/checkPropTypes.js"),l=function(){};function h(){return null}l=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw Error(t)}catch(e){}},e.exports=function(e,t){var r="function"==typeof Symbol&&Symbol.iterator,c="<<anonymous>>",u={array:g("array"),bigint:g("bigint"),bool:g("boolean"),func:g("function"),number:g("number"),object:g("object"),string:g("string"),symbol:g("symbol"),any:f(h),arrayOf:function(e){return f(function(t,r,i,n,o){if("function"!=typeof e)return new d("Property `"+o+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var a=t[r];if(!Array.isArray(a))return new d("Invalid "+n+" `"+o+"` of type `"+m(a)+"` supplied to `"+i+"`, expected an array.");for(var l=0;l<a.length;l++){var h=e(a,l,i,n,o+"["+l+"]",s);if(h instanceof Error)return h}return null})},element:f(function(t,r,i,n,s){var o=t[r];return e(o)?null:new d("Invalid "+n+" `"+s+"` of type `"+m(o)+"` supplied to `"+i+"`, expected a single ReactElement.")}),elementType:f(function(e,t,r,n,s){var o=e[t];return i.isValidElementType(o)?null:new d("Invalid "+n+" `"+s+"` of type `"+m(o)+"` supplied to `"+r+"`, expected a single ReactElement type.")}),instanceOf:function(e){return f(function(t,r,i,n,s){if(!(t[r]instanceof e)){var o,a=e.name||c;return new d("Invalid "+n+" `"+s+"` of type `"+((o=t[r]).constructor&&o.constructor.name?o.constructor.name:c)+"` supplied to `"+i+"`, expected instance of `"+a+"`.")}return null})},node:f(function(t,i,n,s,o){return!function t(i){switch(typeof i){case"number":case"string":case"undefined":return!0;case"boolean":return!i;case"object":if(Array.isArray(i))return i.every(t);if(null===i||e(i))return!0;var n=function(e){var t=e&&(r&&e[r]||e["@@iterator"]);if("function"==typeof t)return t}(i);if(!n)return!1;var s,o=n.call(i);if(n!==i.entries){for(;!(s=o.next()).done;)if(!t(s.value))return!1}else for(;!(s=o.next()).done;){var a=s.value;if(a&&!t(a[1]))return!1}return!0;default:return!1}}(t[i])?new d("Invalid "+s+" `"+o+"` supplied to `"+n+"`, expected a ReactNode."):null}),objectOf:function(e){return f(function(t,r,i,n,a){if("function"!=typeof e)return new d("Property `"+a+"` of component `"+i+"` has invalid PropType notation inside objectOf.");var l=t[r],h=m(l);if("object"!==h)return new d("Invalid "+n+" `"+a+"` of type `"+h+"` supplied to `"+i+"`, expected an object.");for(var c in l)if(o(l,c)){var u=e(l,c,i,n,a+"."+c,s);if(u instanceof Error)return u}return null})},oneOf:function(e){return Array.isArray(e)?f(function(t,r,i,n,s){for(var o,a=t[r],l=0;l<e.length;l++)if(a===(o=e[l])?0!==a||1/a==1/o:a!=a&&o!=o)return null;var h=JSON.stringify(e,function(e,t){return"symbol"===v(t)?String(t):t});return new d("Invalid "+n+" `"+s+"` of value `"+String(a)+"` supplied to `"+i+"`, expected one of "+h+".")}):(arguments.length>1?l("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):l("Invalid argument supplied to oneOf, expected an array."),h)},oneOfType:function(e){if(!Array.isArray(e))return l("Invalid argument supplied to oneOfType, expected an instance of array."),h;for(var t=0;t<e.length;t++){var r=e[t];if("function"!=typeof r)return l("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+function(e){var t=v(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}(r)+" at index "+t+"."),h}return f(function(t,r,i,n,a){for(var l=[],h=0;h<e.length;h++){var c=(0,e[h])(t,r,i,n,a,s);if(null==c)return null;c.data&&o(c.data,"expectedType")&&l.push(c.data.expectedType)}return new d("Invalid "+n+" `"+a+"` supplied to `"+i+"`"+(l.length>0?", expected one of type ["+l.join(", ")+"]":"")+".")})},shape:function(e){return f(function(t,r,i,n,o){var a=t[r],l=m(a);if("object"!==l)return new d("Invalid "+n+" `"+o+"` of type `"+l+"` supplied to `"+i+"`, expected `object`.");for(var h in e){var c=e[h];if("function"!=typeof c)return p(i,n,o,h,v(c));var u=c(a,h,i,n,o+"."+h,s);if(u)return u}return null})},exact:function(e){return f(function(t,r,i,a,l){var h=t[r],c=m(h);if("object"!==c)return new d("Invalid "+a+" `"+l+"` of type `"+c+"` supplied to `"+i+"`, expected `object`.");var u=n({},t[r],e);for(var f in u){var g=e[f];if(o(e,f)&&"function"!=typeof g)return p(i,a,l,f,v(g));if(!g)return new d("Invalid "+a+" `"+l+"` key `"+f+"` supplied to `"+i+"`.\nBad object: "+JSON.stringify(t[r],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var y=g(h,f,i,a,l+"."+f,s);if(y)return y}return null})}};function d(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function f(e){var r={},i=0;function n(n,o,a,h,u,f,g){if(h=h||c,f=f||a,g!==s){if(t){var p=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}if("undefined"!=typeof console){var m=h+":"+a;!r[m]&&i<3&&(l("You are manually calling a React.PropTypes validation function for the `"+f+"` prop on `"+h+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),r[m]=!0,i++)}}return null!=o[a]?e(o,a,h,u,f):n?new d(null===o[a]?"The "+u+" `"+f+"` is marked as required in `"+h+"`, but its value is `null`.":"The "+u+" `"+f+"` is marked as required in `"+h+"`, but its value is `undefined`."):null}var o=n.bind(null,!1);return o.isRequired=n.bind(null,!0),o}function g(e){return f(function(t,r,i,n,s,o){var a=t[r];return m(a)!==e?new d("Invalid "+n+" `"+s+"` of type `"+v(a)+"` supplied to `"+i+"`, expected `"+e+"`.",{expectedType:e}):null})}function p(e,t,r,i,n){return new d((e||"React class")+": "+t+" type `"+r+"."+i+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+n+"`.")}function m(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":"symbol"===t||e&&("Symbol"===e["@@toStringTag"]||"function"==typeof Symbol&&e instanceof Symbol)?"symbol":t}function v(e){if(null==e)return""+e;var t=m(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}return d.prototype=Error.prototype,u.checkPropTypes=a,u.resetWarningCache=a.resetWarningCache,u.PropTypes=u,u}},"./node_modules/prop-types/index.js":/*!******************************************!*\
  !*** ./node_modules/prop-types/index.js ***!
  \******************************************/(e,t,r)=>{var i=r(/*! react-is */"./node_modules/react-is/index.js");e.exports=r(/*! ./factoryWithTypeCheckers */"./node_modules/prop-types/factoryWithTypeCheckers.js")(i.isElement,!0)},"./node_modules/prop-types/lib/ReactPropTypesSecret.js":/*!*************************************************************!*\
  !*** ./node_modules/prop-types/lib/ReactPropTypesSecret.js ***!
  \*************************************************************/e=>{e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},"./node_modules/prop-types/lib/has.js":/*!********************************************!*\
  !*** ./node_modules/prop-types/lib/has.js ***!
  \********************************************/e=>{e.exports=Function.call.bind(Object.prototype.hasOwnProperty)},"./node_modules/react-is/cjs/react-is.development.js":/*!***********************************************************!*\
  !*** ./node_modules/react-is/cjs/react-is.development.js ***!
  \***********************************************************/(e,t)=>{!function(){var e="function"==typeof Symbol&&Symbol.for,r=e?Symbol.for("react.element"):60103,i=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,o=e?Symbol.for("react.profiler"):60114,a=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,h=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,f=e?Symbol.for("react.suspense_list"):60120,g=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,y=e?Symbol.for("react.responder"):60118,x=e?Symbol.for("react.scope"):60119;function _(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:var f=e.type;switch(f){case h:case c:case n:case o:case s:case d:return f;default:var m=f&&f.$$typeof;switch(m){case l:case u:case p:case g:case a:return m;default:return t}}case i:return t}}}var b=!1;function C(e){return _(e)===c}t.AsyncMode=h,t.ConcurrentMode=c,t.ContextConsumer=l,t.ContextProvider=a,t.Element=r,t.ForwardRef=u,t.Fragment=n,t.Lazy=p,t.Memo=g,t.Portal=i,t.Profiler=o,t.StrictMode=s,t.Suspense=d,t.isAsyncMode=function(e){return b||(b=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),C(e)||_(e)===h},t.isConcurrentMode=C,t.isContextConsumer=function(e){return _(e)===l},t.isContextProvider=function(e){return _(e)===a},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return _(e)===u},t.isFragment=function(e){return _(e)===n},t.isLazy=function(e){return _(e)===p},t.isMemo=function(e){return _(e)===g},t.isPortal=function(e){return _(e)===i},t.isProfiler=function(e){return _(e)===o},t.isStrictMode=function(e){return _(e)===s},t.isSuspense=function(e){return _(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===c||e===o||e===s||e===d||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===g||e.$$typeof===a||e.$$typeof===l||e.$$typeof===u||e.$$typeof===v||e.$$typeof===y||e.$$typeof===x||e.$$typeof===m)},t.typeOf=_}()},"./node_modules/react-is/index.js":/*!****************************************!*\
  !*** ./node_modules/react-is/index.js ***!
  \****************************************/(e,t,r)=>{e.exports=r(/*! ./cjs/react-is.development.js */"./node_modules/react-is/cjs/react-is.development.js")},"./node_modules/shallow-equal/dist/index.esm.js":/*!******************************************************!*\
  !*** ./node_modules/shallow-equal/dist/index.esm.js ***!
  \******************************************************/(e,t,r)=>{function i(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=Object.keys(e),i=Object.keys(t),n=r.length;if(i.length!==n)return!1;for(var s=0;s<n;s++){var o=r[s];if(e[o]!==t[o]||!Object.prototype.hasOwnProperty.call(t,o))return!1}return!0}function n(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=e.length;if(t.length!==r)return!1;for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}r.r(t),r.d(t,{shallowEqualArrays:()=>n,shallowEqualObjects:()=>i})},"./src/Component.ts":/*!**************************!*\
  !*** ./src/Component.ts ***!
  \**************************/function(e,t,r){var i=this&&this.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(r(/*! ./useMediaQuery */"./src/useMediaQuery.ts"));t.default=function(e){var t=e.children,r=e.device,n=e.onChange,o=i(e,["children","device","onChange"]),a=(0,s.default)(o,r,n);return"function"==typeof t?t(a):a?t:null}},"./src/Context.ts":/*!************************!*\
  !*** ./src/Context.ts ***!
  \************************/(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=(0,r(/*! react */"react").createContext)(void 0);t.default=i},"./src/index.ts":/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/function(e,t,r){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Context=t.toQuery=t.useMediaQuery=t.default=void 0;var n=i(r(/*! ./useMediaQuery */"./src/useMediaQuery.ts"));t.useMediaQuery=n.default;var s=i(r(/*! ./Component */"./src/Component.ts"));t.default=s.default;var o=i(r(/*! ./toQuery */"./src/toQuery.ts"));t.toQuery=o.default;var a=i(r(/*! ./Context */"./src/Context.ts"));t.Context=a.default},"./src/mediaQuery.ts":/*!***************************!*\
  !*** ./src/mediaQuery.ts ***!
  \***************************/function(e,t,r){var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=s(r(/*! prop-types */"./node_modules/prop-types/index.js")),a=o.default.oneOfType([o.default.string,o.default.number]),l={all:o.default.bool,grid:o.default.bool,aural:o.default.bool,braille:o.default.bool,handheld:o.default.bool,print:o.default.bool,projection:o.default.bool,screen:o.default.bool,tty:o.default.bool,tv:o.default.bool,embossed:o.default.bool},h={orientation:o.default.oneOf(["portrait","landscape"]),scan:o.default.oneOf(["progressive","interlace"]),aspectRatio:o.default.string,deviceAspectRatio:o.default.string,height:a,deviceHeight:a,width:a,deviceWidth:a,color:o.default.bool,colorIndex:o.default.bool,monochrome:o.default.bool,resolution:a,type:Object.keys(l)};h.type;var c=n(h,["type"]),u=i({minAspectRatio:o.default.string,maxAspectRatio:o.default.string,minDeviceAspectRatio:o.default.string,maxDeviceAspectRatio:o.default.string,minHeight:a,maxHeight:a,minDeviceHeight:a,maxDeviceHeight:a,minWidth:a,maxWidth:a,minDeviceWidth:a,maxDeviceWidth:a,minColor:o.default.number,maxColor:o.default.number,minColorIndex:o.default.number,maxColorIndex:o.default.number,minMonochrome:o.default.number,maxMonochrome:o.default.number,minResolution:a,maxResolution:a},c),d=i(i({},l),u);t.default={all:d,types:l,matchers:h,features:u}},"./src/toQuery.ts":/*!************************!*\
  !*** ./src/toQuery.ts ***!
  \************************/function(e,t,r){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(/*! hyphenate-style-name */"./node_modules/hyphenate-style-name/index.js")),s=i(r(/*! ./mediaQuery */"./src/mediaQuery.ts")),o=function(e,t){var r=(0,n.default)(e);return("number"==typeof t&&(t="".concat(t,"px")),!0===t)?r:!1===t?"not ".concat(r):"(".concat(r,": ").concat(t,")")};t.default=function(e){var t=[];return Object.keys(s.default.all).forEach(function(r){var i=e[r];null!=i&&t.push(o(r,i))}),t.join(" and ")}},"./src/useMediaQuery.ts":/*!******************************!*\
  !*** ./src/useMediaQuery.ts ***!
  \******************************/function(e,t,r){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(/*! react */"react"),s=i(r(/*! matchmediaquery */"./node_modules/matchmediaquery/index.js")),o=i(r(/*! hyphenate-style-name */"./node_modules/hyphenate-style-name/index.js")),a=r(/*! shallow-equal */"./node_modules/shallow-equal/dist/index.esm.js"),l=i(r(/*! ./toQuery */"./src/toQuery.ts")),h=i(r(/*! ./Context */"./src/Context.ts")),c=function(e){if(e)return Object.keys(e).reduce(function(t,r){return t[(0,o.default)(r)]=e[r],t},{})},u=function(){var e=(0,n.useRef)(!1);return(0,n.useEffect)(function(){e.current=!0},[]),e.current},d=function(e){var t=(0,n.useContext)(h.default),r=function(){return c(e)||c(t)},i=(0,n.useState)(r),s=i[0],o=i[1];return(0,n.useEffect)(function(){var e=r();(0,a.shallowEqualObjects)(s,e)||o(e)},[e,t]),s},f=function(e){var t=function(){return e.query||(0,l.default)(e)},r=(0,n.useState)(t),i=r[0],s=r[1];return(0,n.useEffect)(function(){var e=t();i!==e&&s(e)},[e]),i},g=function(e,t){var r=function(){return(0,s.default)(e,t||{},!!t)},i=(0,n.useState)(r),o=i[0],a=i[1],l=u();return(0,n.useEffect)(function(){if(l){var e=r();return a(e),function(){e&&e.dispose()}}},[e,t]),o},p=function(e){var t=(0,n.useState)(e.matches),r=t[0],i=t[1];return(0,n.useEffect)(function(){var t=function(e){i(e.matches)};return e.addListener(t),i(e.matches),function(){e.removeListener(t)}},[e]),r};t.default=function(e,t,r){var i=d(t),s=f(e);if(!s)throw Error("Invalid or missing MediaQuery!");var o=g(s,i),a=p(o),l=u();return(0,n.useEffect)(function(){l&&r&&r(a)},[a]),(0,n.useEffect)(function(){return function(){o&&o.dispose()}},[]),a}},react:/*!**************************************************************************************!*\
  !*** external {"commonjs":"react","commonjs2":"react","amd":"react","root":"React"} ***!
  \**************************************************************************************/e=>{e.exports=i}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,r),s.exports}return r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r("./src/index.ts")})())},4359:(e,t,r)=>{"use strict";let i,n,s,o;r.r(t),r.d(t,{default:()=>lk});var a,l,h,c,u,d,f,g,p,m,v,y,x,_,b,C,S,w,T,O,E,P,k,j,M,D,A,F,R=r(3854),L=r(4218),I=r.t(L,2);let N=L.forwardRef(function({title:e,titleId:t,...r},i){return L.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?L.createElement("title",{id:t},e):null,L.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))});var B=r(2727);let W="#000000";function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,i)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach(function(t){Y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Y(e,t,r){return(t=V(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function V(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}class G{constructor(){Y(this,"browserShadowBlurConstant",1),Y(this,"DPI",96),Y(this,"devicePixelRatio",1),Y(this,"perfLimitSizeTotal",2097152),Y(this,"maxCacheSideLimit",4096),Y(this,"minCacheSideLimit",256),Y(this,"disableStyleCopyPaste",!1),Y(this,"enableGLFiltering",!0),Y(this,"textureSize",4096),Y(this,"forceGLPutImageData",!1),Y(this,"cachesBoundsOfCurve",!0),Y(this,"fontPaths",{}),Y(this,"NUM_FRACTION_DIGITS",4)}}class q extends G{constructor(e){super(),this.configure(e)}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,e)}addFonts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.fontPaths=X(X({},this.fontPaths),e)}removeFonts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach(e=>{delete this.fontPaths[e]})}clearFonts(){this.fontPaths={}}restoreDefaults(e){let t=new G,r=(null==e?void 0:e.reduce((e,r)=>(e[r]=t[r],e),{}))||t;this.configure(r)}}let $=new q,K=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return console[e]("fabric",...r)};class Q extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class J extends Q{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class Z{}class ee extends Z{testPrecision(e,t){let r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,"precision ".concat(t," float;\nvoid main(){}")),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){let t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(e=>this.testPrecision(t,e)),K("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}let et={},er=!1,ei=()=>(er||($.configure({devicePixelRatio:window.devicePixelRatio||1}),i="ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,er=!0),{document,window,isTouchSupported:i,WebGLProbe:new ee,dispose(){},copyPasteData:et}),en=()=>n||ei(),es=()=>en().document,eo=()=>en().window;class Cache{constructor(){Y(this,"charWidthsCache",{}),Y(this,"boundsOfCurveCache",{})}getFontCache(e){let{fontFamily:t,fontStyle:r,fontWeight:i}=e;t=t.toLowerCase(),this.charWidthsCache[t]||(this.charWidthsCache[t]={});let n=this.charWidthsCache[t],s="".concat(r.toLowerCase(),"_").concat((i+"").toLowerCase());return n[s]||(n[s]={}),n[s]}clearFontCache(e){(e=(e||"").toLowerCase())?this.charWidthsCache[e]&&delete this.charWidthsCache[e]:this.charWidthsCache={}}limitDimsByArea(e){let{perfLimitSizeTotal:t}=$,r=Math.sqrt(t*e);return[Math.floor(r),Math.floor(t/r)]}}let ea=new Cache,el="6.0.0-beta16";function eh(){}let ec=Math.PI/2,eu=2*Math.PI,ed=Math.PI/180,ef=Object.freeze([1,0,0,1,0,0]),eg="center",ep="left",em="bottom",ev="right",ey="none",ex=/\r?\n/,e_="json";class eb{constructor(){this[e_]=new Map,this.svg=new Map}getClass(e){let t=this[e_].get(e);if(!t)throw new Q("No class registered for ".concat(e));return t}setClass(e,t){t?this[e_].set(t,e):(this[e_].set(e.type,e),this[e_].set(e.type.toLowerCase(),e))}getSVGClass(e){return this.svg.get(e)}setSVGClass(e,t){this.svg.set(null!=t?t:e.type.toLowerCase(),e)}}let eC=new eb;class eS extends Array{remove(e){let t=this.indexOf(e);t>-1&&this.splice(t,1)}cancelAll(){let e=this.splice(0);return e.forEach(e=>e.abort()),e}cancelByCanvas(e){if(!e)return[];let t=this.filter(t=>{var r;return t.target===e||"object"==typeof t.target&&(null===(r=t.target)||void 0===r?void 0:r.canvas)===e});return t.forEach(e=>e.abort()),t}cancelByTarget(e){if(!e)return[];let t=this.filter(t=>t.target===e);return t.forEach(e=>e.abort()),t}}let ew=new eS;class eT{constructor(){Y(this,"__eventListeners",{})}on(e,t){return(this.__eventListeners||(this.__eventListeners={}),"object"==typeof e)?(Object.entries(e).forEach(e=>{let[t,r]=e;this.on(t,r)}),()=>this.off(e)):t?(this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(t),()=>this.off(e,t)):()=>!1}once(e,t){if("object"==typeof e){let t=[];return Object.entries(e).forEach(e=>{let[r,i]=e;t.push(this.once(r,i))}),()=>t.forEach(e=>e())}if(!t)return()=>!1;{let r=this.on(e,function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.call(this,...i),r()});return r}}_removeEventListener(e,t){if(this.__eventListeners[e]){if(t){let r=this.__eventListeners[e],i=r.indexOf(t);i>-1&&r.splice(i,1)}else this.__eventListeners[e]=[]}}off(e,t){if(this.__eventListeners){if(void 0===e)for(let e in this.__eventListeners)this._removeEventListener(e);else"object"==typeof e?Object.entries(e).forEach(e=>{let[t,r]=e;this._removeEventListener(t,r)}):this._removeEventListener(e,t)}}fire(e,t){var r;if(!this.__eventListeners)return;let i=null===(r=this.__eventListeners[e])||void 0===r?void 0:r.concat();if(i)for(let e=0;e<i.length;e++)i[e].call(this,t||{})}}let eO=(e,t)=>{for(let r=e.length-1;r>=0;r--)if(t(e[r],r,e))return r;return -1},eE=(e,t)=>isNaN(e)&&"number"==typeof t?t:e,eP=(e,t)=>{let r=e.indexOf(t);return -1!==r&&e.splice(r,1),e},ek=e=>{if(0===e)return 1;switch(Math.abs(e)/ec){case 1:case 3:return 0;case 2:return -1}return Math.cos(e)},ej=e=>{if(0===e)return 0;let t=Math.sign(e);switch(e/ec){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(e)};class eM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"object"==typeof e?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new eM(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new eM(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new eM(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new eM(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new eM(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new eM(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new eM(this.x/e.x,this.y/e.y)}scalarDivide(e){return new eM(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new eM(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){let t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)}midPointFrom(e){return this.lerp(e)}min(e){return new eM(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new eM(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){let t=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=r}clone(){return new eM(this.x,this.y)}rotate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eD,r=ej(e),i=ek(e),n=this.subtract(t),s=new eM(n.x*i-n.y*r,n.x*r+n.y*i);return s.add(t)}transform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new eM(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}let eD=new eM(0,0),eA=e=>!!e&&Array.isArray(e._objects);function eF(e){class t extends e{constructor(){super(...arguments),Y(this,"_objects",[])}_onObjectAdded(e){}_onObjectRemoved(e){}_onStackOrderChanged(e){}add(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=this._objects.push(...t);return t.forEach(e=>this._onObjectAdded(e)),i}insertAt(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return this._objects.splice(e,0,...r),r.forEach(e=>this._onObjectAdded(e)),this._objects.length}remove(){let e=this._objects,t=[];for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];return i.forEach(r=>{let i=e.indexOf(r);-1!==i&&(e.splice(i,1),t.push(r),this._onObjectRemoved(r))}),t}forEachObject(e){this.getObjects().forEach((t,r,i)=>e(t,r,i))}getObjects(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?[...this._objects]:this._objects.filter(e=>e.isType(...t))}item(e){return this._objects[e]}isEmpty(){return 0===this._objects.length}size(){return this._objects.length}contains(e,r){return!!this._objects.includes(e)||!!r&&this._objects.some(r=>r instanceof t&&r.contains(e,!0))}complexity(){return this._objects.reduce((e,t)=>e+=t.complexity?t.complexity():0,0)}sendObjectToBack(e){return!!e&&e!==this._objects[0]&&(eP(this._objects,e),this._objects.unshift(e),this._onStackOrderChanged(e),!0)}bringObjectToFront(e){return!!e&&e!==this._objects[this._objects.length-1]&&(eP(this._objects,e),this._objects.push(e),this._onStackOrderChanged(e),!0)}sendObjectBackwards(e,t){if(!e)return!1;let r=this._objects.indexOf(e);if(0!==r){let i=this.findNewLowerIndex(e,r,t);return eP(this._objects,e),this._objects.splice(i,0,e),this._onStackOrderChanged(e),!0}return!1}bringObjectForward(e,t){if(!e)return!1;let r=this._objects.indexOf(e);if(r!==this._objects.length-1){let i=this.findNewUpperIndex(e,r,t);return eP(this._objects,e),this._objects.splice(i,0,e),this._onStackOrderChanged(e),!0}return!1}moveObjectTo(e,t){return e!==this._objects[t]&&(eP(this._objects,e),this._objects.splice(t,0,e),this._onStackOrderChanged(e),!0)}findNewLowerIndex(e,t,r){let i;if(r){i=t;for(let r=t-1;r>=0;--r)if(e.isOverlapping(this._objects[r])){i=r;break}}else i=t-1;return i}findNewUpperIndex(e,t,r){let i;if(r){i=t;for(let r=t+1;r<this._objects.length;++r)if(e.isOverlapping(this._objects[r])){i=r;break}}else i=t+1;return i}collectObjects(e){let{left:t,top:r,width:i,height:n}=e,{includeIntersecting:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=[],a=new eM(t,r),l=a.add(new eM(i,n));for(let e=this._objects.length-1;e>=0;e--){let t=this._objects[e];t.selectable&&t.visible&&(s&&t.intersectsWithRect(a,l)||t.isContainedWithinRect(a,l)||s&&t.containsPoint(a)||s&&t.containsPoint(l))&&o.push(t)}return o}}return t}class eR extends eT{_setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let t in e)this.set(t,e[t])}_setObject(e){for(let t in e)this._set(t,e[t])}set(e,t){return"object"==typeof e?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){let t=this.get(e);return"boolean"==typeof t&&this.set(e,!t),this}get(e){return this[e]}}function eL(e){return eo().requestAnimationFrame(e)}let eI=0,eN=()=>eI++,eB=()=>{let e=es().createElement("canvas");if(!e||void 0===e.getContext)throw new Q("Failed to create `canvas` element");return e},eW=()=>es().createElement("img"),eU=(e,t,r)=>e.toDataURL("image/".concat(t),r),eX=e=>!!e&&void 0!==e.getContext,eY=e=>e*ed,eH=e=>e/ed,ez=["translateX","translateY","angle"],eV=(e,t,r)=>new eM(e).transform(t,r),eG=e=>{let t=1/(e[0]*e[3]-e[1]*e[2]),r=[t*e[3],-t*e[1],-t*e[2],t*e[0],0,0],{x:i,y:n}=new eM(e[4],e[5]).transform(r,!0);return r[4]=-i,r[5]=-n,r},eq=(e,t,r)=>[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],r?0:e[0]*t[4]+e[2]*t[5]+e[4],r?0:e[1]*t[4]+e[3]*t[5]+e[5]],e$=(e,t)=>e.reduceRight((e,r)=>r?eq(r,e,t):e,ef),eK=e=>{let[t,r]=e;return Math.atan2(r,t)},eQ=e=>{let t=eK(e),r=Math.pow(e[0],2)+Math.pow(e[1],2),i=Math.sqrt(r),n=(e[0]*e[3]-e[2]*e[1])/i,s=Math.atan2(e[0]*e[2]+e[1]*e[3],r);return{angle:eH(t),scaleX:i,scaleY:n,skewX:eH(s),skewY:0,translateX:e[4]||0,translateY:e[5]||0}},eJ=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[1,0,0,1,e,t]};function eZ(){let{angle:e=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{x:t=0,y:r=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=eY(e),n=ek(i),s=ej(i);return[n,s,-s,n,t?t-(n*t-s*r):0,r?r-(s*t+n*r):0]}let e0=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return[e,0,0,t,0,0]},e1=e=>Math.tan(eY(e)),e2=e=>[1,0,e1(e),1,0,0],e5=e=>[1,e1(e),0,1,0,0],e4=e=>{let{scaleX:t=1,scaleY:r=1,flipX:i=!1,flipY:n=!1,skewX:s=0,skewY:o=0}=e;return e$([e0(i?-t:t,n?-r:r),s&&e2(s),o&&e5(o)],!0)},e3=e=>{let{translateX:t=0,translateY:r=0,angle:i=0}=e,n=H(e,ez);return e$([eJ(t,r),i&&eZ({angle:i}),e4(n)])},e6=function(e){let{signal:t,crossOrigin:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(i,n){let s;if(t&&t.aborted)return n(new J("loadImage"));let o=eW();t&&(s=function(e){o.src="",n(e)},t.addEventListener("abort",s,{once:!0}));let a=function(){o.onload=o.onerror=null,s&&(null==t||t.removeEventListener("abort",s)),i(o)};if(!e){a();return}o.onload=a,o.onerror=function(){s&&(null==t||t.removeEventListener("abort",s)),n(new Q("Error loading ".concat(o.src)))},r&&(o.crossOrigin=r),o.src=e})},e8=function(e){let{signal:t,reviver:r=eh}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((i,n)=>{let s=[];t&&t.addEventListener("abort",n,{once:!0}),Promise.all(e.map(e=>eC.getClass(e.type).fromObject(e,{signal:t,reviver:r}).then(t=>(r(e,t),s.push(t),t)))).then(i).catch(e=>{s.forEach(e=>{e.dispose&&e.dispose()}),n(e)}).finally(()=>{t&&t.removeEventListener("abort",n)})})},e9=function(e){let{signal:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((r,i)=>{let n=[];t&&t.addEventListener("abort",i,{once:!0});let s=Object.values(e).map(e=>e?e.colorStops?new(eC.getClass("gradient"))(e):e.type?e8([e],{signal:t}).then(e=>{let[t]=e;return n.push(t),t}):e.source?eC.getClass("pattern").fromObject(e,{signal:t}).then(e=>(n.push(e),e)):e:e),o=Object.keys(e);Promise.all(s).then(e=>e.reduce((e,t,r)=>(e[o[r]]=t,e),{})).then(r).catch(e=>{n.forEach(e=>{e.dispose&&e.dispose()}),i(e)}).finally(()=>{t&&t.removeEventListener("abort",i)})})},e7=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.reduce((t,r)=>(r in e&&(t[r]=e[r]),t),{})},te=(e,t)=>Object.keys(e).reduce((r,i)=>(t(e[i],i,e)&&(r[i]=e[i]),r),{}),tt={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},tr=()=>/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i,ti=()=>/^hsla?\(\s*([+-]?\d{1,3})\s*[\s|,]\s*(\d{1,3}%)\s*[\s|,]\s*(\d{1,3}%)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i,tn=()=>/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i,ts=(e,t,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e,to=(e,t,r,i)=>{let n,s;e/=255,t/=255,r/=255;let o=Math.max(e,t,r),a=Math.min(e,t,r),l=(o+a)/2;if(o===a)n=s=0;else{let i=o-a;switch(s=l>.5?i/(2-o-a):i/(o+a),o){case e:n=(t-r)/i+(t<r?6:0);break;case t:n=(r-e)/i+2;break;case r:n=(e-t)/i+4}n/=6}return[Math.round(360*n),Math.round(100*s),Math.round(100*l),i]},ta=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";return parseFloat(e)/(e.endsWith("%")?100:1)},tl=e=>Math.min(Math.round(e),255).toString(16).toUpperCase().padStart(2,"0"),th=e=>{let[t,r,i,n=1]=e,s=Math.round(.3*t+.59*r+.11*i);return[s,s,s,n]};class tc{constructor(e){if(e){if(e instanceof tc)this.setSource([...e._source]);else if(Array.isArray(e)){let[t,r,i,n=1]=e;this.setSource([t,r,i,n])}else this.setSource(this._tryParsingColor(e))}else this.setSource([0,0,0,1])}_tryParsingColor(e){return e in tt&&(e=tt[e]),"transparent"===e?[255,255,255,0]:tc.sourceFromHex(e)||tc.sourceFromRgb(e)||tc.sourceFromHsl(e)||[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){let[e,t,r]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(r,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){let[e,t,r]=to(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(r,"%)")}toHsla(){let[e,t,r,i]=to(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(r,"%,").concat(i,")")}toHex(){let e=this.toHexa();return e.slice(0,6)}toHexa(){let[e,t,r,i]=this.getSource();return"".concat(tl(e)).concat(tl(t)).concat(tl(r)).concat(tl(Math.round(255*i)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(th(this.getSource())),this}toBlackWhite(e){let[t,,,r]=th(this.getSource()),i=t<(e||127)?0:255;return this.setSource([i,i,i,r]),this}overlayWith(e){e instanceof tc||(e=new tc(e));let t=this.getSource(),r=e.getSource(),[i,n,s]=t.map((e,t)=>Math.round(.5*e+.5*r[t]));return this.setSource([i,n,s,t[3]]),this}static fromRgb(e){return tc.fromRgba(e)}static fromRgba(e){return new tc(tc.sourceFromRgb(e))}static sourceFromRgb(e){let t=e.match(tr());if(t){let[e,r,i]=t.slice(1,4).map(e=>{let t=parseFloat(e);return e.endsWith("%")?Math.round(2.55*t):t});return[e,r,i,ta(t[4])]}}static fromHsl(e){return tc.fromHsla(e)}static fromHsla(e){return new tc(tc.sourceFromHsl(e))}static sourceFromHsl(e){let t,r,i;let n=e.match(ti());if(!n)return;let s=(parseFloat(n[1])%360+360)%360/360,o=parseFloat(n[2])/100,a=parseFloat(n[3])/100;if(0===o)t=r=i=a;else{let e=a<=.5?a*(o+1):a+o-a*o,n=2*a-e;t=ts(n,e,s+1/3),r=ts(n,e,s),i=ts(n,e,s-1/3)}return[Math.round(255*t),Math.round(255*r),Math.round(255*i),ta(n[4])]}static fromHex(e){return new tc(tc.sourceFromHex(e))}static sourceFromHex(e){if(e.match(tn())){let t;let r=e.slice(e.indexOf("#")+1),i=r.length<=4;t=i?r.split("").map(e=>e+e):r.match(/.{2}/g);let[n,s,o,a=255]=t.map(e=>parseInt(e,16));return[n,s,o,a/255]}}}let tu=(e,t)=>parseFloat(Number(e).toFixed(t)),td=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,r=/\D{0,2}$/.exec(e),i=parseFloat(e),n=$.DPI;switch(null==r?void 0:r[0]){case"mm":return i*n/25.4;case"cm":return i*n/2.54;case"in":return i*n;case"pt":return i*n/72;case"pc":return i*n/72*12;case"em":return i*t;default:return i}},tf=e=>e&&e!==ey?[e.slice(1,4),e.slice(5,8)]:e===ey?[e,e]:["Mid","Mid"],tg=e=>{let[t,r]=e.trim().split(" "),[i,n]=tf(t);return{meetOrSlice:r||"meet",alignX:i,alignY:n}},tp=e=>"matrix("+e.map(e=>tu(e,$.NUM_FRACTION_DIGITS)).join(" ")+")",tm=function(e,t){let r,i,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(t){if(t.toLive)r="url(#SVGID_".concat(t.id,")");else{let e=new tc(t),n=e.getAlpha();r=e.toRgb(),1!==n&&(i=n.toString())}}else r="none";return n?"".concat(e,": ").concat(r,"; ").concat(i?"".concat(e,"-opacity: ").concat(i,"; "):""):"".concat(e,'="').concat(r,'" ').concat(i?"".concat(e,'-opacity="').concat(i,'" '):"")},tv=function(e,t){let{left:r,top:i,width:n,height:s}=t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$.NUM_FRACTION_DIGITS,a=tm("fill",e,!1),[l,h,c,u]=[r,i,n,s].map(e=>tu(e,o));return"<rect ".concat(a,' x="').concat(l,'" y="').concat(h,'" width="').concat(c,'" height="').concat(u,'"></rect>')},ty=e=>!!e&&void 0!==e.toLive,tx=e=>!!e&&"function"==typeof e.toObject,t_=e=>!!e&&void 0!==e.offsetX&&void 0!==e.source,tb=e=>!!e&&e.isType("Text","IText","Textbox"),tC=e=>!!e&&e.isType("Path");function tS(e){let t=e&&tw(e),r=0,i=0;if(!e||!t)return{left:r,top:i};let n=t.documentElement,s=t.body||{scrollLeft:0,scrollTop:0};for(;e&&(e.parentNode||e.host)&&((e=e.parentNode||e.host)===t?(r=s.scrollLeft||n.scrollLeft||0,i=s.scrollTop||n.scrollTop||0):(r+=e.scrollLeft||0,i+=e.scrollTop||0),1!==e.nodeType||"fixed"!==e.style.position););return{left:r,top:i}}let tw=e=>e.ownerDocument||null,tT=e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView)||null};function tO(e,t){let r=e.style;r&&("string"==typeof t?e.style.cssText+=";"+t:Object.entries(t).forEach(e=>{let[t,i]=e;return r.setProperty(t,i)}))}let tE=function(e,t,r){let{width:i,height:n}=r,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;e.width=i,e.height=n,s>1&&(e.setAttribute("width",(i*s).toString()),e.setAttribute("height",(n*s).toString()),t.scale(s,s))},tP=(e,t)=>{let{width:r,height:i}=t;r&&(e.style.width="number"==typeof r?"".concat(r,"px"):r),i&&(e.style.height="number"==typeof i?"".concat(i,"px"):i)};function tk(e){return void 0!==e.onselectstart&&(e.onselectstart=()=>!1),e.style.userSelect=ey,e}class tj{constructor(e){Y(this,"_originalCanvasStyle",void 0),Y(this,"lower",void 0);let t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){let t=eX(e)?e:e&&es().getElementById(e)||eB();if(t.hasAttribute("data-fabric"))throw new Q("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:r}=e,{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width","".concat(t)),i.setAttribute("height","".concat(r)),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){let{el:r,ctx:i}=this.lower;tE(r,i,e,t)}setCSSDimensions(e){tP(this.lower.el,e)}calcOffset(){return function(e){var t;let r={left:0,top:0},i=e&&tw(e),n={left:0,top:0},s={borderLeftWidth:ep,borderTopWidth:"top",paddingLeft:ep,paddingTop:"top"};if(!i)return n;let o=(null===(t=tT(e))||void 0===t?void 0:t.getComputedStyle(e,null))||{};for(let e in s)n[s[e]]+=parseInt(o[e],10)||0;let a=i.documentElement;void 0!==e.getBoundingClientRect&&(r=e.getBoundingClientRect());let l=tS(e);return{left:r.left+l.left-(a.clientLeft||0)+n.left,top:r.top+l.top-(a.clientTop||0)+n.top}}(this.lower.el)}dispose(){en().dispose(this.lower.el),delete this.lower}}let tM={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...ef]};class tD extends eF(eR){get lowerCanvasEl(){var e;return null===(e=this.elements.lower)||void 0===e?void 0:e.el}get contextContainer(){var e;return null===(e=this.elements.lower)||void 0===e?void 0:e.ctx}static getDefaults(){return tD.ownDefaults}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new tj(e)}add(){let e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n=super.insertAt(e,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),n}remove(){let e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(K("warn","Canvas is trying to add an object that belongs to a different canvas.\nResulting to default behavior: removing object from previous canvas and adding to new canvas"),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}_isRetinaScaling(){return $.devicePixelRatio>1&&this.enableRetinaScaling}getRetinaScaling(){return this._isRetinaScaling()?Math.max(1,$.devicePixelRatio):1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setDimensions({width:e},t)}setHeight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t){let t=X({width:this.width,height:this.height},e);this.elements.setDimensions(t,this.getRetinaScaling()),this.hasLostContext=!0,this.width=t.width,this.height=t.height}r||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e){let{cssOnly:t=!1,backstoreOnly:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._setDimensionsImpl(e,{cssOnly:t,backstoreOnly:r}),t||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){let t=this.backgroundImage,r=this.overlayImage,i=this._objects.length;this.viewportTransform=e;for(let e=0;e<i;e++){let t=this._objects[e];t.group||t.setCoords()}t&&t.setCoords(),r&&r.setCoords(),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){let r=[...this.viewportTransform],i=eV(e,eG(r));r[0]=t,r[3]=t;let n=eV(i,r);r[4]+=e.x-n.x,r[5]+=e.y-n.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new eM(0,0),e)}absolutePan(e){let t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new eM(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=eL(()=>this.renderAndReset()))}calcViewportBoundaries(){let e=this.width,t=this.height,r=eG(this.viewportTransform),i=eV({x:0,y:0},r),n=eV({x:e,y:t},r),s=i.min(n),o=i.max(n);return this.vptCoords={tl:s,tr:new eM(o.x,s.y),bl:new eM(s.x,o.y),br:o}}cancelRequestedRender(){var e;this.nextRenderHandle&&(e=this.nextRenderHandle,eo().cancelAnimationFrame(e),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;let r=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.drawControls(e),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,i)),this._renderOverlay(e),this.controlsAboveOverlay&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){let r=this.viewportTransform;e.save(),e.transform(...r),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let r=0,i=t.length;r<i;++r)t[r]&&t[r].render(e)}_renderBackgroundOrOverlay(e,t){let r=this["".concat(t,"Color")],i=this["".concat(t,"Image")],n=this.viewportTransform,s=this["".concat(t,"Vpt")];if(!r&&!i)return;let o=ty(r);if(r){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=o?r.toLive(e):r,s&&e.transform(...n),o){e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);let t=r.gradientTransform||r.patternTransform;t&&e.transform(...t)}e.fill(),e.restore()}if(i){e.save();let{skipOffscreen:t}=this;this.skipOffscreen=s,s&&e.transform(...n),i.render(e),this.skipOffscreen=t,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new eM(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new eM(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new eM(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new eM(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new eM(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return eV(this.getCenterPoint(),eG(this.viewportTransform))}_centerObject(e,t){e.setXY(t,eg,eg),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){let r=this.clipPath,i=r&&!r.excludeFromExport?this._toObject(r,e,t):null;return X(X(X({version:el},e7(this,t)),{},{objects:this._objects.filter(e=>!e.excludeFromExport).map(r=>this._toObject(r,e,t))},this.__serializeBgOverlay(e,t)),i?{clipPath:i}:null)}_toObject(e,t,r){let i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);let n=e[t](r);return this.includeDefaultValues||(e.includeDefaultValues=!!i),n}__serializeBgOverlay(e,t){let r={},i=this.backgroundImage,n=this.overlayImage,s=this.backgroundColor,o=this.overlayColor;return ty(s)?s.excludeFromExport||(r.background=s.toObject(t)):s&&(r.background=s),ty(o)?o.excludeFromExport||(r.overlay=o.toObject(t)):o&&(r.overlay=o),i&&!i.excludeFromExport&&(r.backgroundImage=this._toObject(i,e,t)),n&&!n.excludeFromExport&&(r.overlayImage=this._toObject(n,e,t)),r}toSVG(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;let r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,')" >\n')),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",t),this._setSVGObjects(r,t),this.clipPath&&r.push("</g>\n"),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",t),r.push("</svg>"),r.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')}_setSVGHeader(e,t){let r;let i=t.width||"".concat(this.width),n=t.height||"".concat(this.height),s=$.NUM_FRACTION_DIGITS,o=t.viewBox;if(o)r='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){let e=this.viewportTransform;r='viewBox="'.concat(tu(-e[4]/e[0],s)," ").concat(tu(-e[5]/e[3],s)," ").concat(tu(this.width/e[0],s)," ").concat(tu(this.height/e[3],s),'" ')}else r='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',i,'" ','height="',n,'" ',r,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",el,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),"</defs>\n")}createSVGClipPathMarkup(e){let t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(eN()),'<clipPath id="'.concat(t.clipPathId,'" >\n').concat(t.toClipPathSVG(e.reviver),"</clipPath>\n")):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{let t=this["".concat(e,"Color")];if(ty(t)){let r=this["".concat(e,"Vpt")],i=this.viewportTransform,n={isType:()=>!1,width:this.width/(r?i[0]:1),height:this.height/(r?i[3]:1)};return t.toSVG(n,{additionalTransform:r?tp(i):""})}}).join("")}createSVGFontFacesMarkup(){let e=[],t={},r=$.fontPaths;this._objects.forEach(function t(r){e.push(r),eA(r)&&r._objects.forEach(t)}),e.forEach(e=>{if(!tb(e))return;let{styles:i,fontFamily:n}=e;!t[n]&&r[n]&&(t[n]=!0,i&&Object.values(i).forEach(e=>{Object.values(e).forEach(e=>{let{fontFamily:i=""}=e;!t[i]&&r[i]&&(t[i]=!0)})}))});let i=Object.keys(t).map(e=>"		@font-face {\n			font-family: '".concat(e,"';\n			src: url('").concat(r[e],"');\n		}\n")).join("");return i?'	<style type="text/css"><![CDATA[\n'.concat(i,"]]></style>\n"):""}_setSVGObjects(e,t){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(e,r,t)})}_setSVGObject(e,t,r){e.push(t.toSVG(r))}_setSVGBgOverlayImage(e,t,r){let i=this[t];i&&!i.excludeFromExport&&i.toSVG&&e.push(i.toSVG(r))}_setSVGBgOverlayColor(e,t){let r=this["".concat(t,"Color")];if(r){if(ty(r)){let i=r.repeat||"",n=this.width,s=this.height,o=this["".concat(t,"Vpt")],a=o?tp(eG(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(n/2,",").concat(s/2,')" x="').concat(r.offsetX-n/2,'" y="').concat(r.offsetY-s/2,'" width="').concat(("repeat-y"===i||"no-repeat"===i)&&t_(r)?r.source.width:n,'" height="').concat(("repeat-x"===i||"no-repeat"===i)&&t_(r)?r.source.height:s,'" fill="url(#SVGID_').concat(r.id,')"></rect>\n'))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',"></rect>\n")}}loadFromJSON(e,t){let{signal:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e)return Promise.reject(new Q("`json` is undefined"));let i="string"==typeof e?JSON.parse(e):e,{objects:n=[],backgroundImage:s,background:o,overlayImage:a,overlay:l,clipPath:h}=i,c=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([e8(n,{reviver:t,signal:r}),e9({backgroundImage:s,backgroundColor:o,overlayImage:a,overlayColor:l,clipPath:h},{signal:r})]).then(e=>{let[t,r]=e;return this.clear(),this.add(...t),this.set(i),this.set(r),this.renderOnAddRemove=c,this})}clone(e){let t=this.toObject(e),r=this.cloneWithoutData();return r.loadFromJSON(t)}cloneWithoutData(){let e=eB();return e.width=this.width,e.height=this.height,new this.constructor(e)}toDataURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{format:t="png",quality:r=1,multiplier:i=1,enableRetinaScaling:n=!1}=e,s=i*(n?this.getRetinaScaling():1);return eU(this.toCanvasElement(s,e),t,r)}toCanvasElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,{width:t,height:r,left:i,top:n,filter:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(t||this.width)*e,a=(r||this.height)*e,l=this.getZoom(),h=this.width,c=this.height,u=l*e,d=this.viewportTransform,f=(d[4]-(i||0))*e,g=(d[5]-(n||0))*e,p=this.enableRetinaScaling,m=eB(),v=s?this._objects.filter(e=>s(e)):this._objects;return m.width=o,m.height=a,this.enableRetinaScaling=!1,this.viewportTransform=[u,0,0,u,f,g],this.width=o,this.height=a,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),v),this.viewportTransform=d,this.width=h,this.height=c,this.calcViewportBoundaries(),this.enableRetinaScaling=p,m}dispose(){return this.disposed||this.elements.cleanupDOM({width:this.width,height:this.height}),ew.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{let r=()=>{this.destroy(),e(!0)};r.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}Y(tD,"ownDefaults",tM);let tA=["touchstart","touchmove","touchend"],tF=e=>{let t=e.target,r=tS(t),i=function(e){let t=e.changedTouches;return t&&t[0]?t[0]:e}(e);return new eM(i.clientX+r.left,i.clientY+r.top)},tR=e=>tA.includes(e.type)||"touch"===e.pointerType,tL=e=>{e.preventDefault(),e.stopPropagation()},tI=e=>{if(0===e.length)return{left:0,top:0,width:0,height:0};let{min:t,max:r}=e.reduce((e,t)=>{let{min:r,max:i}=e;return{min:r.min(t),max:i.max(t)}},{min:new eM(e[0]),max:new eM(e[0])}),i=r.subtract(t);return{left:t.x,top:t.y,width:i.x,height:i.y}},tN=["translateX","translateY","scaleX","scaleY"],tB=(e,t)=>tW(e,eq(t,e.calcOwnMatrix())),tW=(e,t)=>{let r=eQ(t),{translateX:i,translateY:n,scaleX:s,scaleY:o}=r,a=H(r,tN),l=new eM(i,n);e.flipX=!1,e.flipY=!1,Object.assign(e,a),e.set({scaleX:s,scaleY:o}),e.setPositionByOrigin(l,eg,eg)},tU=e=>{e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},tX=e=>({scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}),tY=(e,t,r)=>{let i=e/2,n=t/2,s=[new eM(-i,-n),new eM(i,-n),new eM(-i,n),new eM(i,n)].map(e=>e.transform(r)),o=tI(s);return new eM(o.width,o.height)},tH=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ef,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ef;return eq(eG(t),e)},tz=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ef,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ef;return e.transform(tH(t,r))},tV=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ef,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ef;return e.transform(tH(t,r),!0)},tG=(e,t,r)=>{let i=tH(t,r);return tW(e,eq(i,e.calcOwnMatrix())),i},tq=(e,t)=>{var r;let{transform:{target:i}}=t;null===(r=i.canvas)||void 0===r||r.fire("object:".concat(e),X(X({},t),{},{target:i})),i.fire(e,t)},t$={left:-.5,top:-.5,center:0,bottom:.5,right:.5},tK=e=>"string"==typeof e?t$[e]:e-.5,tQ="not-allowed",tJ=(e,t,r,i)=>{if(!t||!e)return"drag";let n=i.controls[t];return n.getActionName(r,n,i)};function tZ(e){return e.originX===eg&&e.originY===eg}let t0=(e,t)=>e[t],t1=(e,t,r,i)=>({e:e,transform:t,pointer:new eM(r,i)});function t2(e,t){let r=e.getTotalAngle(),i=r+eH(Math.atan2(t.y,t.x))+360;return Math.round(i%360/45)}function t5(e,t,r,i,n){var s;let{target:o,corner:a}=e,l=o.controls[a],h=(null===(s=o.canvas)||void 0===s?void 0:s.getZoom())||1,c=o.padding/h,u=function(e,t,r,i){let n=e.getRelativeCenterPoint(),s=void 0!==r&&void 0!==i?e.translateToGivenOrigin(n,eg,eg,r,i):new eM(e.left,e.top),o=e.angle?t.rotate(-eY(e.angle),n):t;return o.subtract(s)}(o,new eM(i,n),t,r);return u.x>=c&&(u.x-=c),u.x<=-c&&(u.x+=c),u.y>=c&&(u.y-=c),u.y<=c&&(u.y+=c),u.x-=l.offsetX,u.y-=l.offsetY,u}let t4=(e,t,r,i)=>{let{target:n,offsetX:s,offsetY:o}=t,a=r-s,l=i-o,h=!t0(n,"lockMovementX")&&n.left!==a,c=!t0(n,"lockMovementY")&&n.top!==l;return h&&n.set(ep,a),c&&n.set("top",l),(h||c)&&tq("moving",t1(e,t,r,i)),h||c};class t3{getSvgStyles(e){let t=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):ey,n=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",a=this.strokeMiterLimit?this.strokeMiterLimit:"4",l=void 0!==this.opacity?this.opacity:"1",h=this.visible?"":" visibility: hidden;",c=e?"":this.getSvgFilter(),u=tm("fill",this.fill),d=tm("stroke",this.stroke);return[d,"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",n,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",a,"; ",u,"fill-rule: ",t,"; ","opacity: ",l,";",c,h].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'.concat(tp(r));return"".concat(i).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:r=""}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),n=e.indexOf("COMMON_PARTS");return e[n]=i,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let t,{noStyle:r,reviver:i,withShadow:n,additionalTransform:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r?"":'style="'.concat(this.getSvgStyles(),'" '),a=n?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=l&&l.absolutePositioned,u=this.stroke,d=this.fill,f=this.shadow,g=[],p=e.indexOf("COMMON_PARTS");l&&(l.clipPathId="CLIPPATH_".concat(eN()),t='<clipPath id="'.concat(l.clipPathId,'" >\n').concat(l.toClipPathSVG(i),"</clipPath>\n")),c&&g.push("<g ",a,this.getSvgCommons()," >\n"),g.push("<g ",this.getSvgTransform(!1),c?"":a+this.getSvgCommons()," >\n");let m=[o,h,r?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[p]=m,ty(d)&&g.push(d.toSVG(this)),ty(u)&&g.push(u.toSVG(this)),f&&g.push(f.toSVG(this)),l&&g.push(t),g.push(e.join("")),g.push("</g>\n"),c&&g.push("</g>\n"),i?i(g.join("")):g.join("")}addPaintOrder(){return"fill"!==this.paintFirst?' paint-order="'.concat(this.paintFirst,'" '):""}}let t6=(e,t,r,i)=>-r*Math.cos(e/i*ec)+r+t,t8=(e,t,r,i)=>(e/=i)<1/2.75?r*(7.5625*e*e)+t:e<2/2.75?r*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?r*(7.5625*(e-=2.25/2.75)*e+.9375)+t:r*(7.5625*(e-=2.625/2.75)*e+.984375)+t,t9=()=>!1;class t7{constructor(e){let{startValue:t,byValue:r,duration:i=500,delay:n=0,easing:s=t6,onStart:o=eh,onChange:a=eh,onComplete:l=eh,abort:h=t9,target:c}=e;Y(this,"_state","pending"),Y(this,"durationProgress",0),Y(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=n,this.easing=s,this._onStart=o,this._onChange=a,this._onComplete=l,this._abort=h,this.target=c,this.startValue=t,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return"aborted"===this._state||"completed"===this._state}start(){let e=e=>{"pending"===this._state&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>eL(e),this.delay):eL(e)}tick(e){let t=(e||+new Date)-this.startTime,r=Math.min(t,this.duration);this.durationProgress=r/this.duration;let{value:i,valueProgress:n}=this.calculate(r);this.value=Object.freeze(i),this.valueProgress=n,"aborted"!==this._state&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),eL(this.tick)))}register(){ew.push(this)}unregister(){ew.remove(this)}abort(){this._state="aborted",this.unregister()}}let re=["startValue","endValue"];class rt extends t7{constructor(e){let{startValue:t=0,endValue:r=100}=e;super(X(X({},H(e,re)),{},{startValue:t,byValue:r-t}))}calculate(e){let t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}let rr=["startValue","endValue"];class ri extends t7{constructor(e){let{startValue:t=[0],endValue:r=[100]}=e;super(X(X({},H(e,rr)),{},{startValue:t,byValue:r.map((e,r)=>e-t[r])}))}calculate(e){let t=this.startValue.map((t,r)=>this.easing(e,t,this.byValue[r],this.duration,r));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}let rn=(e,t,r)=>Math.max(e,Math.min(t,r)),rs=["startValue","endValue","easing","onChange","onComplete","abort"],ro=(e,t,r,i)=>t+r*(1-Math.cos(e/i*ec)),ra=e=>e&&((t,r,i)=>e(new tc(t).toRgba(),r,i));class rl extends t7{constructor(e){let{startValue:t,endValue:r,easing:i=ro,onChange:n,onComplete:s,abort:o}=e,a=H(e,rs),l=new tc(t).getSource(),h=new tc(r).getSource();super(X(X({},a),{},{startValue:l,byValue:h.map((e,t)=>e-l[t]),easing:i,onChange:ra(n),onComplete:ra(s),abort:ra(o)}))}calculate(e){let[t,r,i,n]=this.startValue.map((t,r)=>this.easing(e,t,this.byValue[r],this.duration,r)),s=[...[t,r,i].map(Math.round),rn(0,n,1)];return{value:s,valueProgress:s.map((e,t)=>0!==this.byValue[t]?Math.abs((e-this.startValue[t])/this.byValue[t]):0).find(e=>0!==e)||0}}}let rh=e=>Array.isArray(e.startValue)||Array.isArray(e.endValue);function rc(e){let t=rh(e)?new ri(e):new rt(e);return t.start(),t}let ru=new eM(1,0),rd=new eM,rf=(e,t)=>e.rotate(t),rg=(e,t)=>new eM(t).subtract(e),rp=e=>e.distanceFrom(rd),rm=(e,t)=>Math.atan2(r_(e,t),rb(e,t)),rv=e=>rm(ru,e),ry=e=>e.eq(rd)?e:e.scalarDivide(rp(e)),rx=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return ry(new eM(-e.y,e.x).scalarMultiply(t?1:-1))},r_=(e,t)=>e.x*t.y-e.y*t.x,rb=(e,t)=>e.x*t.x+e.y*t.y,rC=(e,t,r)=>{if(e.eq(t)||e.eq(r))return!0;let i=r_(t,r),n=r_(t,e),s=r_(r,e);return i>=0?n>=0&&s<=0:!(n<=0&&s>=0)};class rS{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.points=this.points.concat(t.filter(e=>!this.includes(e))),this}static isPointContained(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.eq(r))return e.eq(t);if(t.x===r.x)return e.x===t.x&&(i||e.y>=Math.min(t.y,r.y)&&e.y<=Math.max(t.y,r.y));if(t.y===r.y)return e.y===t.y&&(i||e.x>=Math.min(t.x,r.x)&&e.x<=Math.max(t.x,r.x));{let n=rg(t,r),s=rg(t,e),o=s.divide(n);return i?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){let r=new eM(e).setX(Math.min(e.x-1,...t.map(e=>e.x))),i=0;for(let n=0;n<t.length;n++){let s=this.intersectSegmentSegment(t[n],t[(n+1)%t.length],e,r);if(s.includes(e))return!0;i+=Number("Intersection"===s.status)}return i%2==1}static intersectLineLine(e,t,r,i){let n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],s=!(arguments.length>5)||void 0===arguments[5]||arguments[5],o=t.x-e.x,a=t.y-e.y,l=i.x-r.x,h=i.y-r.y,c=e.x-r.x,u=e.y-r.y,d=l*u-h*c,f=o*u-a*c,g=h*o-l*a;if(0!==g){let t=d/g,r=f/g;return(n||0<=t&&t<=1)&&(s||0<=r&&r<=1)?new rS("Intersection").append(new eM(e.x+t*o,e.y+t*a)):new rS}if(0!==d&&0!==f)return new rS("Parallel");{let o=n||s||rS.isPointContained(e,r,i)||rS.isPointContained(t,r,i)||rS.isPointContained(r,e,t)||rS.isPointContained(i,e,t);return new rS(o?"Coincident":void 0)}}static intersectSegmentLine(e,t,r,i){return rS.intersectLineLine(e,t,r,i,!1,!0)}static intersectSegmentSegment(e,t,r,i){return rS.intersectLineLine(e,t,r,i,!1,!1)}static intersectLinePolygon(e,t,r){let i=!(arguments.length>3)||void 0===arguments[3]||arguments[3],n=new rS,s=r.length;for(let o=0,a,l,h;o<s;o++){if(a=r[o],l=r[(o+1)%s],"Coincident"===(h=rS.intersectLineLine(e,t,a,l,i,!1)).status)return h;n.append(...h.points)}return n.points.length>0&&(n.status="Intersection"),n}static intersectSegmentPolygon(e,t,r){return rS.intersectLinePolygon(e,t,r,!1)}static intersectPolygonPolygon(e,t){let r=new rS,i=e.length,n=[];for(let s=0;s<i;s++){let o=e[s],a=e[(s+1)%i],l=rS.intersectSegmentPolygon(o,a,t);"Coincident"===l.status?(n.push(l),r.append(o,a)):r.append(...l.points)}return n.length>0&&n.length===e.length?new rS("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(e,t,r){let i=t.min(r),n=t.max(r),s=new eM(n.x,i.y),o=new eM(i.x,n.y);return rS.intersectPolygonPolygon(e,[i,s,n,o])}}class rw extends eR{_getTransformedDimensions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=X({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),r=t.strokeWidth,i=r,n=0;this.strokeUniform&&(i=0,n=r);let s=t.width+i,o=t.height+i,a=0===t.skewX&&0===t.skewY;return(a?new eM(s*t.scaleX,o*t.scaleY):tY(s,o,e4(t))).scalarAdd(n)}translateToGivenOrigin(e,t,r,i,n){let s=e.x,o=e.y,a=tK(i)-tK(t),l=tK(n)-tK(r);if(a||l){let e=this._getTransformedDimensions();s+=a*e.x,o+=l*e.y}return new eM(s,o)}translateToCenterPoint(e,t,r){let i=this.translateToGivenOrigin(e,t,r,eg,eg);return this.angle?i.rotate(eY(this.angle),e):i}translateToOriginPoint(e,t,r){let i=this.translateToGivenOrigin(e,eg,eg,t,r);return this.angle?i.rotate(eY(this.angle),e):i}getCenterPoint(){let e=this.getRelativeCenterPoint();return this.group?eV(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new eM(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,r){let i=this.translateToCenterPoint(e,t,r),n=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:n.x,top:n.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),ep,"top")}}class rT extends rw{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){let e=this.getRelativeXY();return this.group?eV(e,this.group.calcTransformMatrix()):e}setXY(e,t,r){this.group&&(e=eV(e,eG(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,r)}getRelativeXY(){return new eM(this.left,this.top)}setRelativeXY(e,t,r){this.setPositionByOrigin(e,t||this.originX,r||this.originY)}getCoords(){let{tl:e,tr:t,br:r,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),n=[e,t,r,i];if(this.group){let e=this.group.calcTransformMatrix();return n.map(t=>eV(t,e))}return n}intersectsWithRect(e,t){let r=rS.intersectPolygonRectangle(this.getCoords(),e,t);return"Intersection"===r.status}intersectsWithObject(e){let t=rS.intersectPolygonPolygon(this.getCoords(),e.getCoords());return"Intersection"===t.status||"Coincident"===t.status||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){let t=this.getCoords();return t.every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){let{left:r,top:i,width:n,height:s}=this.getBoundingRect();return r>=e.x&&r+n<=t.x&&i>=e.y&&i+s<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return rS.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords,r=this.getCoords();return!!(r.some(r=>r.x<=t.x&&r.x>=e.x&&r.y<=t.y&&r.y>=e.y)||this.intersectsWithRect(e,t))||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;if(this.intersectsWithRect(e,t))return!0;let r=this.getCoords().every(r=>(r.x>=t.x||r.x<=e.x)&&(r.y>=t.y||r.y<=e.y));return r&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return tI(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set("scaleX",e),this._set("scaleY",e),this.setCoords()}scaleToWidth(e){let t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){let t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return(null===(e=this.canvas)||void 0===e?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?eH(eK(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return(null===(e=this.canvas)||void 0===e?void 0:e.viewportTransform)||ef.concat()}calcACoords(){let e=eZ({angle:this.angle}),{x:t,y:r}=this.getRelativeCenterPoint(),i=eJ(t,r),n=eq(i,e),s=this._getTransformedDimensions(),o=s.x/2,a=s.y/2;return{tl:eV({x:-o,y:-a},n),tr:eV({x:o,y:-a},n),bl:eV({x:-o,y:a},n),br:eV({x:o,y:a},n)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="";return!e&&this.group&&(t=this.group.transformMatrixKey(e)+"_"),t+this.top+"_"+this.left+"_"+this.scaleX+"_"+this.scaleY+"_"+this.skewX+"_"+this.skewY+"_"+this.angle+"_"+this.originX+"_"+this.originY+"_"+this.width+"_"+this.height+"_"+this.strokeWidth+this.flipX+this.flipY}calcTransformMatrix(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;let r=this.transformMatrixKey(e),i=this.matrixCache;return i&&i.key===r?i.value:(this.group&&(t=eq(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:r,value:t},t)}calcOwnMatrix(){let e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;let r=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},n=e3(i);return this.ownMatrixCache={key:e,value:n},n}_getNonTransformedDimensions(){return new eM(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}}class rO extends rT{isDescendantOf(e){let{parent:t,group:r}=this;return t===e||r===e||this.canvas===e||!!t&&t.isDescendantOf(e)||!!r&&r!==t&&r.isDescendantOf(e)}getAncestors(e){let t=[],r=this;do{var i;(r=r instanceof rO?null!==(i=r.parent)&&void 0!==i?i:e?void 0:r.canvas:void 0)&&t.push(r)}while(r);return t}findCommonAncestors(e,t){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors(t)]};let r=this.getAncestors(t),i=e.getAncestors(t);if(0===r.length&&i.length>0&&this===i[i.length-1])return{fork:[],otherFork:[e,...i.slice(0,i.length-1)],common:[this]};for(let t=0,n;t<r.length;t++){if((n=r[t])===e)return{fork:[this,...r.slice(0,t)],otherFork:[],common:r.slice(t)};for(let s=0;s<i.length;s++){if(this===i[s])return{fork:[],otherFork:[e,...i.slice(0,s)],common:[this,...r]};if(n===i[s])return{fork:[this,...r.slice(0,t)],otherFork:[e,...i.slice(0,s)],common:r.slice(t)}}}return{fork:[this,...r],otherFork:[e,...i],common:[]}}hasCommonAncestors(e,t){let r=this.findCommonAncestors(e,t);return r&&!!r.common.length}isInFrontOf(e){if(this===e)return;let t=this.findCommonAncestors(e);if(!t)return;if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;let r=t.common[0];if(!r)return;let i=t.fork.pop(),n=t.otherFork.pop(),s=r._objects.indexOf(i),o=r._objects.indexOf(n);return s>-1&&s>o}}class rE extends rO{animate(e,t){return Object.entries(e).reduce((e,r)=>{let[i,n]=r;return e[i]=this._animate(i,n,t),e},{})}_animate(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.split("."),n=this.colorProperties.includes(i[i.length-1]),{easing:s,duration:o,abort:a,startValue:l,onChange:h,onComplete:c}=r,u={target:this,startValue:null!=l?l:i.reduce((e,t)=>e[t],this),endValue:t,easing:s,duration:o,abort:null==a?void 0:a.bind(this),onChange:(e,t,r)=>{i.reduce((t,r,n)=>(n===i.length-1&&(t[r]=e),t[r]),this),h&&h(e,t,r)},onComplete:(e,t,r)=>{this.setCoords(),c&&c(e,t,r)}};return n?function(e){let t=new rl(e);return t.start(),t}(u):rc(u)}}class rP{constructor(e){let t="string"==typeof e?rP.parseShadow(e):e;for(let e in Object.assign(this,this.constructor.ownDefaults),t)this[e]=t[e];this.id=eN()}static parseShadow(e){let t=e.trim(),[r,i=0,n=0,s=0]=(rP.reOffsetsAndBlur.exec(t)||[]).map(e=>parseFloat(e)||0),o=(t.replace(rP.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim();return{color:o,offsetX:i,offsetY:n,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){let t=rf(new eM(this.offsetX,this.offsetY),eY(-e.angle)),r=new tc(this.color),i=40,n=40;return e.width&&e.height&&(i=100*tu((Math.abs(t.x)+this.blur)/e.width,$.NUM_FRACTION_DIGITS)+20,n=100*tu((Math.abs(t.y)+this.blur)/e.height,$.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(n,'%" height="').concat(100+2*n,'%" x="-').concat(i,'%" width="').concat(100+2*i,'%" >\n	<feGaussianBlur in="SourceAlpha" stdDeviation="').concat(tu(this.blur?this.blur/2:0,$.NUM_FRACTION_DIGITS),'"></feGaussianBlur>\n	<feOffset dx="').concat(tu(t.x,$.NUM_FRACTION_DIGITS),'" dy="').concat(tu(t.y,$.NUM_FRACTION_DIGITS),'" result="oBlur" ></feOffset>\n	<feFlood flood-color="').concat(r.toRgb(),'" flood-opacity="').concat(r.getAlpha(),'"/>\n	<feComposite in2="oBlur" operator="in" />\n	<feMerge>\n		<feMergeNode></feMergeNode>\n		<feMergeNode in="SourceGraphic"></feMergeNode>\n	</feMerge>\n</filter>\n')}toObject(){let e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling},t=rP.ownDefaults;return this.includeDefaultValues?e:te(e,(e,r)=>e!==t[r])}}Y(rP,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),Y(rP,"reOffsetsAndBlur",/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/);let rk=e=>JSON.parse(JSON.stringify(e)),rj=["top",ep,"scaleX","scaleY","flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible","skewX","skewY"],rM=["fill","stroke","strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],rD=["extraParam"],rA=class e extends rE{static getDefaults(){return X({},e.ownDefaults)}get type(){let e=this.constructor.type;return"FabricObject"===e?"object":e.toLowerCase()}set type(e){K("warn","Setting type has no effect",e)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),Y(this,"_cacheContext",null),Object.assign(this,this.constructor.getDefaults()),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=eB(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){let t=e.width,r=e.height,i=$.maxCacheSideLimit,n=$.minCacheSideLimit;if(t<=i&&r<=i&&t*r<=$.perfLimitSizeTotal)return t<n&&(e.width=n),r<n&&(e.height=n),e;let[s,o]=ea.limitDimsByArea(t/r),a=rn(n,s,i),l=rn(n,o,i);return t>a&&(e.zoomX/=t/a,e.width=a,e.capped=!0),r>l&&(e.zoomY/=r/l,e.height=l,e.capped=!0),e}_getCacheCanvasDimensions(){let e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),r=t.x*e.x/this.scaleX,i=t.y*e.y/this.scaleY;return{width:r+2,height:i+2,zoomX:e.x,zoomY:e.y,x:r,y:i}}_updateCacheCanvas(){let e=this._cacheCanvas,t=this._cacheContext,r=this._limitCacheSize(this._getCacheCanvasDimensions()),i=$.minCacheSideLimit,n=r.width,s=r.height,o=r.zoomX,a=r.zoomY,l=n!==this.cacheWidth||s!==this.cacheHeight,h=this.zoomX!==o||this.zoomY!==a;if(!e||!t)return!1;let c,u,d=l||h,f=0,g=0,p=!1;if(l){let e=this._cacheCanvas.width,t=this._cacheCanvas.height,o=n>e||s>t;p=o||(n<.9*e||s<.9*t)&&e>i&&t>i,o&&!r.capped&&(n>i||s>i)&&(f=.1*n,g=.1*s)}return tb(this)&&this.path&&(d=!0,p=!0,f+=this.getHeightOfLine(0)*this.zoomX,g+=this.getHeightOfLine(0)*this.zoomY),!!d&&(p?(e.width=Math.ceil(n+f),e.height=Math.ceil(s+g)):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height)),c=r.x/2,u=r.y/2,this.cacheTranslationX=Math.round(e.width/2-c)+c,this.cacheTranslationY=Math.round(e.height/2-u)+u,this.cacheWidth=n,this.cacheHeight=s,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(o,a),this.zoomX=o,this.zoomY=a,!0)}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setOptions(e)}transform(e){let t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!t);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=$.NUM_FRACTION_DIGITS,r=this.clipPath&&!this.clipPath.excludeFromExport?X(X({},this.clipPath.toObject(e)),{},{inverted:this.clipPath.inverted,absolutePositioned:this.clipPath.absolutePositioned}):null,i=X(X({},e7(this,e)),{},{type:this.constructor.type,version:el,originX:this.originX,originY:this.originY,left:tu(this.left,t),top:tu(this.top,t),width:tu(this.width,t),height:tu(this.height,t),fill:tx(this.fill)?this.fill.toObject():this.fill,stroke:tx(this.stroke)?this.stroke.toObject():this.stroke,strokeWidth:tu(this.strokeWidth,t),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:tu(this.strokeMiterLimit,t),scaleX:tu(this.scaleX,t),scaleY:tu(this.scaleY,t),angle:tu(this.angle,t),flipX:this.flipX,flipY:this.flipY,opacity:tu(this.opacity,t),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:tu(this.skewX,t),skewY:tu(this.skewY,t)},r?{clipPath:r}:null);return this.includeDefaultValues?i:this._removeDefaultValues(i)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){let t=this.constructor.getDefaults(),r=Object.keys(t).length>0,i=r?t:Object.getPrototypeOf(this);return te(e,(e,t)=>{if(t===ep||"top"===t||"type"===t)return!0;let r=i[t];return e!==r&&!(Array.isArray(e)&&Array.isArray(r)&&0===e.length&&0===r.length)})}toString(){return"#<".concat(this.constructor.type,">")}getObjectScaling(){if(!this.group)return new eM(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=eQ(this.calcTransformMatrix());return new eM(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){let e=this.getObjectScaling();if(this.canvas){let t=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return e.scalarMultiply(t*r)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:0===e?1e-4:e}_set(e,t){let r=this[e]!==t;if(("scaleX"===e||"scaleY"===e)&&(t=this._constrainScale(t)),"scaleX"===e&&t<0?(this.flipX=!this.flipX,t*=-1):"scaleY"===e&&t<0?(this.flipY=!this.flipY,t*=-1):"shadow"!==e||!t||t instanceof rP?"dirty"===e&&this.group&&this.group.set("dirty",t):t=new rP(t),this[e]=t,r){let t=this.group&&this.group.isOnACache();this.constructor.cacheProperties.includes(e)?(this.dirty=!0,t&&this.group.set("dirty",!0)):t&&this.constructor.stateProperties.includes(e)&&this.group.set("dirty",!0)}return this}isNotVisible(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible}render(e){!this.isNotVisible()&&(!this.canvas||!this.canvas.skipOffscreen||this.group||this.isOnScreen())&&(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext&&(this.drawObject(this._cacheContext,e.forClipping),this.dirty=!1)}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0}hasStroke(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth}hasFill(){return this.fill&&"transparent"!==this.fill}needsItsOwnCache(){return!!("stroke"===this.paintFirst&&this.hasFill()&&this.hasStroke())&&!!this.shadow||!!this.clipPath}shouldCache(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching}willDrawShadow(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)}drawClipPathOnCache(e,t){if(e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",t.absolutePositioned){let t=eG(this.calcTransformMatrix());e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}drawObject(e,t){let r=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath),this.fill=r,this.stroke=i}_drawClipPath(e,t){t&&(t._set("canvas",this.canvas),t.shouldCache(),t._transformDone=!0,t.renderCache({forClipping:!0}),this.drawClipPathOnCache(e,t))}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!e&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned){if(this._cacheCanvas&&this._cacheContext&&!e){let e=this.cacheWidth/this.zoomX,t=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-t/2,e,t)}return!0}return!1}_renderBackground(e){if(!this.backgroundColor)return;let t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){let r=t.stroke;r&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,ty(r)?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:r}=t;r&&(ty(r)?(e.fillStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.fillStyle=r)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&0!==t.length&&(1&t.length&&t.push(...t),e.setLineDash(t))}_setShadow(e){if(!this.shadow)return;let t=this.shadow,r=this.canvas,i=this.getCanvasRetinaScaling(),[n,,,s]=(null==r?void 0:r.viewportTransform)||ef,o=n*i,a=s*i,l=t.nonScaling?new eM(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*$.browserShadowBlurConstant*(o+a)*(l.x+l.y)/4,e.shadowOffsetX=t.offsetX*o*l.x,e.shadowOffsetY=t.offsetY*a*l.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!ty(t))return{offsetX:0,offsetY:0};let r=t.gradientTransform||t.patternTransform,i=-this.width/2+t.offsetX||0,n=-this.height/2+t.offsetY||0;return"percentage"===t.gradientUnits?e.transform(this.width,0,0,this.height,i,n):e.transform(1,0,0,1,i,n),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:i,offsetY:n}}_renderPaintInOrder(e){"stroke"===this.paintFirst?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),"evenodd"===this.fillRule?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){let t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var r;let i=this._limitCacheSize(this._getCacheCanvasDimensions()),n=eB(),s=this.getCanvasRetinaScaling(),o=i.x/this.scaleX/s,a=i.y/this.scaleY/s;n.width=Math.ceil(o),n.height=Math.ceil(a);let l=n.getContext("2d");l&&(l.beginPath(),l.moveTo(0,0),l.lineTo(o,0),l.lineTo(o,a),l.lineTo(0,a),l.closePath(),l.translate(o/2,a/2),l.scale(i.zoomX/this.scaleX/s,i.zoomY/this.scaleY/s),this._applyPatternGradientTransform(l,t),l.fillStyle=t.toLive(e),l.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/i.zoomX,s*this.scaleY/i.zoomY),e.strokeStyle=null!==(r=l.createPattern(n,"no-repeat"))&&void 0!==r?r:"")}_findCenterFromElement(){return new eM(this.left+this.width/2,this.top+this.height/2)}clone(e){let t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){let t=this.toCanvasElement(e),r=eC.getClass("image");return new r(t)}toCanvasElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=tX(this),r=this.group,i=this.shadow,n=Math.abs,s=e.enableRetinaScaling?Math.max($.devicePixelRatio,1):1,o=(e.multiplier||1)*s;delete this.group,e.withoutTransform&&tU(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&tG(this,this.getViewportTransform()),this.setCoords();let a=eB(),l=this.getBoundingRect(),h=this.shadow,c=new eM;if(h){let e=h.blur,t=h.nonScaling?new eM(1,1):this.getObjectScaling();c.x=2*Math.round(n(h.offsetX)+e)*n(t.x),c.y=2*Math.round(n(h.offsetY)+e)*n(t.y)}let u=l.width+c.x,d=l.height+c.y;a.width=Math.ceil(u),a.height=Math.ceil(d);let f=new tD(a,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===e.format&&(f.backgroundColor="#fff"),this.setPositionByOrigin(new eM(f.width/2,f.height/2),eg,eg);let g=this.canvas;f._objects=[this],this.set("canvas",f),this.setCoords();let p=f.toCanvasElement(o||1,e);return this.set("canvas",g),this.shadow=i,r&&(this.group=r),this.set(t),this.setCoords(),f._objects=[],f.destroy(),p}toDataURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return eU(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){let{centeredRotation:t,originX:r,originY:i}=this;if(t){let{x:e,y:t}=this.getRelativeCenterPoint();this.originX=eg,this.originY=eg,this.left=e,this.top=t}if(this.set("angle",e),t){let{x:e,y:t}=this.translateToOriginPoint(this.getRelativeCenterPoint(),r,i);this.left=e,this.top=t,this.originX=r,this.originY=i}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){ew.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&en().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}static _fromObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{extraParam:r}=t,i=H(t,rD);return e9(rk(e),i).then(e=>{let t=X(X({},i),e);if(!r)return new this(t);{let{[r]:e,type:i}=t,n=H(t,[r,"type"].map(V));return new this(e,n)}})}static fromObject(e,t){return this._fromObject(e,t)}};Y(rA,"stateProperties",rj),Y(rA,"cacheProperties",rM),Y(rA,"ownDefaults",{originX:ep,originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:!0,noScaleCache:!0,strokeUniform:!1,dirty:!0,paintFirst:"fill",activeOn:"down",colorProperties:["fill","stroke","backgroundColor"],clipPath:void 0,inverted:!1,absolutePositioned:!1,FX_DURATION:500}),Y(rA,"type","FabricObject"),eC.setClass(rA),eC.setClass(rA,"object");let rF=(e,t)=>(r,i,n,s)=>{let o=t(r,i,n,s);return o&&tq(e,t1(r,i,n,s)),o};function rR(e){return(t,r,i,n)=>{let{target:s,originX:o,originY:a}=r,l=s.getRelativeCenterPoint(),h=s.translateToOriginPoint(l,o,a),c=e(t,r,i,n);return s.setPositionByOrigin(h,r.originX,r.originY),c}}let rL=rF("resizing",rR((e,t,r,i)=>{let n=t5(t,t.originX,t.originY,r,i);if(t.originX===eg||t.originX===ev&&n.x<0||t.originX===ep&&n.x>0){let{target:e}=t,r=e.strokeWidth/(e.strokeUniform?e.scaleX:1),i=tZ(t)?2:1,s=e.width,o=Math.ceil(Math.abs(n.x*i/e.scaleX)-r);return e.set("width",Math.max(o,0)),s!==e.width}return!1}));function rI(e,t,r,i,n){i=i||{};let s=this.sizeX||i.cornerSize||n.cornerSize,o=this.sizeY||i.cornerSize||n.cornerSize,a=void 0!==i.transparentCorners?i.transparentCorners:n.transparentCorners,l=!a&&(i.cornerStrokeColor||n.cornerStrokeColor),h=t,c=r,u;e.save(),e.fillStyle=i.cornerColor||n.cornerColor||"",e.strokeStyle=i.cornerStrokeColor||n.cornerStrokeColor||"",s>o?(u=s,e.scale(1,o/s),c=r*s/o):o>s?(u=o,e.scale(s/o,1),h=t*o/s):u=s,e.lineWidth=1,e.beginPath(),e.arc(h,c,u/2,0,eu,!1),e[a?"stroke":"fill"](),l&&e.stroke(),e.restore()}function rN(e,t,r,i,n){i=i||{};let s=this.sizeX||i.cornerSize||n.cornerSize,o=this.sizeY||i.cornerSize||n.cornerSize,a=void 0!==i.transparentCorners?i.transparentCorners:n.transparentCorners,l=!a&&(i.cornerStrokeColor||n.cornerStrokeColor),h=s/2,c=o/2;e.save(),e.fillStyle=i.cornerColor||n.cornerColor||"",e.strokeStyle=i.cornerStrokeColor||n.cornerStrokeColor||"",e.lineWidth=1,e.translate(t,r);let u=n.getTotalAngle();e.rotate(eY(u)),e["".concat(a?"stroke":"fill","Rect")](-h,-c,s,o),l&&e.strokeRect(-h,-c,s,o),e.restore()}class rB{constructor(e){Y(this,"visible",!0),Y(this,"actionName","scale"),Y(this,"angle",0),Y(this,"x",0),Y(this,"y",0),Y(this,"offsetX",0),Y(this,"offsetY",0),Y(this,"sizeX",0),Y(this,"sizeY",0),Y(this,"touchSizeX",0),Y(this,"touchSizeY",0),Y(this,"cursorStyle","crosshair"),Y(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,r,i){var n;let{tl:s,tr:o,br:a,bl:l}=i;return(null===(n=t.canvas)||void 0===n?void 0:n.getActiveObject())===t&&t.isControlVisible(e)&&rS.isPointInPolygon(r,[s,o,a,l])}getActionHandler(e,t,r){return this.actionHandler}getMouseDownHandler(e,t,r){return this.mouseDownHandler}getMouseUpHandler(e,t,r){return this.mouseUpHandler}cursorStyleHandler(e,t,r){return t.cursorStyle}getActionName(e,t,r){return t.actionName}getVisibility(e,t){var r,i;return null!==(r=null===(i=e._controlsVisibility)||void 0===i?void 0:i[t])&&void 0!==r?r:this.visible}setVisibility(e,t,r){this.visible=e}positionHandler(e,t,r,i){return new eM(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,r,i,n,s){let o=e$([eJ(r,i),eZ({angle:e}),e0((n?this.touchSizeX:this.sizeX)||t,(n?this.touchSizeY:this.sizeY)||t)]);return{tl:new eM(-.5,-.5).transform(o),tr:new eM(.5,-.5).transform(o),bl:new eM(-.5,.5).transform(o),br:new eM(.5,.5).transform(o)}}render(e,t,r,i,n){"circle"===((i=i||{}).cornerStyle||n.cornerStyle)?rI.call(this,e,t,r,i,n):rN.call(this,e,t,r,i,n)}}let rW=(e,t,r)=>r.lockRotation?tQ:t.cursorStyle,rU=rF("rotating",rR((e,t,r,i)=>{let{target:n,ex:s,ey:o,theta:a,originX:l,originY:h}=t,c=n.translateToOriginPoint(n.getRelativeCenterPoint(),l,h);if(t0(n,"lockRotation"))return!1;let u=Math.atan2(o-c.y,s-c.x),d=Math.atan2(i-c.y,r-c.x),f=eH(d-u+a);if(n.snapAngle&&n.snapAngle>0){let e=n.snapAngle,t=n.snapThreshold||e,r=Math.ceil(f/e)*e,i=Math.floor(f/e)*e;Math.abs(f-i)<t?f=i:Math.abs(f-r)<t&&(f=r)}f<0&&(f=360+f),f%=360;let g=n.angle!==f;return n.angle=f,g}));function rX(e,t){let r=t.canvas,i=e[r.uniScaleKey];return r.uniformScaling&&!i||!r.uniformScaling&&i}function rY(e,t,r){let i=t0(e,"lockScalingX"),n=t0(e,"lockScalingY");return!!i&&!!n||!t&&(!!i||!!n)&&!!r||!!i&&"x"===t||!!n&&"y"===t}let rH=["e","se","s","sw","w","nw","n","ne","e"],rz=(e,t,r)=>{let i=rX(e,r),n=0!==t.x&&0===t.y?"x":0===t.x&&0!==t.y?"y":"";if(rY(r,n,i))return tQ;let s=t2(r,t);return"".concat(rH[s],"-resize")};function rV(e,t,r,i){let n,s,o,a,l,h,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},u=t.target,d=c.by,f=rX(e,u),g=rY(u,d,f);if(g)return!1;if(t.gestureScale)s=t.scaleX*t.gestureScale,o=t.scaleY*t.gestureScale;else{if(n=t5(t,t.originX,t.originY,r,i),l="y"!==d?Math.sign(n.x||t.signX||1):1,h="x"!==d?Math.sign(n.y||t.signY||1):1,t.signX||(t.signX=l),t.signY||(t.signY=h),t0(u,"lockScalingFlip")&&(t.signX!==l||t.signY!==h))return!1;if(a=u._getTransformedDimensions(),f&&!d){let e=Math.abs(n.x)+Math.abs(n.y),{original:r}=t,i=Math.abs(a.x*r.scaleX/u.scaleX)+Math.abs(a.y*r.scaleY/u.scaleY),l=e/i;s=r.scaleX*l,o=r.scaleY*l}else s=Math.abs(n.x*u.scaleX/a.x),o=Math.abs(n.y*u.scaleY/a.y);tZ(t)&&(s*=2,o*=2),t.signX!==l&&"y"!==d&&(t.originX=-tK(t.originX)+.5,s*=-1,t.signX=l),t.signY!==h&&"x"!==d&&(t.originY=-tK(t.originY)+.5,o*=-1,t.signY=h)}let p=u.scaleX,m=u.scaleY;return d?("x"===d&&u.set("scaleX",s),"y"===d&&u.set("scaleY",o)):(t0(u,"lockScalingX")||u.set("scaleX",s),t0(u,"lockScalingY")||u.set("scaleY",o)),p!==u.scaleX||m!==u.scaleY}let rG=rF("scaling",rR((e,t,r,i)=>rV(e,t,r,i))),rq=rF("scaling",rR((e,t,r,i)=>rV(e,t,r,i,{by:"x"}))),r$=rF("scaling",rR((e,t,r,i)=>rV(e,t,r,i,{by:"y"}))),rK=["target","ex","ey","skewingSide"],rQ={x:{counterAxis:"y",scale:"scaleX",skew:"skewX",lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:"scaleY",skew:"skewY",lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},rJ=["ns","nesw","ew","nwse"],rZ=(e,t,r)=>{if(0!==t.x&&t0(r,"lockSkewingY")||0!==t.y&&t0(r,"lockSkewingX"))return tQ;let i=t2(r,t)%4;return"".concat(rJ[i],"-resize")};function r0(e,t,r,i,n){let{target:s}=r,{counterAxis:o,origin:a,lockSkewing:l,skew:h,flip:c}=rQ[e];if(t0(s,l))return!1;let{origin:u,flip:d}=rQ[o],f=tK(r[u])*(s[d]?-1:1),g=-Math.sign(f)*(s[c]?-1:1),p=(0===s[h]&&t5(r,eg,eg,i,n)[e]>0||s[h]>0?1:-1)*g,m=rF("skewing",rR((t,r,i,n)=>(function(e,t,r){let{target:i,ex:n,ey:s,skewingSide:o}=t,a=H(t,rK),{skew:l}=rQ[e],h=r.subtract(new eM(n,s)).divide(new eM(i.scaleX,i.scaleY))[e],c=i[l],u=a[l],d=Math.tan(eY(u)),f="y"===e?i._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:i._getTransformedDimensions({scaleX:1,scaleY:1}).y,g=eH(Math.atan(2*h*o/Math.max(f,1)+d));i.set(l,g);let p=c!==i[l];if(p&&"y"===e){let{skewX:e,scaleX:t}=i,r=i._getTransformedDimensions({skewY:c}),n=i._getTransformedDimensions(),s=0!==e?r.x/n.x:1;1!==s&&i.set("scaleX",s*t)}return p})(e,r,new eM(i,n))));return m(t,X(X({},r),{},{[a]:-(.5*p)+.5,skewingSide:g}),i,n)}let r1=(e,t,r,i)=>r0("x",e,t,r,i),r2=(e,t,r,i)=>r0("y",e,t,r,i);function r5(e,t){return e[t.canvas.altActionKey]}let r4=(e,t,r)=>{let i=r5(e,r);return 0===t.x?i?"skewX":"scaleY":0===t.y?i?"skewY":"scaleX":""},r3=(e,t,r)=>r5(e,r)?rZ(e,t,r):rz(e,t,r),r6=(e,t,r,i)=>r5(e,t.target)?r2(e,t,r,i):rq(e,t,r,i),r8=(e,t,r,i)=>r5(e,t.target)?r1(e,t,r,i):r$(e,t,r,i),r9=()=>({ml:new rB({x:-.5,y:0,cursorStyleHandler:r3,actionHandler:r6,getActionName:r4}),mr:new rB({x:.5,y:0,cursorStyleHandler:r3,actionHandler:r6,getActionName:r4}),mb:new rB({x:0,y:.5,cursorStyleHandler:r3,actionHandler:r8,getActionName:r4}),mt:new rB({x:0,y:-.5,cursorStyleHandler:r3,actionHandler:r8,getActionName:r4}),tl:new rB({x:-.5,y:-.5,cursorStyleHandler:rz,actionHandler:rG}),tr:new rB({x:.5,y:-.5,cursorStyleHandler:rz,actionHandler:rG}),bl:new rB({x:-.5,y:.5,cursorStyleHandler:rz,actionHandler:rG}),br:new rB({x:.5,y:.5,cursorStyleHandler:rz,actionHandler:rG}),mtr:new rB({x:0,y:-.5,actionHandler:rU,cursorStyleHandler:rW,offsetY:-40,withConnection:!0,actionName:"rotate"})}),r7=()=>({mr:new rB({x:.5,y:0,actionHandler:rL,cursorStyleHandler:r3,actionName:"resizing"}),ml:new rB({x:-.5,y:0,actionHandler:rL,cursorStyleHandler:r3,actionName:"resizing"})}),ie=()=>X(X({},r9()),r7());class it extends rA{static getDefaults(){return X(X({},super.getDefaults()),{},{controls:r9()},it.ownDefaults)}_updateCacheCanvas(){let e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){let t=e._currentTransform.target,r=e._currentTransform.action;if(this===t&&r.startsWith("scale"))return!1}return super._updateCacheCanvas()}getActiveControl(){return this.__corner}_findTargetCorner(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.hasControls||!this.canvas)return"";this.__corner=void 0;let r=Object.entries(this.oCoords);for(let i=r.length-1;i>=0;i--){let[n,s]=r[i];if(this.controls[n].shouldActivate(n,this,e,t?s.touchCorner:s.corner))return this.__corner=n}return""}calcOCoords(){let e=this.getViewportTransform(),t=this.getCenterPoint(),r=eJ(t.x,t.y),i=eZ({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),n=eq(r,i),s=eq(e,n),o=eq(s,[1/e[0],0,0,1/e[3],0,0]),a=this.group?eQ(this.calcTransformMatrix()):void 0,l=this._calculateCurrentDimensions(a),h={};return this.forEachControl((e,t)=>{let r=e.positionHandler(l,o,this,e);h[t]=Object.assign(r,this._calcCornerCoords(e,r))}),h}_calcCornerCoords(e,t){let r=this.getTotalAngle(),i=e.calcCornerCoords(r,this.cornerSize,t.x,t.y,!1,this),n=e.calcCornerCoords(r,this.touchCornerSize,t.x,t.y,!0,this);return{corner:i,touchCorner:n}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(let t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();let t=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),i=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/i[0],1/i[3]),e.rotate(eY(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=X({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},r);e.save(),e.strokeStyle=i.borderColor,this._setLineDash(e,i.borderDashArray),this.strokeBorders(e,t),i.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{hasBorders:r,hasControls:i}=this,n=X({hasBorders:r,hasControls:i},t),s=this.getViewportTransform(),o=n.hasBorders,a=n.hasControls,l=eq(s,this.calcTransformMatrix()),h=eQ(l);e.save(),e.translate(h.translateX,h.translateY),e.lineWidth=1*this.borderScaleFactor,this.group||(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(h.angle-=180),e.rotate(eY(this.group?h.angle:this.angle)),o&&this.drawBorders(e,h,t),a&&this.drawControls(e,t),e.restore()}drawBorders(e,t,r){let i;if(r&&r.forActiveSelection||this.group){let e=tY(this.width,this.height,e4(t)),r=(this.strokeUniform?new eM().scalarAdd(this.canvas?this.canvas.getZoom():1):new eM(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);i=e.add(r).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,i,r)}drawControlsConnectingLines(e,t){let r=!1;e.beginPath(),this.forEachControl((i,n)=>{i.withConnection&&i.getVisibility(this,n)&&(r=!0,e.moveTo(i.x*t.x,i.y*t.y),e.lineTo(i.x*t.x+i.offsetX,i.y*t.y+i.offsetY))}),r&&e.stroke()}drawControls(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.save();let r=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:n,cornerColor:s}=this,o=X({cornerStrokeColor:i,cornerDashArray:n,cornerColor:s},t);e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=o.cornerColor,this.transparentCorners||(e.strokeStyle=o.cornerStrokeColor),this._setLineDash(e,o.cornerDashArray),this.setCoords(),this.forEachControl((t,r)=>{if(t.getVisibility(this,r)){let i=this.oCoords[r];t.render(e,i.x,i.y,o,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.entries(e).forEach(e=>{let[t,r]=e;return this.setControlVisible(t,r)})}clearContextTop(e){if(!this.canvas)return;let t=this.canvas.contextTop;if(!t)return;let r=this.canvas.viewportTransform;t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(t);let i=this.width+4,n=this.height+4;return t.clearRect(-i/2,-n/2,i,n),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function ir(e,t){return t.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{"constructor"!==r&&Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))})}),e}Y(it,"ownDefaults",{});class ii extends it{}ir(ii,[t3]),eC.setClass(ii),eC.setClass(ii,"object");let is=(e,t,r,i)=>{i=Math.round(i);let n=2*i+1,{data:s}=e.getImageData(t-i,r-i,n,n);for(let e=3;e<s.length;e+=4){let t=s[e];if(t>0)return!1}return!0},io=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function ia(e){return RegExp("^("+e.join("|")+")\\b","i")}let il=String.raw(w||(w=z(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"])));String.raw(T||(T=z(["(?:s+,?s*|,s*|$)"],["(?:\\s+,?\\s*|,\\s*|$)"])));let ih=RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+il+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+il+"))?\\s+(.*)"),ic={cx:ep,x:ep,r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},iu="font-size",id="clip-path",ig=ia(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),ip=ia(["symbol","image","marker","pattern","view","svg"]),im=ia(["symbol","g","a","svg","clipPath","defs"]),iv=RegExp("^\\s*("+il+"+)\\s*,?\\s*("+il+"+)\\s*,?\\s*("+il+"+)\\s*,?\\s*("+il+"+)\\s*$");function iy(e,t){let r;let i=e.nodeName,n=e.getAttribute("class"),s=e.getAttribute("id");if(r=RegExp("^"+i,"i"),t=t.replace(r,""),s&&t.length&&(r=RegExp("#"+s+"(?![a-zA-Z\\-]+)","i"),t=t.replace(r,"")),n&&t.length){let e=n.split(" ");for(let i=e.length;i--;)r=RegExp("\\."+e[i]+"(?![a-zA-Z\\-]+)","i"),t=t.replace(r,"")}return 0===t.length}let ix=e=>{var t;return null!==(t=ic[e])&&void 0!==t?t:e},i_=e=>e.replace(RegExp("(".concat(il,")"),"gi")," $1 ").replace(/,/gi," ").replace(/\s+/gi," "),ib="(".concat(il,")"),iC=String.raw(O||(O=z(["(skewX)(",")"],["(skewX)\\(","\\)"])),ib),iS=String.raw(E||(E=z(["(skewY)(",")"],["(skewY)\\(","\\)"])),ib),iw=String.raw(P||(P=z(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),ib,ib,ib),iT=String.raw(k||(k=z(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),ib,ib),iO=String.raw(j||(j=z(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),ib,ib),iE=String.raw(M||(M=z(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),ib,ib,ib,ib,ib,ib),iP="(?:".concat(iE,"|").concat(iO,"|").concat(iw,"|").concat(iT,"|").concat(iC,"|").concat(iS,")"),ik=String.raw(D||(D=z(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),"(?:".concat(iP,"*)")),ij=new RegExp(ik),iM=RegExp(iP,"g");function iD(e){e=i_(e).replace(/\s*([()])\s*/gi,"$1");let t=[];if(!e||e&&!ij.test(e))return[...ef];for(let r of e.matchAll(iM)){let e=new RegExp(iP).exec(r[0]);if(!e)continue;let i=ef,n=e.filter(e=>!!e),[,s,...o]=n,[a,l,h,c,u,d]=o.map(e=>parseFloat(e));switch(s){case"translate":i=eJ(a,l);break;case"rotate":i=eZ({angle:a},{x:l,y:h});break;case"scale":i=e0(a,l);break;case"skewX":i=e2(a);break;case"skewY":i=e5(a);break;case"matrix":i=[a,l,h,c,u,d]}t.push(i)}return e$(t)}let iA={stroke:"strokeOpacity",fill:"fillOpacity"};function iF(e,t,r){if(!e)return{};let i={},n,s=16;e.parentNode&&im.test(e.parentNode.nodeName)&&(i=iF(e.parentElement,t,r)).fontSize&&(n=s=td(i.fontSize));let o=X(X(X({},t.reduce((t,r)=>{let i=e.getAttribute(r);return i&&(t[r]=i),t},{})),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={};for(let i in t)(function(e,t){let r=!0,i=iy(e,t.pop());return i&&t.length&&(r=function(e,t){let r,i=!0;for(;e.parentElement&&1===e.parentElement.nodeType&&t.length;)i&&(r=t.pop()),i=iy(e=e.parentElement,r);return 0===t.length}(e,t)),i&&r&&0===t.length})(e,i.split(" "))&&(r=X(X({},r),t[i]));return r}(e,r)),function(e){let t={},r=e.getAttribute("style");return r&&("string"==typeof r?function(e,t){e.replace(/;\s*$/,"").split(";").forEach(e=>{let[r,i]=e.split(":");t[r.trim().toLowerCase()]=i.trim()})}(r,t):function(e,t){Object.entries(e).forEach(e=>{let[r,i]=e;void 0!==i&&(t[r.toLowerCase()]=i)})}(r,t)),t}(e));o[id]&&e.setAttribute(id,o[id]),o[iu]&&(n=td(o[iu],s),o[iu]="".concat(n));let a={};for(let e in o){let t=ix(e),r=function(e,t,r,i){let n;let s=Array.isArray(t),o=t;if(("fill"===e||"stroke"===e)&&t===ey)o="";else if("strokeUniform"===e)return"non-scaling-stroke"===t;else if("strokeDashArray"===e)o=t===ey?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===e)o=r&&r.transformMatrix?eq(r.transformMatrix,iD(t)):iD(t);else if("visible"===e)o=t!==ey&&"hidden"!==t,r&&!1===r.visible&&(o=!1);else if("opacity"===e)o=parseFloat(t),r&&void 0!==r.opacity&&(o*=r.opacity);else if("textAnchor"===e)o="start"===t?ep:"end"===t?ev:eg;else if("charSpacing"===e)n=td(t,i)/i*1e3;else if("paintFirst"===e){let e=t.indexOf("fill"),r=t.indexOf("stroke");o="fill",e>-1&&r>-1&&r<e?o="stroke":-1===e&&r>-1&&(o="stroke")}else{if("href"===e||"xlink:href"===e||"font"===e)return t;if("imageSmoothing"===e)return"optimizeQuality"===t;n=s?t.map(td):td(t,i)}return!s&&isNaN(n)?o:n}(t,o[e],i,n);a[t]=r}a&&a.font&&function(e,t){let r=e.match(ih);if(!r)return;let i=r[1],n=r[3],s=r[4],o=r[5],a=r[6];i&&(t.fontStyle=i),n&&(t.fontWeight=isNaN(parseFloat(n))?n:parseFloat(n)),s&&(t.fontSize=td(s)),a&&(t.fontFamily=a),o&&(t.lineHeight="normal"===o?1:o)}(a.font,a);let l=X(X({},i),a);return im.test(e.nodeName)?l:function(e){let t=ii.getDefaults();return Object.entries(iA).forEach(r=>{let[i,n]=r;if(void 0===e[n]||""===e[i])return;if(void 0===e[i]){if(!t[i])return;e[i]=t[i]}if(0===e[i].indexOf("url("))return;let s=new tc(e[i]);e[i]=s.setAlpha(tu(s.getAlpha()*e[n],2)).toRgba()}),e}(l)}let iR=["left","top","width","height","visible"],iL=["rx","ry"];class iI extends ii{static getDefaults(){return X(X({},super.getDefaults()),iI.ownDefaults)}constructor(e){super(e),this._initRxRy()}_initRxRy(){let{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){let{width:t,height:r}=this,i=-t/2,n=-r/2,s=this.rx?Math.min(this.rx,t/2):0,o=this.ry?Math.min(this.ry,r/2):0,a=0!==s||0!==o;e.beginPath(),e.moveTo(i+s,n),e.lineTo(i+t-s,n),a&&e.bezierCurveTo(i+t-.4477152502*s,n,i+t,n+.4477152502*o,i+t,n+o),e.lineTo(i+t,n+r-o),a&&e.bezierCurveTo(i+t,n+r-.4477152502*o,i+t-.4477152502*s,n+r,i+t-s,n+r),e.lineTo(i+s,n+r),a&&e.bezierCurveTo(i+.4477152502*s,n+r,i,n+r-.4477152502*o,i,n+r-o),e.lineTo(i,n+o),a&&e.bezierCurveTo(i,n+.4477152502*o,i+.4477152502*s,n,i+s,n),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject([...iL,...e])}_toSVG(){let{width:e,height:t,rx:r,ry:i}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(r,'" ry="').concat(i,'" width="').concat(e,'" height="').concat(t,'" />\n')]}static async fromElement(e,t,r){let i=iF(e,this.ATTRIBUTE_NAMES,r),{left:n=0,top:s=0,width:o=0,height:a=0,visible:l=!0}=i,h=H(i,iR);return new this(X(X(X({},t),h),{},{left:n,top:s,width:o,height:a,visible:!!(l&&o&&a)}))}}Y(iI,"type","Rect"),Y(iI,"cacheProperties",[...rM,...iL]),Y(iI,"ownDefaults",{rx:0,ry:0}),Y(iI,"ATTRIBUTE_NAMES",[...io,"x","y","rx","ry","width","height"]),eC.setClass(iI),eC.setSVGClass(iI);let iN="initialization",iB="added",iW="removed",iU="imperative",iX=(e,t)=>{let{strokeUniform:r,strokeWidth:i,width:n,height:s,group:o}=t,a=o&&o!==e?tH(o.calcTransformMatrix(),e.calcTransformMatrix()):null,l=a?t.getRelativeCenterPoint().transform(a):t.getRelativeCenterPoint(),h=r?tV(new eM(i,i),void 0,e.calcTransformMatrix()):eD,c=r?0:i,u=tY(n+c,s+c,e$([a,t.calcOwnMatrix()],!0)).add(h).scalarDivide(2);return[l.subtract(u),l.add(u)]};class iY{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){return e.type===iN||e.type===iU||!!e.prevStrategy&&e.strategy!==e.prevStrategy}shouldLayoutClipPath(e){let{type:t,target:{clipPath:r}}=e;return t!==iN&&r&&!r.absolutePositioned}getInitialSize(e,t){return t.size}shouldResetTransform(e){return 0===e.target.size()}calcBoundingBox(e,t){if(t.type===iU&&t.overrides)return t.overrides;if(0===e.length)return;let{target:r}=t,{left:i,top:n,width:s,height:o}=tI(e.map(e=>iX(r,e)).reduce((e,t)=>e.concat(t),[])),a=new eM(s,o),l=new eM(i,n),h=l.add(a.scalarDivide(2));if(t.type===iN){let e=this.getInitialSize(t,{size:a,center:h}),i=new eM(-tK(r.originX),-tK(r.originY)),n=e.subtract(a).multiply(i),s=l.add(a.multiply(i));return{center:s.add(n),relativeCorrection:s.subtract(h),size:e}}{let e=h.transform(r.calcOwnMatrix());return{center:e,size:a}}}}Y(iY,"type","strategy");class iH extends iY{shouldPerformLayout(e){return!0}}Y(iH,"type","fit-content");let iz=["strategy"],iV=["target","strategy","bubbles","prevStrategy"];class iG{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new iH;Y(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){let t=X(X({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);let r=this.getLayoutResult(t);r&&this.commitLayout(t,r),this.onAfterLayout(t,r),this._prevLayoutStrategy=t.strategy}subscribe(e,t){let{target:r}=t;this.unsubscribe(e,t);let i=[e.on("modified",t=>this.performLayout({trigger:"modified",e:X(X({},t),{},{target:e}),type:"object_modified",target:r})),...["moving","resizing","rotating","scaling","skewing","changed"].map(t=>e.on(t,i=>this.performLayout({trigger:t,e:X(X({},i),{},{target:e}),type:"object_modifying",target:r})))];this._subscriptions.set(e,i)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(e=>e()),this._subscriptions.delete(e)}unsubscribeTarget(e){e.forEachObject(e=>this.unsubscribe(e))}onBeforeLayout(e){let{target:t}=e,{canvas:r}=t;if(t.layoutManager===this&&(e.type===iN||e.type===iB)?e.targets.forEach(t=>this.subscribe(t,e)):e.type===iW&&e.targets.forEach(t=>this.unsubscribe(t,e)),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),e.type===iU&&e.deep){let r=H(e,iz);t.forEachObject(e=>{var t;null===(t=e.layoutManager)||void 0===t||t.performLayout(X(X({},r),{},{bubbles:!1,target:e}))})}}getLayoutResult(e){let{target:t}=e,r=e.strategy.calcLayoutResult(e,t.getObjects());if(!r)return;let i=e.type===iN?new eM:t.getRelativeCenterPoint(),{center:n,correction:s=new eM,relativeCorrection:o=new eM}=r,a=e.type===iN&&e.objectsRelativeToGroup?new eM:i.subtract(n).add(s).transform(e.type===iN?ef:eG(t.calcOwnMatrix()),!0).add(o);return{result:r,prevCenter:i,nextCenter:n,offset:a}}commitLayout(e,t){let{target:r}=e,{result:{size:i},nextCenter:n}=t;if(r.set({width:i.x,height:i.y}),this.layoutObjects(e,t),e.type===iN){var s,o;r.set({left:null!==(s=e.x)&&void 0!==s?s:n.x+i.x*tK(r.originX),top:null!==(o=e.y)&&void 0!==o?o:n.y+i.y*tK(r.originY)})}else r.setPositionByOrigin(n,eg,eg),r.setCoords(),r.set({dirty:!0})}layoutObjects(e,t){let{target:r}=e;e.type===iN&&e.objectsRelativeToGroup||r.forEachObject(i=>{i.group===r&&this.layoutObject(e,t,i)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,r.clipPath)}layoutObject(e,t,r){let{offset:i}=t;r.set({left:r.left+i.x,top:r.top+i.y})}onAfterLayout(e,t){let{target:r,strategy:i,bubbles:n,prevStrategy:s}=e,o=H(e,iV),{canvas:a}=r;i.shouldResetTransform(e)&&(tU(r),r.left=0,r.top=0),r.fire("layout:after",{context:e,result:t}),a&&a.fire("object:layout:after",{context:e,result:t,target:r});let l=r.group;n&&null!=l&&l.layoutManager&&((o.path||(o.path=[])).push(r),l.layoutManager.performLayout(X(X({},o),{},{target:l})))}dispose(){this._subscriptions.forEach(e=>e.forEach(e=>e())),this._subscriptions.clear()}toJSON(){return{strategy:this.strategy.constructor.type}}}let iq=["objects"];class i$ extends eF(ii){static getDefaults(){return X(X({},super.getDefaults()),i$.ownDefaults)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;super(t),Y(this,"_activeObjects",[]),Y(this,"__objectSelectionTracker",void 0),Y(this,"__objectSelectionDisposer",void 0),this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(e=>{this.enterGroup(e,!1)});let i=t.layoutManager||new iG;i.performLayout({type:iN,objectsRelativeToGroup:r,target:this,targets:[...e],x:t.left,y:t.top}),this.layoutManager=i}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(K("error","Group: circular object trees are not supported, this call has no effect"),!1):-1===this._objects.indexOf(e)||(K("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((e,t,r)=>this.canEnterGroup(e)&&r.indexOf(e)===t)}add(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=this._filterObjectsBeforeEnteringGroup(t),n=super.add(...i);return this._onAfterObjectsChange(iB,i),n}insertAt(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n=this._filterObjectsBeforeEnteringGroup(r),s=super.insertAt(e,...n);return this._onAfterObjectsChange(iB,n),s}remove(){let e=super.remove(...arguments);return this._onAfterObjectsChange(iW,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){let r=this[e];return super._set(e,t),"canvas"===e&&r!==t&&(this._objects||[]).forEach(r=>{r._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:r}=t;if(e)this._activeObjects.push(r),this._set("dirty",!0);else if(this._activeObjects.length>0){let e=this._activeObjects.indexOf(r);e>-1&&(this._activeObjects.splice(e,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&tW(e,eq(eG(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);let r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===e||e.isDescendantOf(r))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(tW(e,eq(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);let r=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){let e=ii.prototype.shouldCache.call(this);if(e){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(ii.prototype.willDrawShadow.call(this))return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.group&&this.group.isOnACache()}drawObject(e){this._renderBackground(e);for(let r=0;r<this._objects.length;r++){var t;null!==(t=this.canvas)&&void 0!==t&&t.preserveObjectStacking&&this._objects[r].group!==this?(e.save(),e.transform(...eG(this.calcTransformMatrix())),this._objects[r].render(e),e.restore()):this._objects[r].group===this&&this._objects[r].render(e)}this._drawClipPath(e,this.clipPath)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.layoutManager.performLayout(X({target:this,type:iU},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){let r=this.includeDefaultValues;return this._objects.filter(function(e){return!e.excludeFromExport}).map(function(i){let n=i.includeDefaultValues;i.includeDefaultValues=r;let s=i[e||"toObject"](t);return i.includeDefaultValues=n,s})}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return X(X({},super.toObject(["subTargetCheck","interactive",...e])),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTarget(this),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";let t=iI.prototype._toSVG.call(this),r=t.indexOf("COMMON_PARTS");t[r]='for="group" ';let i=t.join("");return e?e(i):i}_toSVG(e){let t=["<g ","COMMON_PARTS"," >\n"],r=this._createSVGBgRect(e);r&&t.push("		",r);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push("</g>\n"),t}getSvgStyles(){let e=void 0!==this.opacity&&1!==this.opacity?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){let t=[],r=this._createSVGBgRect(e);r&&t.push("	",r);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e){let{objects:t=[]}=e,r=H(e,iq);return Promise.all([e8(t),e9(r)]).then(e=>{let[t,i]=e,n=new this(t,X(X({},r),i),!0);return r.strategy||(n.width=r.width,n.height=r.height),n})}}Y(i$,"type","Group"),Y(i$,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),eC.setClass(i$);class iK extends i${constructor(){super(...arguments),Y(this,"multiSelectionStacking","canvas-stacking")}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];"selection-order"===this.multiSelectionStacking?this.add(...t):t.forEach(e=>{let t=this._objects.findIndex(t=>t.isInFrontOf(e)),r=-1===t?this.size():t;this.insertAt(r,e)})}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);let r=new Set;t.forEach(e=>{let{parent:t}=e;t&&r.add(t)}),e===iW?r.forEach(e=>{e._onAfterObjectsChange(iB,t)}):r.forEach(e=>{e._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,super._renderControls(e,t);let i=X(X({hasControls:!1},r),{},{forActiveSelection:!0});for(let t=0;t<this._objects.length;t++)this._objects[t]._renderControls(e,i);e.restore()}}Y(iK,"type","ActiveSelection"),eC.setClass(iK),eC.setClass(iK,"activeSelection");class iQ{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new eM(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new eM(1/this.options.scaleX,1/this.options.scaleY):new eM(1,1)}createSideVector(e,t){let r=rg(e,t);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(e,t,r){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,r)))}isSkewed(){return 0!==this.options.skewX||0!==this.options.skewY}applySkew(e){let t=new eM(e);return t.y+=t.x*Math.tan(eY(this.options.skewY)),t.x+=t.y*Math.tan(eY(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}let iJ=new eM;class iZ extends iQ{static getOrthogonalRotationFactor(e,t){let r=t?rm(e,t):rv(e);return Math.abs(r)<ec?-1:1}constructor(e,t,r,i){super(i),Y(this,"AB",void 0),Y(this,"AC",void 0),Y(this,"alpha",void 0),Y(this,"bisector",void 0),this.A=new eM(e),this.B=new eM(t),this.C=new eM(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=rm(this.AB,this.AC),this.bisector=ry(rf(this.AB.eq(iJ)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.strokeProjectionMagnitude,i=this.createSideVector(e,t),n=rx(i),s=iZ.getOrthogonalRotationFactor(n,this.bisector);return this.scaleUnitVector(n,r*s)}projectBevel(){let e=[];return(this.alpha%eu==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){let e=[],t=Math.abs(this.alpha),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*(1/Math.sin(t/2))),i=this.options.strokeUniform?rp(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return rp(r)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){let r=[],i=new eM(iZ.getOrthogonalRotationFactor(this.bisector),iZ.getOrthogonalRotationFactor(new eM(this.bisector.y,this.bisector.x))),n=new eM(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),s=new eM(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i);return[n,s].forEach(i=>{rC(i,e,t)&&r.push(this.A.add(i))}),r}projectRoundWithSkew(e,t){let r=[],{skewX:i,skewY:n,scaleX:s,scaleY:o,strokeUniform:a}=this.options,l=new eM(Math.tan(eY(i)),Math.tan(eY(n))),h=this.strokeProjectionMagnitude,c=a?h/o/Math.sqrt(1/o**2+1/s**2*l.y**2):h/Math.sqrt(1+l.y**2),u=new eM(Math.sqrt(Math.max(h**2-c**2,0)),c),d=a?h/Math.sqrt(1+l.x**2*(1/o)**2/(1/s+1/s*l.x*l.y)**2):h/Math.sqrt(1+l.x**2/(1+l.x*l.y)**2),f=new eM(d,Math.sqrt(Math.max(h**2-d**2,0)));return[f,f.scalarMultiply(-1),u,u.scalarMultiply(-1)].map(e=>this.applySkew(a?e.multiply(this.strokeUniformScalar):e)).forEach(i=>{rC(i,e,t)&&r.push(this.applySkew(this.A).add(i))}),r}projectRound(){let e=[];e.push(...this.projectBevel());let t=this.alpha%eu==0,r=this.applySkew(this.A),i=e[t?0:2].subtract(r),n=e[t?1:0].subtract(r),s=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),o=r_(i,s)>0,a=o?i:n,l=o?n:i;return this.isSkewed()?e.push(...this.projectRoundWithSkew(a,l)):e.push(...this.projectRoundNoSkew(a,l)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class i0 extends iQ{constructor(e,t,r){super(r),this.A=new eM(e),this.T=new eM(t)}calcOrthogonalProjection(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.strokeProjectionMagnitude,i=this.createSideVector(e,t);return this.scaleUnitVector(rx(i),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){let e=[];if(!this.isSkewed()&&this.A.eq(this.T)){let t=new eM(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new iZ(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){let e=[];if(this.A.eq(this.T)){let t=new eM(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{let t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(ry(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(r);e.push(i.add(t),i.subtract(t))}return e.map(e=>this.applySkew(e))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}let i1=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];if(0===e.length)return i;let n=e.reduce((e,t)=>(e[e.length-1].eq(t)||e.push(new eM(t)),e),[new eM(e[0])]);if(1===n.length)r=!0;else if(!r){let e=n[0],t=eO(n,t=>!t.eq(e));n.splice(t+1)}return n.forEach((e,n,s)=>{let o,a;0===n?(a=s[1],o=r?e:s[s.length-1]):n===s.length-1?(o=s[n-1],a=r?e:s[0]):(o=s[n-1],a=s[n+1]),r&&1===s.length?i.push(...new i0(e,e,t).project()):r&&(0===n||n===s.length-1)?i.push(...new i0(e,0===n?a:o,t).project()):i.push(...new iZ(e,o,a,t).project())}),i},i2=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.fill!==t.fill||e.stroke!==t.stroke||e.strokeWidth!==t.strokeWidth||e.fontSize!==t.fontSize||e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight||e.fontStyle!==t.fontStyle||e.textBackgroundColor!==t.textBackgroundColor||e.deltaY!==t.deltaY||r&&(e.overline!==t.overline||e.underline!==t.underline||e.linethrough!==t.linethrough)},i5=(e,t)=>{let r=t.split("\n"),i=[],n=-1,s={};e=rk(e);for(let t=0;t<r.length;t++){if(!e[t]){n+=r[t].length,s={};continue}for(let o=0;o<r[t].length;o++){n++;let r=e[t][o];r&&Object.keys(r).length>0&&(i2(s,r,!0)?i.push({start:n,end:n+1,style:r}):i[i.length-1].end++),s=r||{}}}return i},i4=(e,t)=>{if(!Array.isArray(e))return rk(e);let r=t.split(ex),i={},n=-1,s=0;for(let t=0;t<r.length;t++)for(let o=0;o<r[t].length;o++)n++,e[s]&&e[s].start<=n&&n<e[s].end&&(i[t]=i[t]||{},i[t][o]=X({},e[s].style),n===e[s].end-1&&s++);return i},i3=(e,t)=>Math.min(t.width/e.width,t.height/e.height),i6=(e,t)=>Math.max(t.width/e.width,t.height/e.height),i8=e=>e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i9=e=>{let t=[];for(let r=0,i;r<e.length;r++)!1!==(i=i7(e,r))&&t.push(i);return t},i7=(e,t)=>{let r=e.charCodeAt(t);if(isNaN(r))return"";if(r<55296||r>57343)return e.charAt(t);if(55296<=r&&r<=56319){if(e.length<=t+1)throw"High surrogate without following low surrogate";let r=e.charCodeAt(t+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return e.charAt(t)+e.charAt(t+1)}if(0===t)throw"Low surrogate without preceding high surrogate";let i=e.charCodeAt(t-1);if(55296>i||i>56319)throw"Low surrogate without preceding high surrogate";return!1},ne="(".concat(il,")"),nt="(M) (?:".concat(ne," ").concat(ne," ?)+"),nr="(L) (?:".concat(ne," ").concat(ne," ?)+"),ni="(H) (?:".concat(ne," ?)+"),nn="(V) (?:".concat(ne," ?)+"),ns=String.raw(A||(A=z(["(Z)s*"],["(Z)\\s*"]))),no="(C) (?:".concat(ne," ").concat(ne," ").concat(ne," ").concat(ne," ").concat(ne," ").concat(ne," ?)+"),na="(S) (?:".concat(ne," ").concat(ne," ").concat(ne," ").concat(ne," ?)+"),nl="(Q) (?:".concat(ne," ").concat(ne," ").concat(ne," ").concat(ne," ?)+"),nh="(T) (?:".concat(ne," ").concat(ne," ?)+"),nc="(A) (?:".concat(ne," ").concat(ne," ").concat(ne," ([01]) ?([01]) ").concat(ne," ").concat(ne," ?)+"),nu="(?:(?:".concat(nt,")")+"|(?:".concat(nr,")")+"|(?:".concat(ni,")")+"|(?:".concat(nn,")")+"|(?:".concat(ns,")")+"|(?:".concat(no,")")+"|(?:".concat(na,")")+"|(?:".concat(nl,")")+"|(?:".concat(nh,")")+"|(?:".concat(nc,"))"),nd={m:"l",M:"L"},nf=(e,t,r,i,n,s,o,a,l,h,c)=>{let u=ek(e),d=ej(e),f=ek(t),g=ej(t),p=r*n*f-i*s*g+o,m=i*n*f+r*s*g+a;return["C",h+l*(-r*n*d-i*s*u),c+l*(-i*n*d+r*s*u),p+l*(r*n*g+i*s*f),m+l*(i*n*g-r*s*f),p,m]},ng=(e,t,r,i,n,s,o)=>{if(0===r||0===i)return[];let a=0,l=0,h=0,c=Math.PI,u=o*ed,d=ej(u),f=ek(u),g=.5*(-f*e-d*t),p=.5*(-f*t+d*e),m=r**2,v=i**2,y=p**2,x=g**2,_=m*v-m*y-v*x,b=Math.abs(r),C=Math.abs(i);if(_<0){let e=Math.sqrt(1-_/(m*v));b*=e,C*=e}else h=(n===s?-1:1)*Math.sqrt(_/(m*y+v*x));let S=h*b*p/C,w=-h*C*g/b,T=f*S-d*w+.5*e,O=d*S+f*w+.5*t,E=np(1,0,(g-S)/b,(p-w)/C),P=np((g-S)/b,(p-w)/C,(-g-S)/b,(-p-w)/C);0===s&&P>0?P-=2*c:1===s&&P<0&&(P+=2*c);let k=Math.ceil(Math.abs(P/c*2)),j=Array(k),M=P/k,D=8/3*Math.sin(M/4)*Math.sin(M/4)/Math.sin(M/2),A=E+M;for(let e=0;e<k;e++)j[e]=nf(E,A,f,d,b,C,T,O,D,a,l),a=j[e][5],l=j[e][6],E=A,A+=M;return j},np=(e,t,r,i)=>{let n=Math.atan2(t,e),s=Math.atan2(i,r);return s>=n?s-n:2*Math.PI-(n-s)},nm=e=>e**3,nv=e=>3*e**2*(1-e),ny=e=>3*e*(1-e)**2,nx=e=>(1-e)**3;function n_(e,t,r,i,n,s,o,a){let l;if($.cachesBoundsOfCurve&&(l=[...arguments].join(),ea.boundsOfCurveCache[l]))return ea.boundsOfCurveCache[l];let h=Math.sqrt,c=Math.abs,u=[],d=[[0,0],[0,0]],f=6*e-12*r+6*n,g=-3*e+9*r-9*n+3*o,p=3*r-3*e;for(let e=0;e<2;++e){if(e>0&&(f=6*t-12*i+6*s,g=-3*t+9*i-9*s+3*a,p=3*i-3*t),1e-12>c(g)){if(1e-12>c(f))continue;let e=-p/f;0<e&&e<1&&u.push(e);continue}let r=f*f-4*p*g;if(r<0)continue;let n=h(r),o=(-f+n)/(2*g);0<o&&o<1&&u.push(o);let l=(-f-n)/(2*g);0<l&&l<1&&u.push(l)}let m=u.length,v=m,y=nw(e,t,r,i,n,s,o,a);for(;m--;){let{x:e,y:t}=y(u[m]);d[0][m]=e,d[1][m]=t}d[0][v]=e,d[1][v]=t,d[0][v+1]=o,d[1][v+1]=a;let x=[new eM(Math.min(...d[0]),Math.min(...d[1])),new eM(Math.max(...d[0]),Math.max(...d[1]))];return $.cachesBoundsOfCurve&&(ea.boundsOfCurveCache[l]=x),x}let nb=(e,t,r)=>{let[i,n,s,o,a,l,h,c]=r,u=ng(h-e,c-t,n,s,a,l,o);for(let r=0,i=u.length;r<i;r++)u[r][1]+=e,u[r][2]+=t,u[r][3]+=e,u[r][4]+=t,u[r][5]+=e,u[r][6]+=t;return u},nC=e=>{let t=0,r=0,i=0,n=0,s=[],o,a=0,l=0;for(let h of e){let e;let c=[...h];switch(c[0]){case"l":c[1]+=t,c[2]+=r;case"L":e=["L",t=c[1],r=c[2]];break;case"h":c[1]+=t;case"H":e=["L",t=c[1],r];break;case"v":c[1]+=r;case"V":e=["L",t,r=c[1]];break;case"m":c[1]+=t,c[2]+=r;case"M":t=c[1],r=c[2],i=c[1],n=c[2],e=["M",t,r];break;case"c":c[1]+=t,c[2]+=r,c[3]+=t,c[4]+=r,c[5]+=t,c[6]+=r;case"C":a=c[3],l=c[4],t=c[5],r=c[6],e=["C",c[1],c[2],a,l,t,r];break;case"s":c[1]+=t,c[2]+=r,c[3]+=t,c[4]+=r;case"S":"C"===o?(a=2*t-a,l=2*r-l):(a=t,l=r),t=c[3],r=c[4],a=(e=["C",a,l,c[1],c[2],t,r])[3],l=e[4];break;case"q":c[1]+=t,c[2]+=r,c[3]+=t,c[4]+=r;case"Q":a=c[1],e=["Q",a,l=c[2],t=c[3],r=c[4]];break;case"t":c[1]+=t,c[2]+=r;case"T":"Q"===o?(a=2*t-a,l=2*r-l):(a=t,l=r),e=["Q",a,l,t=c[1],r=c[2]];break;case"a":c[6]+=t,c[7]+=r;case"A":nb(t,r,c).forEach(e=>s.push(e)),t=c[6],r=c[7];break;case"z":case"Z":t=i,r=n,e=["Z"]}e?(s.push(e),o=e[0]):o=""}return s},nS=(e,t,r,i)=>Math.sqrt((r-e)**2+(i-t)**2),nw=(e,t,r,i,n,s,o,a)=>l=>{let h=nm(l),c=nv(l),u=ny(l),d=nx(l);return new eM(o*h+n*c+r*u+e*d,a*h+s*c+i*u+t*d)},nT=e=>e**2,nO=e=>2*e*(1-e),nE=e=>(1-e)**2,nP=(e,t,r,i,n,s,o,a)=>l=>{let h=nT(l),c=nO(l),u=nE(l);return Math.atan2(3*(u*(i-t)+c*(s-i)+h*(a-s)),3*(u*(r-e)+c*(n-r)+h*(o-n)))},nk=(e,t,r,i,n,s)=>o=>{let a=nT(o),l=nO(o),h=nE(o);return new eM(n*a+r*l+e*h,s*a+i*l+t*h)},nj=(e,t,r,i,n,s)=>o=>{let a=1-o;return Math.atan2(2*(a*(i-t)+o*(s-i)),2*(a*(r-e)+o*(n-r)))},nM=(e,t,r)=>{let i=new eM(t,r),n=0;for(let t=1;t<=100;t+=1){let r=e(t/100);n+=nS(i.x,i.y,r.x,r.y),i=r}return n},nD=(e,t)=>{let r=0,i=0,n={x:e.x,y:e.y},s=X({},n),o,a=.01,l=0,h=e.iterator,c=e.angleFinder;for(;i<t&&a>1e-4;)s=h(r),l=r,(o=nS(n.x,n.y,s.x,s.y))+i>t?(r-=a,a/=2):(n=s,r+=a,i+=o);return X(X({},s),{},{angle:c(l)})},nA=e=>{let t=0,r=0,i=0,n=0,s=0,o,a,l=[];for(let h of e){let e={x:r,y:i,command:h[0],length:0};switch(h[0]){case"M":(a=e).x=n=r=h[1],a.y=s=i=h[2];break;case"L":(a=e).length=nS(r,i,h[1],h[2]),r=h[1],i=h[2];break;case"C":o=nw(r,i,h[1],h[2],h[3],h[4],h[5],h[6]),(a=e).iterator=o,a.angleFinder=nP(r,i,h[1],h[2],h[3],h[4],h[5],h[6]),a.length=nM(o,r,i),r=h[5],i=h[6];break;case"Q":o=nk(r,i,h[1],h[2],h[3],h[4]),(a=e).iterator=o,a.angleFinder=nj(r,i,h[1],h[2],h[3],h[4]),a.length=nM(o,r,i),r=h[3],i=h[4];break;case"Z":(a=e).destX=n,a.destY=s,a.length=nS(r,i,n,s),r=n,i=s}t+=a.length,l.push(a)}return l.push({length:t,x:r,y:i}),l},nF=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nA(e),i=0;for(;t-r[i].length>0&&i<r.length-2;)t-=r[i].length,i++;let n=r[i],s=t/n.length,o=e[i];switch(n.command){case"M":return{x:n.x,y:n.y,angle:0};case"Z":return X(X({},new eM(n.x,n.y).lerp(new eM(n.destX,n.destY),s)),{},{angle:Math.atan2(n.destY-n.y,n.destX-n.x)});case"L":return X(X({},new eM(n.x,n.y).lerp(new eM(o[1],o[2]),s)),{},{angle:Math.atan2(o[2]-n.y,o[1]-n.x)});case"C":case"Q":return nD(n,t)}},nR=e=>{e=i_(e);let t=[];for(let r of e.matchAll(RegExp(nu,"gi"))){let e,i=r[0],n=[];do{if(!(e=RegExp(nu,"i").exec(i)))break;let t=e.filter(e=>e);t.shift();let r=t.map(e=>{let t=Number.parseFloat(e);return Number.isNaN(t)?e:t});if(n.push(r),t.length<=1)break;t.shift(),i=i.replace(new RegExp("".concat(t.join(" ?")," ?$")),"")}while(e);n.reverse().forEach((e,r)=>{let i=nd[e[0]];r>0&&("l"==i||"L"==i)&&(e[0]=i),t.push(e)})}return t},nL=(e,t)=>e.map(e=>e.map((e,r)=>0===r?e:void 0===t?e:tu(e,t)).join(" ")).join(" "),nI=e=>{if(e.transformMatrix){let{scaleX:t,scaleY:r,angle:i,skewX:n}=eQ(e.transformMatrix);e.flipX=!1,e.flipY=!1,e.set("scaleX",t),e.set("scaleY",r),e.angle=i,e.skewX=n,e.skewY=0}},nN=(e,t)=>{let r=e._findCenterFromElement();e.transformMatrix&&(nI(e),r=r.transform(e.transformMatrix)),delete e.transformMatrix,t&&(e.scaleX*=t.scaleX,e.scaleY*=t.scaleY,e.cropX=t.cropX,e.cropY=t.cropY,r.x+=t.offsetLeft,r.y+=t.offsetTop,e.width=t.width,e.height=t.height),e.setPositionByOrigin(r,eg,eg)};class nB extends tj{constructor(e){let{allowTouchScrolling:t=!1,containerClass:r=""}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),Y(this,"upper",void 0),Y(this,"container",void 0);let{el:i}=this.lower,n=this.createUpperCanvas();this.upper={el:n,ctx:n.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:t}),this.applyCanvasStyle(n,{allowTouchScrolling:t});let s=this.createContainerElement();s.classList.add(r),i.parentNode&&i.parentNode.replaceChild(s,i),s.append(i,n),this.container=s}createUpperCanvas(){let{el:e}=this.lower,t=eB();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){let e=es().createElement("div");return e.setAttribute("data-fabric","wrapper"),tO(e,{position:"relative"}),tk(e),e}applyCanvasStyle(e,t){let{allowTouchScrolling:r}=t;tO(e,{position:"absolute",left:"0",top:"0"}),function(e,t){let r=t?"manipulation":ey;tO(e,{"touch-action":r,"-ms-touch-action":r})}(e,r),tk(e)}setDimensions(e,t){super.setDimensions(e,t);let{el:r,ctx:i}=this.upper;tE(r,i,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),tP(this.upper.el,e),tP(this.container,e)}cleanupDOM(e){let t=this.container,{el:r}=this.lower,{el:i}=this.upper;super.cleanupDOM(e),t.removeChild(i),t.removeChild(r),t.parentNode&&t.parentNode.replaceChild(r,t)}dispose(){super.dispose(),en().dispose(this.upper.el),delete this.upper,delete this.container}}let nW=["activeSelection"];class nU extends tD{static getDefaults(){return X(X({},super.getDefaults()),nU.ownDefaults)}get upperCanvasEl(){var e;return null===(e=this.elements.upper)||void 0===e?void 0:e.el}get contextTop(){var e;return null===(e=this.elements.upper)||void 0===e?void 0:e.ctx}get wrapperEl(){return this.elements.container}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeSelection:r=new iK}=t;super(e,H(t,nW)),Y(this,"targets",[]),Y(this,"_hoveredTargets",[]),Y(this,"_objectsToRender",void 0),Y(this,"_currentTransform",null),Y(this,"_groupSelector",null),Y(this,"contextTopDirty",!1),Y(this,"_activeSelection",void 0),this._activeSelection=r,this._activeSelection.set("canvas",this),this._activeSelection.setCoords()}initElements(e){this.elements=new nB(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){let e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),this._objectsToRender||(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){let e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;let t=this.getRetinaScaling(),r=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,r){let i=this.targetFindTolerance,n=this.pixelFindContext;this.clearContext(n),n.save(),n.translate(-t+i,-r+i),n.transform(...this.viewportTransform);let s=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(n),e.selectionBackgroundColor=s,n.restore();let o=Math.round(i*this.getRetinaScaling());return is(n,o,o,o)}_isSelectionKeyPressed(e){let t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(t=>!!t&&!0===e[t]):e[t])}_shouldClearSelection(e,t){let r=this.getActiveObjects(),i=this._activeObject;return!!(!t||t&&i&&r.length>1&&-1===r.indexOf(t)&&i!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&i&&i!==t)}_shouldCenterTransform(e,t,r){let i;if(e)return"scale"===t||"scaleX"===t||"scaleY"===t||"resizing"===t?i=this.centeredScaling||e.centeredScaling:"rotate"===t&&(i=this.centeredRotation||e.centeredRotation),i?!r:r}_getOriginFromCorner(e,t){let r={x:e.originX,y:e.originY};return["ml","tl","bl"].includes(t)?r.x=ev:["mr","tr","br"].includes(t)&&(r.x=ep),["tl","mt","tr"].includes(t)?r.y=em:["bl","mb","br"].includes(t)&&(r.y="top"),r}_setupCurrentTransform(e,t,r){var i;if(!t)return;let n=t.group?tz(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),s=t.getActiveControl()||"",o=!!s&&t.controls[s],a=r&&o?null===(i=o.getActionHandler(e,t,o))||void 0===i?void 0:i.bind(o):t4,l=tJ(r,s,e,t),h=this._getOriginFromCorner(t,s),c=e[this.centeredKey],u={target:t,action:l,actionHandler:a,actionPerformed:!1,corner:s,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:n.x-t.left,offsetY:n.y-t.top,originX:h.x,originY:h.y,ex:n.x,ey:n.y,lastX:n.x,lastY:n.y,theta:eY(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:c,original:X(X({},tX(t)),{},{originX:h.x,originY:h.y})};this._shouldCenterTransform(t,l,c)&&(u.originX=eg,u.originY=eg),this._currentTransform=u,this._beforeTransform(e)}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){let{x:t,y:r,deltaX:i,deltaY:n}=this._groupSelector,s=new eM(t,r).transform(this.viewportTransform),o=new eM(t+i,r+n).transform(this.viewportTransform),a=this.selectionLineWidth/2,l=Math.min(s.x,o.x),h=Math.min(s.y,o.y),c=Math.max(s.x,o.x),u=Math.max(s.y,o.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(l,h,c-l,u-h)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,l+=a,h+=a,c-=a,u-=a,ii.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(l,h,c-l,u-h))}findTarget(e){if(this.skipTargetFind)return;let t=this.getViewportPoint(e),r=this._activeObject,i=this.getActiveObjects();if(this.targets=[],r&&i.length>=1){if(r._findTargetCorner(t,tR(e))||i.length>1&&this.searchPossibleTargets([r],t))return r;if(r===this.searchPossibleTargets([r],t)){if(!this.preserveObjectStacking)return r;{let i=this.targets;this.targets=[];let n=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&n&&n!==r?(this.targets=i,r):n}}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let r=e.getCoords(),i=this.getZoom(),n=e.padding/i;if(n){let[e,t,i,s]=r,o=Math.atan2(t.y-e.y,t.x-e.x),a=ek(o)*n,l=ej(o)*n,h=a+l,c=a-l;r=[new eM(e.x-c,e.y-h),new eM(t.x+h,t.y-c),new eM(i.x+c,i.y+h),new eM(s.x-h,s.y+c)]}return rS.isPointInPolygon(t,r)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,tz(t,void 0,this.viewportTransform)))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||!!e.isEditing||!this.isTargetTransparent(e,t.x,t.y))}_searchPossibleTargets(e,t){let r=e.length;for(;r--;){let i=e[r];if(this._checkTarget(i,t)){if(eA(i)&&i.subTargetCheck){let e=this._searchPossibleTargets(i._objects,t);e&&this.targets.push(e)}return i}}}searchPossibleTargets(e,t){let r=this._searchPossibleTargets(e,t);return r&&eA(r)&&r.interactive&&this.targets[0]?this.targets[0]:r}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.upperCanvasEl,i=r.getBoundingClientRect(),n=tF(e),s=i.width||0,o=i.height||0;(!s||!o)&&("top"in i&&em in i&&(o=Math.abs(i.top-i.bottom)),ev in i&&ep in i&&(s=Math.abs(i.right-i.left))),this.calcOffset(),n.x=n.x-this._offset.left,n.y=n.y-this._offset.top,t||(n=tz(n,void 0,this.viewportTransform));let a=this.getRetinaScaling();1!==a&&(n.x/=a,n.y/=a);let l=0===s||0===o?new eM(1,1):new eM(r.width/s,r.height/o);return n.multiply(l)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=eB(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveSelection(){return this._activeSelection}getActiveObjects(){let e=this._activeObject;return e?e===this._activeSelection?[...e._objects]:[e]:[]}_fireSelectionEvents(e,t){let r=!1,i=!1,n=this.getActiveObjects(),s=[],o=[];e.forEach(e=>{n.includes(e)||(r=!0,e.fire("deselected",{e:t,target:e}),o.push(e))}),n.forEach(i=>{e.includes(i)||(r=!0,i.fire("selected",{e:t,target:i}),s.push(i))}),e.length>0&&n.length>0?(i=!0,r&&this.fire("selection:updated",{e:t,selected:s,deselected:o})):n.length>0?(i=!0,this.fire("selection:created",{e:t,selected:s})):e.length>0&&(i=!0,this.fire("selection:cleared",{e:t,deselected:o})),i&&(this._objectsToRender=void 0)}setActiveObject(e,t){let r=this.getActiveObjects(),i=this._setActiveObject(e,t);return this._fireSelectionEvents(r,t),i}_setActiveObject(e,t){return!(this._activeObject===e||!this._discardActiveObject(t,e)&&this._activeObject||e.onSelect({e:t}))&&(this._activeObject=e,e instanceof iK&&this._activeSelection!==e&&(this._activeSelection=e,e.set("canvas",this),e.setCoords()),!0)}_discardActiveObject(e,t){let r=this._activeObject;return!!r&&!r.onDeselect({e,object:t})&&(r===this._activeSelection&&(this._activeSelection.removeAll(),tU(this._activeSelection)),this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(e),this._activeObject=void 0,!0)}discardActiveObject(e){let t=this.getActiveObjects(),r=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[r]});let i=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),i}setViewportTransform(e){super.setViewportTransform(e);let t=this._activeObject;t&&t.setCoords()}destroy(){let e=this._activeSelection;e.removeAll(),this._activeSelection=void 0,e.dispose(),super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){let t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,r){let i=this._realizeGroupTransformOnObject(e),n=super._toObject(e,t,r);return e.set(i),n}_realizeGroupTransformOnObject(e){if(!e.group||e.group!==this._activeSelection||this._activeObject!==e.group)return{};{let t=["angle","flipX","flipY",ep,"scaleX","scaleY","skewX","skewY","top"],r=e7(e,t);return tB(e,this._activeObject.calcOwnMatrix()),r}}_setSVGObject(e,t,r){let i=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,r),t.set(i)}}Y(nU,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class nX{constructor(e){Y(this,"targets",[]),Y(this,"__disposer",void 0);let t=()=>{let{hiddenTextarea:t}=e.getActiveObject()||{};t&&t.focus()},r=e.upperCanvasEl;r.addEventListener("click",t),this.__disposer=()=>r.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),eP(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;(null===(t=this.target)||void 0===t?void 0:t.isEditing)&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}let nY=["target","oldTarget","fireCanvas","e"],nH={passive:!1},nz=(e,t)=>{let r=e.getViewportPoint(t),i=e.getScenePoint(t);return{viewportPoint:r,scenePoint:i,pointer:r,absolutePointer:i}},nV=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return e.addEventListener(...r)},nG=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return e.removeEventListener(...r)},nq={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class n$ extends nU{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),Y(this,"_isClick",void 0),Y(this,"textEditingManager",new nX(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(e=>{this[e]=this[e].bind(this)}),this.addOrRemove(nV,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){let r=this.upperCanvasEl,i=this._getEventPrefix();e(tT(r),"resize",this._onResize),e(r,i+"down",this._onMouseDown),e(r,"".concat(i,"move"),this._onMouseMove,nH),e(r,"".concat(i,"out"),this._onMouseOut),e(r,"".concat(i,"enter"),this._onMouseEnter),e(r,"wheel",this._onMouseWheel),e(r,"contextmenu",this._onContextMenu),e(r,"dblclick",this._onDoubleClick),e(r,"dragstart",this._onDragStart),e(r,"dragend",this._onDragEnd),e(r,"dragover",this._onDragOver),e(r,"dragenter",this._onDragEnter),e(r,"dragleave",this._onDragLeave),e(r,"drop",this._onDrop),this.enablePointerEvents||e(r,"touchstart",this._onTouchStart,nH)}removeListeners(){this.addOrRemove(nG,"remove");let e=this._getEventPrefix(),t=tw(this.upperCanvasEl);nG(t,"".concat(e,"up"),this._onMouseUp),nG(t,"touchend",this._onTouchEnd,nH),nG(t,"".concat(e,"move"),this._onMouseMove,nH),nG(t,"touchmove",this._onMouseMove,nH)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){let t=this._hoveredTarget,r=X({e},nz(this,e));this.fire("mouse:out",X(X({},r),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",X({},r)),this._hoveredTargets.forEach(e=>{this.fire("mouse:out",X(X({},r),{},{target:e})),e&&e.fire("mouseout",X({},r))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",X({e},nz(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;let t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;let r={e,target:t};this.fire("dragstart",r),t.fire("dragstart",r),nV(this.upperCanvasEl,"drag",this._onDragProgress);return}tL(e)}_renderDragEffects(e,t,r){let i=!1,n=this._dropTarget;n&&n!==t&&n!==r&&(n.clearContextTop(),i=!0),null==t||t.clearContextTop(),r!==t&&(null==r||r.clearContextTop());let s=this.contextTop;s.save(),s.transform(...this.viewportTransform),t&&(s.save(),t.transform(s),t.renderDragSourceEffect(e),s.restore(),i=!0),r&&(s.save(),r.transform(s),r.renderDropTargetEffect(e),s.restore(),i=!0),s.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(e){let t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==ey,r=t?this._activeObject:void 0,i={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:r};nG(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",i),this._dragSource&&this._dragSource.fire("dragend",i),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){let t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){this.targets=[];let t=this._searchPossibleTargets(this._objects,this.getViewportPoint(e));return{target:t,targets:[...this.targets]}}_onDragOver(e){let t;let r="dragover",{target:i,targets:n}=this.findDragTargets(e),s=this._dragSource,o={e,target:i,subTargets:n,dragSource:s,canDrop:!1,dropTarget:void 0};this.fire(r,o),this._fireEnterLeaveEvents(i,o),i&&(i.canDrop(e)&&(t=i),i.fire(r,o));for(let i=0;i<n.length;i++){let s=n[i];s.canDrop(e)&&(t=s),s.fire(r,o)}this._renderDragEffects(e,s,t),this._dropTarget=t}_onDragEnter(e){let{target:t,targets:r}=this.findDragTargets(e),i={e,target:t,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(t,i)}_onDragLeave(e){let t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){let{target:t,targets:r}=this.findDragTargets(e),i=this._basicEventHandler("drop:before",X({e,target:t,subTargets:r,dragSource:this._dragSource},nz(this,e)));i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(e){let t=this.findTarget(e),r=this.targets||[],i=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:r});return this.stopContextMenu&&tL(e),this._basicEventHandler("contextmenu",i),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){let t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return!0===e.isPrimary||!1!==e.isPrimary&&("touchend"===e.type&&0===e.touches.length||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){e.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();let t=this.upperCanvasEl,r=this._getEventPrefix(),i=tw(t);nV(i,"touchend",this._onTouchEnd,nH),nV(i,"touchmove",this._onMouseMove,nH),nG(t,"".concat(r,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();let t=this.upperCanvasEl,r=this._getEventPrefix();nG(t,"".concat(r,"move"),this._onMouseMove,nH);let i=tw(t);nV(i,"".concat(r,"up"),this._onMouseUp),nV(i,"".concat(r,"move"),this._onMouseMove,nH)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),this.mainTouchId=null;let t=this._getEventPrefix(),r=tw(this.upperCanvasEl);nG(r,"touchend",this._onTouchEnd,nH),nG(r,"touchmove",this._onMouseMove,nH),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{nV(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();let t=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(e)){let e=tw(this.upperCanvasEl);nG(e,"".concat(r,"up"),this._onMouseUp),nG(e,"".concat(r,"move"),this._onMouseMove,nH),nV(t,"".concat(r,"move"),this._onMouseMove,nH)}}_onMouseMove(e){let t=this.getActiveObject();this.allowTouchScrolling||t&&t.shouldStartDragging()||!e.preventDefault||e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){let t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;let r,i;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");let n=this._currentTransform,s=this._isClick,o=this._target,{button:a}=e;if(a){(this.fireMiddleClick&&1===a||this.fireRightClick&&2===a)&&this._handleEvent(e,"up"),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(e);return}if(!this._isMainEvent(e))return;let l=!1;if(n&&(this._finalizeCurrentTransform(e),l=n.actionPerformed),!s){let t=o===this._activeObject;this.handleSelection(e),l||(l=this._shouldRender(o)||!t&&o===this._activeObject)}if(o){if(i=o._findTargetCorner(this.getViewportPoint(e),tR(e)),o.selectable&&o!==this._activeObject&&"up"===o.activeOn)this.setActiveObject(o,e),l=!0;else{let t=o.controls[i],s=t&&t.getMouseUpHandler(e,o,t);s&&(r=this.getScenePoint(e),s.call(t,e,n,r.x,r.y))}o.isMoving=!1}if(n&&(n.target!==o||n.corner!==i)){let t=n.target&&n.target.controls[n.corner],i=t&&t.getMouseUpHandler(e,n.target,t);r=r||this.getScenePoint(e),i&&i.call(t,e,n,r.x,r.y)}this._setCursorFromEvent(e,o),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,o&&(o.__corner=void 0),l?this.requestRenderAll():s||null!==(t=this._activeObject)&&void 0!==t&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){let{target:r,subTargets:i=[]}=t;this.fire(e,t),r&&r.fire(e,t);for(let n=0;n<i.length;n++)i[n]!==r&&i[n].fire(e,t);return t}_handleEvent(e,t){let r=this._target,i=this.targets||[],n=X(X({e,target:r,subTargets:i},nz(this,e)),{},{transform:this._currentTransform},"up:before"===t||"up"===t?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),n),r&&r.fire("mouse".concat(t),n);for(let e=0;e<i.length;e++)i[e]!==r&&i[e].fire("mouse".concat(t),n)}endCurrentTransform(e){let t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){let t=this._currentTransform,r=t.target,i={e,target:r,transform:t,action:t.action};r._scaling&&(r._scaling=!1),r.setCoords(),t.actionPerformed&&(this.fire("object:modified",i),r.fire("modified",i))}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){let t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,{button:r}=e;if(r){(this.fireMiddleClick&&1===r||this.fireRightClick&&2===r)&&this._handleEvent(e,"down"),this._resetTransformEventData();return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(e);return}if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(t),n=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,n=!0,i=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){let t=this.getScenePoint(e);this._groupSelector={x:t.x,y:t.y,deltaY:0,deltaX:0}}if(t){let r=t===this._activeObject;t.selectable&&"down"===t.activeOn&&this.setActiveObject(t,e);let i=t._findTargetCorner(this.getViewportPoint(e),tR(e));if(t===this._activeObject&&(i||!n)){this._setupCurrentTransform(e,t,r);let n=t.controls[i],s=this.getScenePoint(e),o=n&&n.getMouseDownHandler(e,t,n);o&&o.call(n,e,this._currentTransform,s.x,s.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=void 0,this._pointer=void 0,this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=tz(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}_beforeTransform(e){let t=this._currentTransform;this.fire("before:transform",{e,transform:t})}__onMouseMove(e){if(this._isClick=!1,this._handleEvent(e,"move:before"),this._cacheTransformEventData(e),this.isDrawingMode){this._onMouseMoveInDrawingMode(e);return}if(!this._isMainEvent(e))return;let t=this._groupSelector;if(t){let r=this.getScenePoint(e);t.deltaX=r.x-t.x,t.deltaY=r.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{let t=this.findTarget(e);this._setCursorFromEvent(e,t),this._fireOverOutEvents(e,t)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){let r=this._hoveredTarget,i=this._hoveredTargets,n=this.targets,s=Math.max(i.length,n.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:r,fireCanvas:!0});for(let t=0;t<s;t++)this.fireSyntheticInOutEvents("mouse",{e,target:n[t],oldTarget:i[t]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){let r=this._draggedoverTarget,i=this._hoveredTargets,n=this.targets,s=Math.max(i.length,n.length);this.fireSyntheticInOutEvents("drag",X(X({},t),{},{target:e,oldTarget:r,fireCanvas:!0}));for(let e=0;e<s;e++)this.fireSyntheticInOutEvents("drag",X(X({},t),{},{target:n[e],oldTarget:i[e]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:r,oldTarget:i,fireCanvas:n,e:s}=t,o=H(t,nY),{targetIn:a,targetOut:l,canvasIn:h,canvasOut:c}=nq[e],u=i!==r;if(i&&u){let e=X(X({},o),{},{e:s,target:i,nextTarget:r},nz(this,s));n&&this.fire(c,e),i.fire(l,e)}if(r&&u){let e=X(X({},o),{},{e:s,target:r,previousTarget:i},nz(this,s));n&&this.fire(h,e),r.fire(a,e)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){let t=this.getScenePoint(e),r=this._currentTransform,i=r.target,n=i.group?tz(t,void 0,i.group.calcTransformMatrix()):t;r.reset=!1,r.shiftKey=e.shiftKey,r.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,r,n),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,r){let i=r.x,n=r.y,s=t.action,o=t.actionHandler,a=!1;o&&(a=o(e,t,i,n)),"drag"===s&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t){this.setCursor(this.defaultCursor);return}let r=t.hoverCursor||this.hoverCursor,i=this._activeObject===this._activeSelection?this._activeObject:null,n=(!i||t.group!==i)&&t._findTargetCorner(this.getViewportPoint(e));if(n){let r=t.controls[n];this.setCursor(r.cursorStyleHandler(e,r,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(e=>{r=e.hoverCursor||r}),this.setCursor(r)}handleMultiSelection(e,t){let r=this._activeObject,i=this._activeSelection,n=r===i;if(r&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(r!==t||n)&&(n||!t.isDescendantOf(r)&&!r.isDescendantOf(t))&&!t.onSelect({e})&&!r.getActiveControl()){if(n){let r=i.getObjects();if(t===i){let i=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(r,i)||this.searchPossibleTargets(this._objects,i))||!t.selectable)return!1}t.group===i?(i.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],1===i.size()&&this._setActiveObject(i.item(0),e)):(i.multiSelectAdd(t),this._hoveredTarget=i,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(r,e)}else r.exitEditing&&r.exitEditing(),i.multiSelectAdd(r,t),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([r],e);return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;let{x:t,y:r,deltaX:i,deltaY:n}=this._groupSelector,s=new eM(t,r),o=s.add(new eM(i,n)),a=s.min(o),l=s.max(o),h=l.subtract(a),c=this.collectObjects({left:a.x,top:a.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),u=s.eq(o)?c[0]?[c[0]]:[]:c.length>1?c.filter(t=>!t.onSelect({e})).reverse():c;return 1===u.length?this.setActiveObject(u[0],e):u.length>1&&(this._activeSelection.add(...u),this.setActiveObject(this._activeSelection,e)),this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}let nK={x1:0,y1:0,x2:0,y2:0},nQ=X(X({},nK),{},{r1:0,r2:0}),nJ=/^(\d+\.\d+)%|(\d+)%$/;function nZ(e){return e&&nJ.test(e)}function n0(e,t){let r="number"==typeof e?e:"string"==typeof e?parseFloat(e)/(nZ(e)?100:1):NaN;return rn(0,eE(r,t),1)}let n1=/\s*;\s*/,n2=/\s*:\s*/;function n5(e){return"linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?"linear":"radial"}function n4(e){return"userSpaceOnUse"===e.getAttribute("gradientUnits")?"pixels":"percentage"}function n3(e,t){return e.getAttribute(t)}class n6{constructor(e){let{type:t="linear",gradientUnits:r="pixels",coords:i,colorStops:n=[],offsetX:s=0,offsetY:o=0,gradientTransform:a,id:l}=e;this.id=l?"".concat(l,"_").concat(eN()):eN(),this.type=t,this.gradientUnits=r,this.gradientTransform=a,this.offsetX=s,this.offsetY=o,this.coords=X(X({},"radial"===this.type?nQ:nK),i),this.colorStops=n.slice()}addColorStop(e){for(let t in e){let r=new tc(e[t]);this.colorStops.push({offset:parseFloat(t),color:r.toRgb(),opacity:r.getAlpha()})}return this}toObject(e){return X(X({},e7(this,e)),{},{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i=this.gradientTransform?this.gradientTransform.concat():ef.concat(),n="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox",s=this.colorStops.map(e=>X({},e)).sort((e,t)=>e.offset-t.offset),o=-this.offsetX,a=-this.offsetY;"objectBoundingBox"===n?(o/=e.width,a/=e.height):(o+=e.width/2,a+=e.height/2),tC(e)&&"percentage"!==this.gradientUnits&&(o-=e.pathOffset.x,a-=e.pathOffset.y),i[4]-=o,i[5]-=a;let l=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(n,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(tp(i),'"'),""].join(" ");if("linear"===this.type){let{x1:e,y1:t,x2:i,y2:n}=this.coords;r.push("<linearGradient ",l,' x1="',e,'" y1="',t,'" x2="',i,'" y2="',n,'">\n')}else if("radial"===this.type){let{x1:e,y1:t,x2:i,y2:n,r1:o,r2:a}=this.coords,h=o>a;r.push("<radialGradient ",l,' cx="',h?e:i,'" cy="',h?t:n,'" r="',h?o:a,'" fx="',h?i:e,'" fy="',h?n:t,'">\n'),h&&(s.reverse(),s.forEach(e=>{e.offset=1-e.offset}));let c=Math.min(o,a);if(c>0){let e=Math.max(o,a),t=c/e;s.forEach(e=>{e.offset+=t*(1-e.offset)})}}return s.forEach(e=>{let{color:t,offset:i,opacity:n}=e;r.push("<stop ",'offset="',100*i+"%",'" style="stop-color:',t,void 0!==n?";stop-opacity: "+n:";",'"/>\n')}),r.push("linear"===this.type?"</linearGradient>":"</radialGradient>","\n"),r.join("")}toLive(e){let t=this.coords,r="linear"===this.type?e.createLinearGradient(t.x1,t.y1,t.x2,t.y2):e.createRadialGradient(t.x1,t.y1,t.r1,t.x2,t.y2,t.r2);return this.colorStops.forEach(e=>{let{color:t,opacity:i,offset:n}=e;r.addColorStop(n,void 0!==i?new tc(t).setAlpha(i).toRgba():t)}),r}static fromElement(e,t,r){var i;let n=n4(e),s=t._findCenterFromElement();return new this(X({id:e.getAttribute("id")||void 0,type:n5(e),coords:(i={width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height},function(e,t){let r,{width:i,height:n,gradientUnits:s}=t;return Object.keys(e).reduce((t,o)=>{let a=e[o];return"Infinity"===a?r=1:"-Infinity"===a?r=0:(r="string"==typeof a?parseFloat(a):a,"string"==typeof a&&nZ(a)&&(r*=.01,"pixels"===s&&(("x1"===o||"x2"===o||"r2"===o)&&(r*=i),("y1"===o||"y2"===o)&&(r*=n)))),t[o]=r,t},{})}("linear"===n5(e)?{x1:n3(e,"x1")||0,y1:n3(e,"y1")||0,x2:n3(e,"x2")||"100%",y2:n3(e,"y2")||0}:{x1:n3(e,"fx")||n3(e,"cx")||"50%",y1:n3(e,"fy")||n3(e,"cy")||"50%",r1:0,x2:n3(e,"cx")||"50%",y2:n3(e,"cy")||"50%",r2:n3(e,"r")||"50%"},X(X({},i),{},{gradientUnits:n4(e)}))),colorStops:function(e,t){let r=[],i=e.getElementsByTagName("stop"),n=n0(t,1);for(let e=i.length;e--;)r.push(function(e,t){let r,i;let n=e.getAttribute("style");if(n){let e=n.split(n1);""===e[e.length-1]&&e.pop();for(let t=e.length;t--;){let[n,s]=e[t].split(n2).map(e=>e.trim());"stop-color"===n?r=s:"stop-opacity"===n&&(i=s)}}let s=new tc(r||e.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:n0(e.getAttribute("offset"),0),color:s.toRgb(),opacity:eE(parseFloat(i||e.getAttribute("stop-opacity")||""),1)*s.getAlpha()*t}}(i[e],n));return r}(e,r.opacity),gradientUnits:n,gradientTransform:iD(e.getAttribute("gradientTransform")||"")},"pixels"===n?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}}Y(n6,"type","Gradient"),eC.setClass(n6,"gradient");let n8=["source"];class n9{get type(){return"pattern"}set type(e){K("warn","Setting type has no effect",e)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Y(this,"repeat","repeat"),Y(this,"offsetX",0),Y(this,"offsetY",0),Y(this,"crossOrigin",""),Y(this,"patternTransform",null),this.id=eN(),Object.assign(this,e)}isImageSource(){return!!this.source&&"string"==typeof this.source.src}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return!this.source||this.isImageSource()&&(!this.source.complete||0===this.source.naturalWidth||0===this.source.naturalHeight)?null:e.createPattern(this.source,this.repeat)}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{repeat:t,crossOrigin:r}=this;return X(X({},e7(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:r,offsetX:tu(this.offsetX,$.NUM_FRACTION_DIGITS),offsetY:tu(this.offsetY,$.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:r}=e,{source:i,repeat:n,id:s}=this,o=eE(this.offsetX/t,0),a=eE(this.offsetY/r,0),l="repeat-y"===n||"no-repeat"===n?1+Math.abs(o||0):eE(i.width/t,0),h="repeat-x"===n||"no-repeat"===n?1+Math.abs(a||0):eE(i.height/r,0);return['<pattern id="SVGID_'.concat(s,'" x="').concat(o,'" y="').concat(a,'" width="').concat(l,'" height="').concat(h,'">'),'<image x="0" y="0" width="'.concat(i.width,'" height="').concat(i.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join("\n")}static async fromObject(e,t){let{source:r}=e,i=H(e,n8),n=await e6(r,X(X({},t),{},{crossOrigin:i.crossOrigin}));return new this(X(X({},i),{},{source:n}))}}Y(n9,"type","Pattern"),eC.setClass(n9),eC.setClass(n9,"pattern");let n7=["path","left","top"],se=["d"];class st extends ii{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{path:r,left:i,top:n}=t;super(H(t,n7)),this._setPath(e||[],!0),"number"==typeof i&&this.set(ep,i),"number"==typeof n&&this.set("top",n)}_setPath(e,t){this.path=nC(Array.isArray(e)?e:nR(e)),this.setBoundingBox(t)}_findCenterFromElement(){let e=this._calcBoundsFromPath();return new eM(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){let t=0,r=0,i=0,n=0,s=0,o=0,a=-this.pathOffset.x,l=-this.pathOffset.y;for(let h of(e.beginPath(),this.path))switch(h[0]){case"L":i=h[1],n=h[2],e.lineTo(i+a,n+l);break;case"M":i=h[1],n=h[2],t=i,r=n,e.moveTo(i+a,n+l);break;case"C":i=h[5],n=h[6],s=h[3],o=h[4],e.bezierCurveTo(h[1]+a,h[2]+l,s+a,o+l,i+a,n+l);break;case"Q":e.quadraticCurveTo(h[1]+a,h[2]+l,h[3]+a,h[4]+l),i=h[3],n=h[4],s=h[1],o=h[2];break;case"Z":i=t,n=r,e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return X(X({},super.toObject(e)),{},{path:rk(this.path)})}toDatalessObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){let e=nL(this.path,$.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,'" stroke-linecap="round" />\n')]}_getOffsetTransform(){let e=$.NUM_FRACTION_DIGITS;return" translate(".concat(tu(-this.pathOffset.x,e),", ").concat(tu(-this.pathOffset.y,e),")")}toClipPathSVG(e){let t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){let t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{width:t,height:r,pathOffset:i}=this._calcDimensions();this.set({width:t,height:r,pathOffset:i}),e&&this.setPositionByOrigin(i,eg,eg)}_calcBoundsFromPath(){let e=[],t=0,r=0,i=0,n=0;for(let s of this.path)switch(s[0]){case"L":i=s[1],n=s[2],e.push(new eM(t,r),new eM(i,n));break;case"M":i=s[1],n=s[2],t=i,r=n;break;case"C":e.push(...n_(i,n,s[1],s[2],s[3],s[4],s[5],s[6])),i=s[5],n=s[6];break;case"Q":e.push(...n_(i,n,s[1],s[2],s[1],s[2],s[3],s[4])),i=s[3],n=s[4];break;case"Z":i=t,n=r}return tI(e)}_calcDimensions(){let e=this._calcBoundsFromPath();return X(X({},e),{},{pathOffset:new eM(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,r){let i=iF(e,this.ATTRIBUTE_NAMES,r),{d:n}=i,s=H(i,se);return new this(n,X(X(X({},s),t),{},{left:void 0,top:void 0}))}}Y(st,"type","Path"),Y(st,"cacheProperties",[...rM,"path","fillRule"]),Y(st,"ATTRIBUTE_NAMES",[...io,"d"]),eC.setClass(st),eC.setSVGClass(st);let sr=["left","top","radius"],si=["radius","startAngle","endAngle"];class sn extends ii{static getDefaults(){return X(X({},super.getDefaults()),sn.ownDefaults)}_set(e,t){return super._set(e,t),"radius"===e&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,eY(this.startAngle),eY(this.endAngle),!1),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get("scaleX")}getRadiusY(){return this.get("radius")*this.get("scaleY")}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject([...si,...e])}_toSVG(){let e=(this.endAngle-this.startAngle)%360;if(0===e)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),'" />\n'];{let{radius:t}=this,r=eY(this.startAngle),i=eY(this.endAngle),n=ek(r)*t,s=ej(r)*t,o=ek(i)*t,a=ej(i)*t;return['<path d="M '.concat(n," ").concat(s)," A ".concat(t," ").concat(t)," 0 ","".concat(e>180?"1":"0"," 1")," ".concat(o," ").concat(a),'" ',"COMMON_PARTS"," />\n"]}}static async fromElement(e,t,r){let i=iF(e,this.ATTRIBUTE_NAMES,r),{left:n=0,top:s=0,radius:o=0}=i,a=H(i,sr);return new this(X(X({},a),{},{radius:o,left:n-o,top:s-o}))}static fromObject(e){return super._fromObject(e)}}Y(sn,"type","Circle"),Y(sn,"cacheProperties",[...rM,...si]),Y(sn,"ownDefaults",{radius:0,startAngle:0,endAngle:360}),Y(sn,"ATTRIBUTE_NAMES",["cx","cy","r",...io]),eC.setClass(sn),eC.setSVGClass(sn);let ss=["x1","y1","x2","y2"],so=["x1","y1","x2","y2"],sa=["x1","x2","y1","y2"];class sl extends ii{constructor(){let[e,t,r,i]=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(X(X({},n),{},{x1:e,y1:t,x2:r,y2:i})),this._setWidthHeight();let{left:s,top:o}=n;"number"==typeof s&&this.set(ep,s),"number"==typeof o&&this.set("top",o)}_setWidthHeight(){let{x1:e,y1:t,x2:r,y2:i}=this;this.width=Math.abs(r-e),this.height=Math.abs(i-t);let{left:n,top:s,width:o,height:a}=tI([{x:e,y:t},{x:r,y:i}]),l=new eM(n+o/2,s+a/2);this.setPositionByOrigin(l,eg,eg)}_set(e,t){return super._set(e,t),sa.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();let t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;let r=e.strokeStyle;if(ty(this.stroke))e.strokeStyle=this.stroke.toLive(e);else{var i;e.strokeStyle=null!==(i=this.stroke)&&void 0!==i?i:e.fillStyle}this.stroke&&this._renderStroke(e),e.strokeStyle=r}_findCenterFromElement(){return new eM((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return X(X({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){let e=super._getNonTransformedDimensions();return"butt"===this.strokeLineCap&&(0===this.width&&(e.y-=this.strokeWidth),0===this.height&&(e.x-=this.strokeWidth)),e}calcLinePoints(){let{x1:e,x2:t,y1:r,y2:i,width:n,height:s}=this,o=e<=t?-1:1,a=r<=i?-1:1;return{x1:o*n/2,x2:-(o*n)/2,y1:a*s/2,y2:-(a*s)/2}}_toSVG(){let{x1:e,x2:t,y1:r,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(r,'" x2="').concat(t,'" y2="').concat(i,'" />\n')]}static async fromElement(e,t,r){let i=iF(e,this.ATTRIBUTE_NAMES,r),{x1:n=0,y1:s=0,x2:o=0,y2:a=0}=i,l=H(i,ss);return new this([n,s,o,a],l)}static fromObject(e){let{x1:t,y1:r,x2:i,y2:n}=e,s=H(e,so);return this._fromObject(X(X({},s),{},{points:[t,r,i,n]}),{extraParam:"points"})}}Y(sl,"type","Line"),Y(sl,"cacheProperties",[...rM,...sa]),Y(sl,"ATTRIBUTE_NAMES",io.concat(sa)),eC.setClass(sl),eC.setSVGClass(sl);class sh extends ii{static getDefaults(){return X(X({},super.getDefaults()),sh.ownDefaults)}_render(e){let t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,r),e.lineTo(0,-r),e.lineTo(t,r),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){let e=this.width/2,t=this.height/2,r="".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t);return["<polygon ","COMMON_PARTS",'points="',r,'" />']}}Y(sh,"type","Triangle"),Y(sh,"ownDefaults",{width:100,height:100}),eC.setClass(sh),eC.setSVGClass(sh);let sc=["rx","ry"];class su extends ii{static getDefaults(){return X(X({},super.getDefaults()),su.ownDefaults)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get("scaleX")}getRy(){return this.get("ry")*this.get("scaleY")}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject([...sc,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,'" />\n')]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,eu,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,r){let i=iF(e,this.ATTRIBUTE_NAMES,r);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)}}Y(su,"type","Ellipse"),Y(su,"cacheProperties",[...rM,...sc]),Y(su,"ownDefaults",{rx:0,ry:0}),Y(su,"ATTRIBUTE_NAMES",[...io,"cx","cy","rx","ry"]),eC.setClass(su),eC.setSVGClass(su);let sd=["left","top"],sf={exactBoundingBox:!1};class sg extends ii{static getDefaults(){return X(X({},super.getDefaults()),sg.ownDefaults)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(X({points:e},t)),Y(this,"strokeDiff",void 0);let{left:r,top:i}=t;this.initialized=!0,this.setBoundingBox(!0),"number"==typeof r&&this.set(ep,r),"number"==typeof i&&this.set("top",i)}isOpen(){return!0}_projectStrokeOnPoints(e){return i1(this.points,e,this.isOpen())}_calcDimensions(e){e=X({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});let t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(e=>e.projectedPoint):this.points;if(0===t.length)return{left:0,top:0,width:0,height:0,pathOffset:new eM,strokeOffset:new eM,strokeDiff:new eM};let r=tI(t),i=e4(X(X({},e),{},{scaleX:1,scaleY:1})),n=tI(this.points.map(e=>eV(e,i,!0))),s=r.left+r.width/2,o=r.top+r.height/2,a=s-o*Math.tan(eY(this.skewX)),l=o-a*Math.tan(eY(this.skewY)),h=new eM(this.scaleX,this.scaleY);return X(X({},r),{},{pathOffset:new eM(a,l),strokeOffset:new eM(n.left,n.top).subtract(new eM(r.left,r.top)).multiply(h),strokeDiff:new eM(r.width,r.height).subtract(new eM(n.width,n.height)).multiply(h)})}_findCenterFromElement(){let e=tI(this.points);return new eM(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{left:t,top:r,width:i,height:n,pathOffset:s,strokeOffset:o,strokeDiff:a}=this._calcDimensions();this.set({width:i,height:n,pathOffset:s,strokeOffset:o,strokeDiff:a}),e&&this.setPositionByOrigin(new eM(t+i/2,r+n/2),eg,eg)}_getNonTransformedDimensions(){return this.exactBoundingBox?new eM(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.exactBoundingBox)return super._getTransformedDimensions(e);{var t,r,i,n;let s;if(Object.keys(e).some(e=>this.strokeUniform||this.constructor.layoutProperties.includes(e))){let{width:i,height:n}=this._calcDimensions(e);s=new eM(null!==(t=e.width)&&void 0!==t?t:i,null!==(r=e.height)&&void 0!==r?r:n)}else s=new eM(null!==(i=e.width)&&void 0!==i?i:this.width,null!==(n=e.height)&&void 0!==n?n:this.height);return s.multiply(new eM(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}}_set(e,t){let r=this.initialized&&this[e]!==t,i=super._set(e,t);return this.exactBoundingBox&&r&&(("scaleX"===e||"scaleY"===e)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),i}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return X(X({},super.toObject(e)),{},{points:rk(this.points)})}_toSVG(){let e=[],t=this.pathOffset.x,r=this.pathOffset.y,i=$.NUM_FRACTION_DIGITS;for(let n=0,s=this.points.length;n<s;n++)e.push(tu(this.points[n].x-t,i),",",tu(this.points[n].y-r,i)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),'" />\n')]}_render(e){let t=this.points.length,r=this.pathOffset.x,i=this.pathOffset.y;if(!(!t||isNaN(this.points[t-1].y))){e.beginPath(),e.moveTo(this.points[0].x-r,this.points[0].y-i);for(let n=0;n<t;n++){let t=this.points[n];e.lineTo(t.x-r,t.y-i)}this.isOpen()||e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,r){let i=function(e){if(!e)return[];let t=e.replace(/,/g," ").trim().split(/\s+/),r=[];for(let e=0;e<t.length;e+=2)r.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return r}(e.getAttribute("points")),n=iF(e,this.ATTRIBUTE_NAMES,r),s=H(n,sd);return new this(i,X(X({},s),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}Y(sg,"ownDefaults",sf),Y(sg,"type","Polyline"),Y(sg,"layoutProperties",["skewX","skewY","strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),Y(sg,"cacheProperties",[...rM,"points"]),Y(sg,"ATTRIBUTE_NAMES",[...io]),eC.setClass(sg),eC.setSVGClass(sg);class sp extends sg{static getDefaults(){return X(X({},super.getDefaults()),sg.ownDefaults)}isOpen(){return!1}}Y(sp,"ownDefaults",sf),Y(sp,"type","Polygon"),eC.setClass(sp),eC.setSVGClass(sp);let sm=["fontSize","fontWeight","fontFamily","fontStyle"],sv=["underline","overline","linethrough"],sy=[...sm,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],sx=[...sy,...sv,"textBackgroundColor","direction"],s_=[...sm,...sv,"stroke","strokeWidth","fill","deltaY","textBackgroundColor"],sb="justify",sC="justify-left",sS="justify-right",sw="justify-center";class sT extends ii{isEmptyStyles(e){if(!this.styles||void 0!==e&&!this.styles[e])return!0;let t=void 0===e?this.styles:{line:this.styles[e]};for(let e in t)for(let r in t[e])for(let i in t[e][r])return!1;return!0}styleHas(e,t){if(!this.styles||void 0!==t&&!this.styles[t])return!1;let r=void 0===t?this.styles:{0:this.styles[t]};for(let t in r)for(let i in r[t])if(void 0!==r[t][i][e])return!0;return!1}cleanStyle(e){if(!this.styles)return!1;let t=this.styles,r=0,i,n,s=!0,o=0;for(let o in t){for(let a in i=0,t[o]){let l=t[o][a]||{},h=void 0!==l[e];r++,h?(n?l[e]!==n&&(s=!1):n=l[e],l[e]===this[e]&&delete l[e]):s=!1,0!==Object.keys(l).length?i++:delete t[o][a]}0===i&&delete t[o]}for(let e=0;e<this._textLines.length;e++)o+=this._textLines[e].length;s&&r===o&&(this[e]=n,this.removeStyle(e))}removeStyle(e){let t,r,i;if(!this.styles)return;let n=this.styles;for(r in n){for(i in t=n[r])delete t[i][e],0===Object.keys(t[i]).length&&delete t[i];0===Object.keys(t).length&&delete n[r]}}_extendStyles(e,t){let{lineIndex:r,charIndex:i}=this.get2DCursorLocation(e);this._getLineStyle(r)||this._setLineStyle(r),Object.keys(this._getStyleDeclaration(r,i)).length||this._setStyleDeclaration(r,i,{}),Object.assign(this._getStyleDeclaration(r,i),t)}getSelectionStyles(e,t,r){let i=[];for(let n=e;n<(t||e);n++)i.push(this.getStyleAtPosition(n,r));return i}getStyleAtPosition(e,t){let{lineIndex:r,charIndex:i}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(r,i):this._getStyleDeclaration(r,i)}setSelectionStyles(e,t,r){for(let i=t;i<(r||t);i++)this._extendStyles(i,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var r;let i=this.styles&&this.styles[e];return i&&null!==(r=i[t])&&void 0!==r?r:{}}getCompleteStyleDeclaration(e,t){return X(X({},e7(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,r){this.styles[e][t]=r}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}Y(sT,"_styleProperties",s_);let sO=/  +/g,sE=/"/g;function sP(e,t,r,i,n){return"		".concat(tv(e,{left:t,top:r,width:i,height:n}),"\n")}class sk extends t3{_toSVG(){let e=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(e.textTop,e.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(e){let{textBgRects:t,textSpans:r}=e,i=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(sE,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",i?'text-decoration="'.concat(i,'" '):"","rtl"===this.direction?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",r.join(""),"</text>\n"]}_getSVGTextAndBg(e,t){let r=[],i=[],n=e,s;this.backgroundColor&&i.push(...sP(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let e=0,o=this._textLines.length;e<o;e++)s=this._getLineLeftOffset(e),"rtl"===this.direction&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",e))&&this._setSVGTextLineBg(i,e,t+s,n),this._setSVGTextLineText(r,e,t+s,n),n+=this.getHeightOfLine(e);return{textSpans:r,textBgRects:i}}_createTextCharSpan(e,t,r,i){let n=this.getSvgSpanStyles(t,e!==e.trim()||!!e.match(sO)),s=t.deltaY,o=s?' dy="'.concat(tu(s,$.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(tu(r,$.NUM_FRACTION_DIGITS),'" y="').concat(tu(i,$.NUM_FRACTION_DIGITS),'" ').concat(o).concat(n?'style="'.concat(n,'"'):"",">").concat(i8(e),"</tspan>")}_setSVGTextLineText(e,t,r,i){let n=this.getHeightOfLine(t),s=this.textAlign.includes(sb),o=this._textLines[t],a,l,h="",c,u,d=0,f;i+=n*(1-this._fontSizeFraction)/this.lineHeight;for(let n=0,g=o.length-1;n<=g;n++)f=n===g||this.charSpacing,h+=o[n],c=this.__charBounds[t][n],0===d?(r+=c.kernedWidth-c.width,d+=c.width):d+=c.kernedWidth,s&&!f&&this._reSpaceAndTab.test(o[n])&&(f=!0),f||(f=i2(a=a||this.getCompleteStyleDeclaration(t,n),l=this.getCompleteStyleDeclaration(t,n+1),!0)),f&&(u=this._getStyleDeclaration(t,n),e.push(this._createTextCharSpan(h,u,r,i)),h="",a=l,"rtl"===this.direction?r-=d:r+=d,d=0)}_setSVGTextLineBg(e,t,r,i){let n=this._textLines[t],s=this.getHeightOfLine(t)/this.lineHeight,o=0,a=0,l,h=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let c=0;c<n.length;c++){let{left:n,width:u,kernedWidth:d}=this.__charBounds[t][c];(l=this.getValueOfPropertyAt(t,c,"textBackgroundColor"))!==h?(h&&e.push(...sP(h,r+a,i,o,s)),a=n,o=u,h=l):o+=d}l&&e.push(...sP(h,r+a,i,o,s))}_getSVGLineTopOffset(e){let t=0,r;for(r=0;r<e;r++)t+=this.getHeightOfLine(r);let i=this.getHeightOfLine(r);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(e){return"".concat(super.getSvgStyles(e)," white-space: pre;")}getSvgSpanStyles(e,t){let{fontFamily:r,strokeWidth:i,stroke:n,fill:s,fontSize:o,fontStyle:a,fontWeight:l,deltaY:h}=e,c=this.getSvgTextDecoration(e);return[n?tm("stroke",n):"",i?"stroke-width: ".concat(i,"; "):"",r?"font-family: ".concat(r.includes("'")||r.includes('"')?r:"'".concat(r,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",c?"text-decoration: ".concat(c,"; "):c,s?tm("fill",s):"",h?"baseline-shift: ".concat(-h,"; "):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(e){return["overline","underline","line-through"].filter(t=>e[t.replace("-","")]).join(" ")}}let sj=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];class sM extends sT{static getDefaults(){return X(X({},super.getDefaults()),sM.ownDefaults)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(X(X({},t),{},{text:e,styles:(null==t?void 0:t.styles)||{}})),Y(this,"__charBounds",[]),this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){let e=this.path;e&&(e.segmentsInfo=nA(e.path))}_splitText(){let e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(sb)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,r,i,n,s,o;for(let a=0,l=this._textLines.length;a<l;a++)if(!(this.textAlign!==sb&&(a===l-1||this.isEndOfWrapping(a)))&&(i=0,n=this._textLines[a],(t=this.getLineWidth(a))<this.width&&(o=this.textLines[a].match(this._reSpacesAndTabs)))){r=o.length,e=(this.width-t)/r;for(let t=0;t<=n.length;t++)s=this.__charBounds[a][t],this._reSpaceAndTab.test(n[t])?(s.width+=e,s.kernedWidth+=e,s.left+=i,i+=e):s.left+=i}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){let r;let i=t?this._unwrappedTextLines:this._textLines;for(r=0;r<i.length;r++){if(e<=i[r].length)return{lineIndex:r,charIndex:e};e-=i[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:i[r-1].length<e?i[r-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){let e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){let t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){"stroke"===this.paintFirst?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,r){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case eg:e.textBaseline="middle";break;case"ascender":e.textBaseline="top";break;case"descender":e.textBaseline=em}e.font=this._getFontDeclaration(t,r)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,r=this._textLines.length;t<r;t++){let r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,r,i,n,s){this._renderChars(e,t,r,i,n,s)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let t=e.fillStyle,r=this._getLeftOffset(),i=this._getTopOffset();for(let t=0,n=this._textLines.length;t<n;t++){let n,s;let o=this.getHeightOfLine(t);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",t)){i+=o;continue}let a=this._textLines[t].length,l=this._getLineLeftOffset(t),h=0,c=0,u=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let d=0;d<a;d++){let a=this.__charBounds[t][d];s=this.getValueOfPropertyAt(t,d,"textBackgroundColor"),this.path?(e.save(),e.translate(a.renderLeft,a.renderTop),e.rotate(a.angle),e.fillStyle=s,s&&e.fillRect(-a.width/2,-o/this.lineHeight*(1-this._fontSizeFraction),a.width,o/this.lineHeight),e.restore()):s!==u?(n=r+l+c,"rtl"===this.direction&&(n=this.width-n-h),e.fillStyle=u,u&&e.fillRect(n,i,h,o/this.lineHeight),c=a.left,h=a.width,u=s):h+=a.kernedWidth}s&&!this.path&&(n=r+l+c,"rtl"===this.direction&&(n=this.width-n-h),e.fillStyle=s,e.fillRect(n,i,h,o/this.lineHeight)),i+=o}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,r,i){let n,o,a,l;let h=ea.getFontCache(t),c=this._getFontDeclaration(t),u=r+e,d=r&&c===this._getFontDeclaration(i),f=t.fontSize/this.CACHE_FONT_SIZE;if(r&&void 0!==h[r]&&(a=h[r]),void 0!==h[e]&&(l=n=h[e]),d&&void 0!==h[u]&&(l=(o=h[u])-a),void 0===n||void 0===a||void 0===o){let i=(s||(s=eB().getContext("2d")),s);this._setTextStyles(i,t,!0),void 0===n&&(l=n=i.measureText(e).width,h[e]=n),void 0===a&&d&&r&&(a=i.measureText(r).width,h[r]=a),d&&void 0===o&&(o=i.measureText(u).width,h[u]=o,l=o-a)}return{width:n*f,kernedWidth:l*f}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){let t=this._measureLine(e);return 0!==this.charSpacing&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t=0,r,i,n=this.pathSide===ev,s=this.path,o=this._textLines[e],a=o.length,l=Array(a);this.__charBounds[e]=l;for(let n=0;n<a;n++){let s=o[n];i=this._getGraphemeBox(s,e,n,r),l[n]=i,t+=i.kernedWidth,r=s}if(l[a]={left:i?i.left+i.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},s&&s.segmentsInfo){let e=0,r=s.segmentsInfo[s.segmentsInfo.length-1].length;switch(this.textAlign){case ep:e=n?r-t:0;break;case eg:e=(r-t)/2;break;case ev:e=n?0:r-t}e+=this.pathStartOffset*(n?-1:1);for(let t=n?a-1:0;n?t>=0:t<a;n?t--:t++)i=l[t],e>r?e%=r:e<0&&(e+=r),this._setGraphemeOnPath(e,i),e+=i.kernedWidth}return{width:t,numOfSpaces:0}}_setGraphemeOnPath(e,t){let r=e+t.kernedWidth/2,i=this.path,n=nF(i.path,r,i.segmentsInfo);t.renderLeft=n.x-i.pathOffset.x,t.renderTop=n.y-i.pathOffset.y,t.angle=n.angle+(this.pathSide===ev?Math.PI:0)}_getGraphemeBox(e,t,r,i,n){let s=this.getCompleteStyleDeclaration(t,r),o=i?this.getCompleteStyleDeclaration(t,r-1):{},a=this._measureChar(e,s,i,o),l=a.kernedWidth,h=a.width,c;0!==this.charSpacing&&(h+=c=this._getWidthOfCharSpacing(),l+=c);let u={width:h,left:0,height:s.fontSize,kernedWidth:l,deltaY:s.deltaY};if(r>0&&!n){let e=this.__charBounds[t][r-1];u.left=e.left+e.width+a.kernedWidth-a.width}return u}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let r=1,i=this._textLines[e].length;r<i;r++)t=Math.max(this.getHeightOfChar(e,r),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let r=0,i=this._textLines.length;r<i;r++)e=this.getHeightOfLine(r),t+=r===i-1?e/this.lineHeight:e;return t}_getLeftOffset(){return"ltr"===this.direction?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let r=0,i=this._getLeftOffset(),n=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){let o=this.getHeightOfLine(s),a=o/this.lineHeight,l=this._getLineLeftOffset(s);this._renderTextLine(t,e,this._textLines[s],i+l,n+r+a,s),r+=o}e.restore()}_renderTextFill(e){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(!this.stroke||0===this.strokeWidth)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,r,i,n,s){let o=this.getHeightOfLine(s),a=this.textAlign.includes(sb),l=this.path,h=!a&&0===this.charSpacing&&this.isEmptyStyles(s)&&!l,c="ltr"===this.direction,u="ltr"===this.direction?1:-1,d=t.direction,f,g,p="",m,v=0,y,x;if(t.save(),d!==this.direction&&(t.canvas.setAttribute("dir",c?"ltr":"rtl"),t.direction=c?"ltr":"rtl",t.textAlign=c?ep:ev),n-=o*this._fontSizeFraction/this.lineHeight,h){this._renderChar(e,t,s,0,r.join(""),i,n),t.restore();return}for(let o=0,h=r.length-1;o<=h;o++)y=o===h||this.charSpacing||l,p+=r[o],m=this.__charBounds[s][o],0===v?(i+=u*(m.kernedWidth-m.width),v+=m.width):v+=m.kernedWidth,a&&!y&&this._reSpaceAndTab.test(r[o])&&(y=!0),y||(y=i2(f=f||this.getCompleteStyleDeclaration(s,o),g=this.getCompleteStyleDeclaration(s,o+1),!1)),y&&(l?(t.save(),t.translate(m.renderLeft,m.renderTop),t.rotate(m.angle),this._renderChar(e,t,s,o,p,-v/2,0),t.restore()):(x=i,this._renderChar(e,t,s,o,p,x,n)),p="",f=g,i+=u*v,v=0);t.restore()}_applyPatternGradientTransformText(e){let t=eB(),r=this.width+this.strokeWidth,i=this.height+this.strokeWidth,n=t.getContext("2d");return t.width=r,t.height=i,n.beginPath(),n.moveTo(0,0),n.lineTo(r,0),n.lineTo(r,i),n.lineTo(0,i),n.closePath(),n.translate(r/2,i/2),n.fillStyle=e.toLive(n),this._applyPatternGradientTransform(n,e),n.fill(),n.createPattern(t,"no-repeat")}handleFiller(e,t,r){let i,n;return ty(r)?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?(i=-this.width/2,n=-this.height/2,e.translate(i,n),e[t]=this._applyPatternGradientTransformText(r),{offsetX:i,offsetY:n}):(e[t]=r.toLive(e),this._applyPatternGradientTransform(e,r)):(e[t]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:r,strokeWidth:i}=t;return e.lineWidth=i,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",r)}_setFillStyles(e,t){let{fill:r}=t;return this.handleFiller(e,"fillStyle",r)}_renderChar(e,t,r,i,n,s,o){let a=this._getStyleDeclaration(r,i),l=this.getCompleteStyleDeclaration(r,i),h="fillText"===e&&l.fill,c="strokeText"===e&&l.stroke&&l.strokeWidth;if(c||h){if(t.save(),t.font=this._getFontDeclaration(l),a.textBackgroundColor&&this._removeShadow(t),a.deltaY&&(o+=a.deltaY),h){let e=this._setFillStyles(t,l);t.fillText(n,s-e.offsetX,o-e.offsetY)}if(c){let e=this._setStrokeStyles(t,l);t.strokeText(n,s-e.offsetX,o-e.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,r){let i=this.get2DCursorLocation(e,!0),n=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),s=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),o={fontSize:n*r.size,deltaY:s+n*r.baseline};this.setSelectionStyles(o,e,t)}_getLineLeftOffset(e){let t=this.getLineWidth(e),r=this.width-t,i=this.textAlign,n=this.direction,s=this.isEndOfWrapping(e),o=0;return i!==sb&&(i!==sw||s)&&(i!==sS||s)&&(i!==sC||s)?(i===eg&&(o=r/2),i===ev&&(o=r),i===sw&&(o=r/2),i===sS&&(o=r),"rtl"===n&&(i===ev||i===sb||i===sS?o=0:i===ep||i===sC?o=-r:(i===eg||i===sw)&&(o=-r/2)),o):0}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(void 0!==this.__lineWidths[e])return this.__lineWidths[e];let{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,r){var i;let n=this._getStyleDeclaration(e,t);return null!==(i=n[r])&&void 0!==i?i:this[r]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let r=this._getTopOffset(),i=this._getLeftOffset(),n=this.path,s=this._getWidthOfCharSpacing(),o=this.offsets[t];for(let a=0,l=this._textLines.length;a<l;a++){let l,h;let c=this.getHeightOfLine(a);if(!this[t]&&!this.styleHas(t,a)){r+=c;continue}let u=this._textLines[a],d=c/this.lineHeight,f=this._getLineLeftOffset(a),g=0,p=0,m=this.getValueOfPropertyAt(a,0,t),v=this.getValueOfPropertyAt(a,0,"fill"),y=r+d*(1-this._fontSizeFraction),x=this.getHeightOfChar(a,0),_=this.getValueOfPropertyAt(a,0,"deltaY");for(let r=0,s=u.length;r<s;r++){let s=this.__charBounds[a][r];l=this.getValueOfPropertyAt(a,r,t),h=this.getValueOfPropertyAt(a,r,"fill");let c=this.getHeightOfChar(a,r),u=this.getValueOfPropertyAt(a,r,"deltaY");if(n&&l&&h)e.save(),e.fillStyle=v,e.translate(s.renderLeft,s.renderTop),e.rotate(s.angle),e.fillRect(-s.kernedWidth/2,o*c+u,s.kernedWidth,this.fontSize/15),e.restore();else if((l!==m||h!==v||c!==x||u!==_)&&p>0){let t=i+f+g;"rtl"===this.direction&&(t=this.width-t-p),m&&v&&(e.fillStyle=v,e.fillRect(t,y+o*x+_,p,this.fontSize/15)),g=s.left,p=s.width,m=l,v=h,x=c,_=u}else p+=s.kernedWidth}let b=i+f+g;"rtl"===this.direction&&(b=this.width-b-p),e.fillStyle=h,l&&h&&e.fillRect(b,y+o*x+_,p-s,this.fontSize/15),r+=c}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,s=e.includes("'")||e.includes('"')||e.includes(",")||sM.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,r,"".concat(n?this.CACHE_FONT_SIZE:i,"px"),s].join(" ")}render(e){this.visible&&(!this.canvas||!this.canvas.skipOffscreen||this.group||this.isOnScreen())&&(this._forceClearCache&&this.initDimensions(),super.render(e))}graphemeSplit(e){return i9(e)}_splitTextIntoLines(e){let t=e.split(this._reNewline),r=Array(t.length),i=["\n"],n=[];for(let e=0;e<t.length;e++)r[e]=this.graphemeSplit(t[e]),n=n.concat(r[e],i);return n.pop(),{_unwrappedLines:r,lines:t,graphemeText:n,graphemeLines:r}}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return X(X({},super.toObject([...sx,...e])),{},{styles:i5(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){let{textLayoutProperties:r}=this.constructor;super.set(e,t);let i=!1,n=!1;if("object"==typeof e)for(let t in e)"path"===t&&this.setPathInfo(),i=i||r.includes(t),n=n||"path"===t;else i=r.includes(e),n="path"===e;return n&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,r){let i=iF(e,sM.ATTRIBUTE_NAMES,r),n=X(X({},t),i),{textAnchor:s=ep,textDecoration:o="",dx:a=0,dy:l=0,top:h=0,left:c=0,fontSize:u=16,strokeWidth:d=1}=n,f=H(n,sj),g=(e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),p=new this(g,X({left:c+a,top:h+l,underline:o.includes("underline"),overline:o.includes("overline"),linethrough:o.includes("line-through"),strokeWidth:0,fontSize:u},f)),m=p.getScaledHeight()/p.height,v=(p.height+p.strokeWidth)*p.lineHeight-p.height,y=p.getScaledHeight()+v*m,x=0;return s===eg&&(x=p.getScaledWidth()/2),s===ev&&(x=p.getScaledWidth()),p.set({left:p.left-x,top:p.top-(y-p.fontSize*(.07+p._fontSizeFraction))/p.lineHeight,strokeWidth:d}),p}static fromObject(e){return this._fromObject(X(X({},e),{},{styles:i4(e.styles||{},e.text)}),{extraParam:"text"})}}Y(sM,"textLayoutProperties",sy),Y(sM,"cacheProperties",[...rM,...sx]),Y(sM,"ownDefaults",{_reNewline:ex,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:ep,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:ep,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2}),Y(sM,"type","Text"),Y(sM,"genericFonts",["sans-serif","serif","cursive","fantasy","monospace"]),Y(sM,"ATTRIBUTE_NAMES",io.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),ir(sM,[sk]),eC.setClass(sM),eC.setSVGClass(sM);class sD{constructor(e){Y(this,"target",void 0),Y(this,"__mouseDownInPlace",!1),Y(this,"__dragStartFired",!1),Y(this,"__isDraggingOver",!1),Y(this,"__dragStartSelection",void 0),Y(this,"__dragImageDisposer",void 0),Y(this,"_dispose",void 0),this.target=e;let t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(e=>e()),this._dispose=void 0}}isPointerOverSelection(e){let t=this.target,r=t.getSelectionStartFromPointer(e);return t.isEditing&&r>=t.selectionStart&&r<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){let t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var r;let{selectionStart:i,selectionEnd:n}=t,s=this.target,o=s.canvas,a=new eM(s.flipX?-1:1,s.flipY?-1:1),l=s._getCursorBoundaries(i),h=new eM(l.left+l.leftOffset,l.top+l.topOffset).multiply(a),c=h.transform(s.calcTransformMatrix()),u=o.getScenePoint(e),d=u.subtract(c),f=o._isRetinaScaling(),g=s.getCanvasRetinaScaling(),p=s.getBoundingRect(),m=c.subtract(new eM(p.left,p.top)),v=o.viewportTransform,y=m.add(d).transform(v,!0),x=s.backgroundColor,_=rk(s.styles);s.backgroundColor="";let b={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};s.setSelectionStyles(b,0,i),s.setSelectionStyles(b,n,s.text.length),s.dirty=!0;let C=s.toCanvasElement({enableRetinaScaling:f,viewportTransform:!0});s.backgroundColor=x,s.styles=_,s.dirty=!0,tO(C,{position:"fixed",left:"".concat(-C.width,"px"),border:ey,width:"".concat(C.width/g,"px"),height:"".concat(C.height/g,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{C.remove()},tw(e.target||this.target.hiddenTextarea).body.appendChild(C),null===(r=e.dataTransfer)||void 0===r||r.setDragImage(C,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;let t=this.target,r=this.isActive();if(r&&e.dataTransfer){let r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},i=t._text.slice(r.selectionStart,r.selectionEnd).join(""),n=X({text:t.text,value:i},r);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,n)}return t.abortCursorAnimation(),r}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let t=this.target.getSelectionStartFromPointer(e),r=this.__dragStartSelection;return t<r.selectionStart||t>r.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e,r=this.targetCanDrop(t);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(e){let{e:t}=e,r=this.targetCanDrop(t);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;let{e:r}=e,i=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let n=null===(t=r.dataTransfer)||void 0===t?void 0:t.getData("text/plain");if(n&&!i){let t=this.target,i=t.canvas,s=t.getSelectionStartFromPointer(r),{styles:o}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},a=n[Math.max(0,n.length-1)];if(this.__dragStartSelection){let e=this.__dragStartSelection.selectionStart,r=this.__dragStartSelection.selectionEnd;s>e&&s<=r?s=e:s>r&&(s-=r-e),t.removeChars(e,r),delete this.__dragStartSelection}t._reNewline.test(a)&&(t._reNewline.test(t._text[s])||s===t._text.length)&&(n=n.trimEnd()),e.didDrop=!0,e.dropTarget=t,t.insertChars(n,o,s),i.setActiveObject(t),t.enterEditing(r),t.selectionStart=Math.min(s+0,t._text.length),t.selectionEnd=Math.min(t.selectionStart+n.length,t._text.length),t.hiddenTextarea.value=t.text,t._updateTextarea(),t.hiddenTextarea.focus(),t.fire("changed",{index:s+0,action:"drop"}),i.fire("text:changed",{target:t}),i.contextTopDirty=!0,i.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;let e=this.target,i=this.target.canvas,{selectionStart:n,selectionEnd:s}=this.__dragStartSelection,o=(null===(r=t.dataTransfer)||void 0===r?void 0:r.dropEffect)||ey;o===ey?(e.selectionStart=n,e.selectionEnd=s,e._updateTextarea(),e.hiddenTextarea.focus()):(e.clearContextTop(),"move"===o&&(e.removeChars(n,s),e.selectionStart=e.selectionEnd=n,e.hiddenTextarea&&(e.hiddenTextarea.value=e.text),e._updateTextarea(),e.fire("changed",{index:n,action:"dragend"}),i.fire("text:changed",{target:e}),i.requestRenderAll()),e.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}let sA=/[ \n\.,;!\?\-]/;class sF extends sM{constructor(){super(...arguments),Y(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:r,delay:i,onComplete:n}=e;return rc({startValue:this._currentCursorOpacity,endValue:t,duration:r,delay:i,onComplete:n,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:e=>{this._currentCursorOpacity=e,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:1,duration:this.cursorDuration,delay:e,onComplete:this._onTickComplete})}_onTickComplete(){var e;null===(e=this._currentTickCompleteState)||void 0===e||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:100,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r--;for(;/\S/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findWordBoundaryRight(e){let t=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}findLineBoundaryLeft(e){let t=0,r=e-1;for(;!/\n/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findLineBoundaryRight(e){let t=0,r=e;for(;!/\n/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}searchWordBoundary(e,t){let r=this._text,i=e>0&&this._reSpace.test(r[e])&&(-1===t||!ex.test(r[e-1]))?e-1:e,n=r[i];for(;i>0&&i<r.length&&!sA.test(n);)i+=t,n=r[i];return -1===t&&sA.test(n)&&i++,i}selectWord(e){e=e||this.selectionStart;let t=this.searchWordBoundary(e,-1),r=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;let t=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;let t=this.hiddenTextarea;tw(t).activeElement!==t&&t.focus();let r=this.getSelectionStartFromPointer(e),i=this.selectionStart,n=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&i!==n||i!==r&&n!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==i||this.selectionEnd!==n)&&(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,r){let i=r.slice(0,e),n=this.graphemeSplit(i).length;if(e===t)return{selectionStart:n,selectionEnd:n};let s=r.slice(e,t),o=this.graphemeSplit(s).length;return{selectionStart:n,selectionEnd:n+o}}fromGraphemeToStringSelection(e,t,r){let i=r.slice(0,e),n=i.join("").length;if(e===t)return{selectionStart:n,selectionEnd:n};let s=r.slice(e,t),o=s.join("").length;return{selectionStart:n,selectionEnd:n+o}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};let e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();let t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),i=r.lineIndex,n=r.charIndex,s=this.getValueOfPropertyAt(i,n,"fontSize")*this.lineHeight,o=t.leftOffset,a=this.getCanvasRetinaScaling(),l=this.canvas.upperCanvasEl,h=l.width/a,c=l.height/a,u=h-s,d=c-s,f=new eM(t.left+o,t.top+t.topOffset+s).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new eM(l.clientWidth/h,l.clientHeight/c));return f.x<0&&(f.x=0),f.x>u&&(f.x=u),f.y<0&&(f.y=0),f.y>d&&(f.y=d),f.x+=this.canvas._offset.left,f.y+=this.canvas._offset.top,{left:"".concat(f.x,"px"),top:"".concat(f.y,"px"),fontSize:"".concat(s,"px"),charHeight:s}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){let e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditing(){let e=this._textBeforeEdit!==this.text;return this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(let e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){let{lineIndex:r,charIndex:i}=this.get2DCursorLocation(e,!0),{lineIndex:n,charIndex:s}=this.get2DCursorLocation(t,!0);if(r!==n){if(this.styles[r])for(let e=i;e<this._unwrappedTextLines[r].length;e++)delete this.styles[r][e];if(this.styles[n])for(let e=s;e<this._unwrappedTextLines[n].length;e++){let t=this.styles[n][e];t&&(this.styles[r]||(this.styles[r]={}),this.styles[r][i+e-s]=t)}for(let e=r+1;e<=n;e++)delete this.styles[e];this.shiftLineStyles(n,r-n)}else if(this.styles[r]){let e=this.styles[r],t=s-i;for(let t=i;t<s;t++)delete e[t];for(let i in this.styles[r]){let r=parseInt(i,10);r>=s&&(e[r-t]=e[i],delete e[i])}}}shiftLineStyles(e,t){let r=Object.assign({},this.styles);for(let i in this.styles){let n=parseInt(i,10);n>e&&(this.styles[n+t]=r[n],r[n-t]||delete this.styles[n])}}insertNewlineStyleObject(e,t,r,i){let n={},s=this._unwrappedTextLines[e].length===t,o=!1;r||(r=1),this.shiftLineStyles(e,r);let a=this.styles[e]?this.styles[e][0===t?t:t-1]:void 0;for(let r in this.styles[e]){let i=parseInt(r,10);i>=t&&(o=!0,n[i-t]=this.styles[e][r],s&&0===t||delete this.styles[e][r])}let l=!1;for(o&&!s&&(this.styles[e+r]=n,l=!0),l&&r--;r>0;)i&&i[r-1]?this.styles[e+r]={0:X({},i[r-1])}:a?this.styles[e+r]={0:X({},a)}:delete this.styles[e+r],r--;this._forceClearCache=!0}insertCharStyleObject(e,t,r,i){this.styles||(this.styles={});let n=this.styles[e],s=n?X({},n):{};for(let e in r||(r=1),s){let i=parseInt(e,10);i>=t&&(n[i+r]=s[i],s[i-r]||delete n[i])}if(this._forceClearCache=!0,i){for(;r--;)Object.keys(i[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+r]=X({},i[r]));return}if(!n)return;let o=n[t?t-1:1];for(;o&&r--;)this.styles[e][t+r]=X({},o)}insertNewStyleBlock(e,t,r){let i;let n=this.get2DCursorLocation(t,!0),s=[0],o=0;for(let t=0;t<e.length;t++)"\n"===e[t]?s[++o]=0:s[o]++;for(s[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,s[0],r),r=r&&r.slice(s[0]+1)),o&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+s[0],o),i=1;i<o;i++)s[i]>0?this.insertCharStyleObject(n.lineIndex+i,0,s[i],r):r&&this.styles[n.lineIndex+i]&&r[0]&&(this.styles[n.lineIndex+i][0]=r[0]),r=r&&r.slice(s[i]+1);s[i]>0&&this.insertCharStyleObject(n.lineIndex+i,0,s[i],r)}removeChars(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;i>r&&this.removeStyleFromTo(r,i);let n=this.graphemeSplit(e);this.insertNewStyleBlock(n,r,t),this._text=[...this._text.slice(0,r),...n,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,r){r<=e?(t===e?this._selectionDirection=ep:this._selectionDirection===ev&&(this._selectionDirection=ep,this.selectionEnd=e),this.selectionStart=r):r>e&&r<t?this._selectionDirection===ev?this.selectionEnd=r:this.selectionStart=r:(t===e?this._selectionDirection=ev:this._selectionDirection===ep&&(this._selectionDirection=ev,this.selectionStart=t),this.selectionEnd=r)}}class sR extends sF{initHiddenTextarea(){let e=this.canvas&&tw(this.canvas.getElement())||es(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(e=>{let[r,i]=e;return t.setAttribute(r,i)});let{top:r,left:i,fontSize:n}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(r,"; left: ").concat(i,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(n,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",onCompositionUpdate:"onCompositionEnd"}).map(e=>{let[r,i]=e;return t.addEventListener(r,this[i].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;let t="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){let t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;let r=()=>{this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(""===this.hiddenTextarea.value){this.styles={},r();return}let i=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,n=this._text.length,s=i.length,o=this.selectionStart,a=this.selectionEnd,l=o!==a,h,c,u=s-n,d,f,g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),p=o>g.selectionStart;l?(c=this._text.slice(o,a),u+=a-o):s<n&&(c=p?this._text.slice(a+u,a):this._text.slice(o,o-u));let m=i.slice(g.selectionEnd-u,g.selectionEnd);if(c&&c.length&&(m.length&&(h=this.getSelectionStyles(o,o+1,!1),h=m.map(()=>h[0])),l?(d=o,f=a):p?(d=a-c.length,f=a):(d=a,f=a+c.length),this.removeStyleFromTo(d,f)),m.length){let{copyPasteData:e}=en();t&&m.join("")===e.copiedText&&!$.disableStyleCopyPaste&&(h=e.copiedTextStyle),this.insertNewStyleBlock(m,o,h)}r()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e,{selectionStart:r,selectionEnd:i}=t;this.compositionStart=r,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:e}=en();e.copiedText=this.getSelectedText(),$.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let r=this._getLineLeftOffset(e),i;return t>0&&(r+=(i=this.__charBounds[e][t-1]).left+i.width),r}getDownCursorOffset(e,t){let r=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(r),n=i.lineIndex;if(n===this._textLines.length-1||e.metaKey||34===e.keyCode)return this._text.length-r;let s=i.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n+1,o),l=this._textLines[n].slice(s);return l.length+a+1+this.missingNewlineOffset(n)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){let r=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(r),n=i.lineIndex;if(0===n||e.metaKey||33===e.keyCode)return-r;let s=i.charIndex,o=this._getWidthBeforeCursor(n,s),a=this._getIndexOnLine(n-1,o),l=this._textLines[n].slice(0,s),h=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+a-l.length+(1-h)}_getIndexOnLine(e,t){let r=this._textLines[e],i=this._getLineLeftOffset(e),n=i,s=0,o,a;for(let i=0,l=r.length;i<l;i++)if((n+=o=this.__charBounds[e][i].width)>t){a=!0;let e=n-o,r=n,l=Math.abs(e-t),h=Math.abs(r-t);s=h<l?i:i-1;break}return a||(s=r.length-1),s}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){(0!==this.selectionStart||0!==this.selectionEnd)&&this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){let r=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===ev);if(t.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),0!==r){let e=this.text.length;this.selectionStart=rn(0,this.selectionStart,e),this.selectionEnd=rn(0,this.selectionEnd,e),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){let t=this._selectionDirection===ep?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),0!==e}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),0!==e}moveCursorLeft(e){(0!==this.selectionStart||0!==this.selectionEnd)&&this._moveCursorLeftOrRight("Left",e)}_move(e,t,r){let i;if(e.altKey)i=this["findWordBoundary".concat(r)](this[t]);else{if(!e.metaKey&&35!==e.keyCode&&36!==e.keyCode)return this[t]+="Left"===r?-1:1,!0;i=this["findLineBoundary".concat(r)](this[t])}return void 0!==i&&this[t]!==i&&(this[t]=i,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=ep,this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===ev&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection=ep,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){let r="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[r](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===ep&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=ev,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=ev,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}let sL=e=>!!e.button;class sI extends sR{constructor(){super(...arguments),Y(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new sD(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;let t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),tL(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;!(!this.canvas||!this.editable||sL(t)||this.getActiveControl()||this.draggableTextDelegate.start(t))&&(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))}_mouseDownHandlerBefore(e){let{e:t}=e;!this.canvas||!this.editable||sL(t)||(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:r}=e,i=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);let e=this.canvas._activeObject;if(e&&e!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||sL(t)||i||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){let t=this.getSelectionStartFromPointer(e),r=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,i,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){let t=this.canvas.getScenePoint(e).transform(eG(this.calcTransformMatrix())).add(new eM(-this._getLeftOffset(),-this._getTopOffset())),r=0,i=0,n=0;for(let e=0;e<this._textLines.length;e++)if(r<=t.y)r+=this.getHeightOfLine(e),n=e,e>0&&(i+=this._textLines[e-1].length+this.missingNewlineOffset(e-1));else break;let s=Math.abs(this._getLineLeftOffset(n)),o=s,a=this._textLines[n].length,l=this.__charBounds[n];for(let e=0;e<a;e++){let r=l[e].kernedWidth,n=o+r;if(t.x<=n){Math.abs(t.x-n)<=Math.abs(t.x-o)&&i++;break}o=n,i++}return Math.min(this.flipX?a-i:i,this._text.length)}}let sN="moveCursorUp",sB="moveCursorDown",sW="moveCursorLeft",sU="moveCursorRight",sX="exitEditing";class sY extends sI{static getDefaults(){return X(X({},super.getDefaults()),sY.ownDefaults)}get type(){let e=super.type;return"itext"===e?"i-text":e}constructor(e,t){super(e,t),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):("canvas"===e&&(this.canvas instanceof n$&&this.canvas.textEditingManager.remove(this),t instanceof n$&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectionStart||0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,r)}setSelectionStyles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selectionStart||0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,r)}get2DCursorLocation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){let t=this.isEditing;this.isEditing=!1;let r=super.toCanvasElement(e);return this.isEditing=t,r}renderCursorOrSelection(){if(!this.isEditing)return;let e=this.clearContextTop(!0);if(!e)return;let t=this._getCursorBoundaries();this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0,r=this._getLeftOffset(),i=this._getTopOffset(),n=this._getCursorBoundariesOffsets(e,t);return{left:r,top:i,leftOffset:n.left,topOffset:n.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,r=0,{charIndex:i,lineIndex:n}=this.get2DCursorLocation(e);for(let e=0;e<n;e++)t+=this.getHeightOfLine(e);let s=this._getLineLeftOffset(n),o=this.__charBounds[n][i];o&&(r=o.left),0!==this.charSpacing&&i===this._textLines[n].length&&(r-=this._getWidthOfCharSpacing());let a={top:t,left:s+(r>0?r:0)};return"rtl"===this.direction&&(this.textAlign===ev||this.textAlign===sb||this.textAlign===sS?a.left*=-1:this.textAlign===ep||this.textAlign===sC?a.left=s-(r>0?r:0):(this.textAlign===eg||this.textAlign===sw)&&(a.left=s-(r>0?r:0))),a}renderCursorAt(e){let t=this._getCursorBoundaries(e,!0);this._renderCursor(this.canvas.contextTop,t,e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}_renderCursor(e,t,r){let i=this.get2DCursorLocation(r),n=i.lineIndex,s=i.charIndex>0?i.charIndex-1:0,o=this.getValueOfPropertyAt(n,s,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,h=this.getValueOfPropertyAt(n,s,"deltaY"),c=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-o*(1-this._fontSizeFraction);this.inCompositionMode&&this.renderSelection(e,t),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),e.globalAlpha=this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-l/2,c+t.top+h,l,o)}renderSelection(e,t){let r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,r,t)}renderDragSourceEffect(){let e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){let t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,r){let i=t.selectionStart,n=t.selectionEnd,s=this.textAlign.includes(sb),o=this.get2DCursorLocation(i),a=this.get2DCursorLocation(n),l=o.lineIndex,h=a.lineIndex,c=o.charIndex<0?0:o.charIndex,u=a.charIndex<0?0:a.charIndex;for(let t=l;t<=h;t++){let i=this._getLineLeftOffset(t)||0,n=this.getHeightOfLine(t),o=0,a=0,d=0;if(t===l&&(a=this.__charBounds[l][c].left),t>=l&&t<h)d=s&&!this.isEndOfWrapping(t)?this.width:this.getLineWidth(t)||5;else if(t===h){if(0===u)d=this.__charBounds[h][u].left;else{let e=this._getWidthOfCharSpacing();d=this.__charBounds[h][u-1].left+this.__charBounds[h][u-1].width-e}}o=n,(this.lineHeight<1||t===h&&this.lineHeight>1)&&(n/=this.lineHeight);let f=r.left+i+a,g=n,p=0,m=d-a;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",g=1,p=n):e.fillStyle=this.selectionColor,"rtl"===this.direction&&(this.textAlign===ev||this.textAlign===sb||this.textAlign===sS?f=this.width-f-m:this.textAlign===ep||this.textAlign===sC?f=r.left+i-d:(this.textAlign===eg||this.textAlign===sw)&&(f=r.left+i-d)),e.fillRect(f,r.top+r.topOffset+p,m,g),r.topOffset+=o}}getCurrentCharFontSize(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")}_getCurrentCharIndex(){let e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this._exitEditing(),this.draggableTextDelegate.dispose(),super.dispose()}}Y(sY,"ownDefaults",{selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1,keysMap:{9:sX,27:sX,33:sN,34:sB,35:sU,36:sW,37:sW,38:sN,39:sU,40:sB},keysMapRtl:{9:sX,27:sX,33:sN,34:sB,35:sW,36:sU,37:sU,38:sN,39:sW,40:sB},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}}),Y(sY,"type","IText"),eC.setClass(sY),eC.setClass(sY,"i-text");class sH extends sY{static getDefaults(){return X(X({},super.getDefaults()),{},{controls:ie()},sH.ownDefaults)}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(sb)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,r=0,i=0,n={};for(let s=0;s<e.graphemeLines.length;s++)"\n"===e.graphemeText[i]&&s>0?(r=0,i++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&s>0&&(r++,i++),n[s]={line:t,offset:r},i+=e.graphemeLines[s].length,r+=e.graphemeLines[s].length;return n}styleHas(e,t){if(this._styleMap&&!this.isWrapping){let e=this._styleMap[t];e&&(t=e.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t=0,r,i=!1,n=this._styleMap[e],s=this._styleMap[e+1];n&&(e=n.line,t=n.offset),s&&(i=s.line===e,r=s.offset);let o=void 0===e?this.styles:{line:this.styles[e]};for(let e in o)for(let n in o[e]){let s=parseInt(n,10);if(s>=t&&(!i||s<r))for(let t in o[e][n])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){let r=this._styleMap[e];if(!r)return{};e=r.line,t=r.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,r){let i=this._styleMap[e];e=i.line,t=i.offset+t,this.styles[e][t]=r}_deleteStyleDeclaration(e,t){let r=this._styleMap[e];e=r.line,t=r.offset+t,delete this.styles[e][t]}_getLineStyle(e){let t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){let t=this._styleMap[e];this.styles[t.line]={}}_wrapText(e,t){this.isWrapping=!0;let r=this.getGraphemeDataForRender(e),i=[];for(let e=0;e<r.wordsData.length;e++)i.push(...this._wrapLine(e,t,r));return this.isWrapping=!1,i}getGraphemeDataForRender(e){let t=this.splitByGrapheme,r=t?"":" ",i=0,n=e.map((e,n)=>{let s=0,o=t?this.graphemeSplit(e):this.wordSplit(e);return 0===o.length?[{word:[],width:0}]:o.map(e=>{let o=t?[e]:this.graphemeSplit(e),a=this._measureWord(o,n,s);return i=Math.max(a,i),s+=o.length+r.length,{word:o,width:a}})});return{wordsData:n,largestWordWidth:i}}_measureWord(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=0,n;for(let s=0,o=e.length;s<o;s++){let o=this._getGraphemeBox(e[s],t,s+r,n,!0);i+=o.kernedWidth,n=e[s]}return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,r){let i,{largestWordWidth:n,wordsData:s}=r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,h=[],c=l?"":" ",u=0,d=[],f=0,g=0,p=!0;t-=o;let m=Math.max(t,n,this.dynamicMinWidth),v=s[e];for(i=0,f=0;i<v.length;i++){let{word:t,width:r}=v[i];f+=t.length,(u+=g+r-a)>m&&!p?(h.push(d),d=[],u=r,p=!0):u+=a,p||l||d.push(c),d=d.concat(t),g=l?0:this._measureWord([c],e,f),f++,p=!1}return i&&h.push(d),n+o>this.dynamicMinWidth&&(this.dynamicMinWidth=n-a+o),h}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){let t=super._splitTextIntoLines(e),r=this._wrapText(t.lines,this.width),i=Array(r.length);for(let e=0;e<r.length;e++)i[e]=r[e].join("");return t.lines=i,t.graphemeLines=r,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){let e=new Map;for(let t in this._styleMap){let r=parseInt(t,10);if(this._textLines[r]){let r=this._styleMap[t].line;e.set("".concat(r),!0)}}for(let t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}Y(sH,"type","Textbox"),Y(sH,"textLayoutProperties",[...sY.textLayoutProperties,"width"]),Y(sH,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),eC.setClass(sH);class sz extends iY{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){let{target:r}=e,{clipPath:i}=r;if(!i||!this.shouldPerformLayout(e))return;let{width:n,height:s}=tI(iX(r,i)),o=new eM(n,s);if(i.absolutePositioned){var a;let e=tz(i.getRelativeCenterPoint(),void 0,null===(a=r.group)||void 0===a?void 0:a.calcTransformMatrix());return{center:e,size:o}}{let n=i.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(!this.shouldPerformLayout(e))return{center:r.getRelativeCenterPoint().add(n),size:o};{let{center:r=new eM,correction:i=new eM}=this.calcBoundingBox(t,e)||{};return{center:r.add(n),correction:i.subtract(n),size:o}}}}}Y(sz,"type","clip-path");class sV extends iY{getInitialSize(e,t){let{target:r}=e,{size:i}=t;return new eM(r.width||i.x,r.height||i.y)}}Y(sV,"type","fixed");class sG{constructor(){Y(this,"resources",{})}applyFilters(e,t,r,i,n){let s=n.getContext("2d");if(!s)return;s.drawImage(t,0,0,r,i);let o=s.getImageData(0,0,r,i),a=s.getImageData(0,0,r,i),l={sourceWidth:r,sourceHeight:i,imageData:o,originalEl:t,originalImageData:a,canvasEl:n,ctx:s,filterBackend:this};e.forEach(e=>{e.applyTo(l)});let{imageData:h}=l;return(h.width!==r||h.height!==i)&&(n.width=h.width,n.height=h.height),s.putImageData(h,0,0),l}}class sq{constructor(){let{tileSize:e=$.textureSize}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Y(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),Y(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t),this.chooseFastestCopyGLTo2DMethod(e,t)}chooseFastestCopyGLTo2DMethod(e,t){let r;let i=eB(),n=new ArrayBuffer(e*t*4);if($.forceGLPutImageData){this.imageBuffer=n,this.copyGLTo2D=s$;return}let s={imageBuffer:n},o={destinationWidth:e,destinationHeight:t,targetCanvas:i};i.width=e,i.height=t,r=eo().performance.now(),this.copyGLTo2D.call(s,this.gl,o);let a=eo().performance.now()-r;r=eo().performance.now(),s$.call(s,this.gl,o);let l=eo().performance.now()-r;a>l&&(this.imageBuffer=n,this.copyGLTo2D=s$)}createWebGLCanvas(e,t){let r=eB();r.width=e,r.height=t;let i=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=r,this.gl=i)}applyFilters(e,t,r,i,n,s){let o;let a=this.gl,l=n.getContext("2d");if(!a||!l)return;s&&(o=this.getCachedTexture(s,t));let h={originalWidth:t.width||t.originalWidth||0,originalHeight:t.height||t.originalHeight||0,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:a,sourceTexture:this.createTexture(a,r,i,o?void 0:t),targetTexture:this.createTexture(a,r,i),originalTexture:o||this.createTexture(a,r,i,o?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:n},c=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,c),e.forEach(e=>{e&&e.applyTo(h)}),function(e){let t=e.targetCanvas,r=t.width,i=t.height,n=e.destinationWidth,s=e.destinationHeight;(r!==n||i!==s)&&(t.width=n,t.height=s)}(h),this.copyGLTo2D(a,h),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(h.sourceTexture),a.deleteTexture(h.targetTexture),a.deleteFramebuffer(c),l.setTransform(1,0,0,1,0,0),h}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,r,i,n){let{NEAREST:s,TEXTURE_2D:o,RGBA:a,UNSIGNED_BYTE:l,CLAMP_TO_EDGE:h,TEXTURE_MAG_FILTER:c,TEXTURE_MIN_FILTER:u,TEXTURE_WRAP_S:d,TEXTURE_WRAP_T:f}=e,g=e.createTexture();return e.bindTexture(o,g),e.texParameteri(o,c,n||s),e.texParameteri(o,u,n||s),e.texParameteri(o,d,h),e.texParameteri(o,f,h),i?e.texImage2D(o,0,a,a,l,i):e.texImage2D(o,0,a,t,r,0,a,l,null),g}getCachedTexture(e,t,r){let{textureCache:i}=this;if(i[e])return i[e];{let n=this.createTexture(this.gl,t.width,t.height,t,r);return n&&(i[e]=n),n}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){let r=e.canvas,i=t.targetCanvas,n=i.getContext("2d");if(!n)return;n.translate(0,i.height),n.scale(1,-1);let s=r.height-i.height;n.drawImage(r,0,s,i.width,i.height,0,0,i.width,i.height)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let e=this.gl,t={renderer:"",vendor:""};if(!e)return t;let r=e.getExtension("WEBGL_debug_renderer_info");if(r){let i=e.getParameter(r.UNMASKED_RENDERER_WEBGL),n=e.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(t.renderer=i.toLowerCase()),n&&(t.vendor=n.toLowerCase())}return this.gpuInfo=t,t}}function s$(e,t){let r=t.targetCanvas,i=r.getContext("2d"),n=t.destinationWidth,s=t.destinationHeight,o=n*s*4;if(!i)return;let a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,n,s,e.RGBA,e.UNSIGNED_BYTE,a);let h=new ImageData(l,n,s);i.putImageData(h,0,0)}function sK(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!o&&e&&(o=function(){let{WebGLProbe:e}=en();return(e.queryWebGL(eB()),$.enableGLFiltering&&e.isSupported($.textureSize))?new sq({tileSize:$.textureSize}):new sG}()),o}let sQ=["filters","resizeFilter","src","crossOrigin"],sJ=["cropX","cropY"];class sZ extends ii{static getDefaults(){return X(X({},super.getDefaults()),sZ.ownDefaults)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(X({filters:[]},t)),Y(this,"_lastScaleX",1),Y(this,"_lastScaleY",1),Y(this,"_filterScalingX",1),Y(this,"_filterScalingY",1),this.cacheKey="texture".concat(eN()),this.setElement("string"==typeof e?(this.canvas&&tw(this.canvas.getElement())||es()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(sZ.CSS_CANVAS),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){let t=sK(!1);t instanceof sq&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{let t=this[e];t&&en().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){let e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||0===this.strokeWidth)return;let t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,-r),e.lineTo(t,-r),e.lineTo(t,r),e.lineTo(-t,r),e.lineTo(-t,-r),e.closePath()}toObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return this.filters.forEach(e=>{e&&t.push(e.toObject())}),X(X({},super.toObject([...sJ,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){let e=[],t=this._element,r=-this.width/2,i=-this.height/2,n=[],s=[],o="",a="";if(!t)return[];if(this.hasCrop()){let e=eN();n.push('<clipPath id="imageCrop_'+e+'">\n','	<rect x="'+r+'" y="'+i+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),o=' clip-path="url(#imageCrop_'+e+')" '}if(this.imageSmoothing||(a=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(r-this.cropX,'" y="').concat(i-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(a).concat(o,"></image>\n")),this.stroke||this.strokeDashArray){let e=this.fill;this.fill=null,s=['	<rect x="'.concat(r,'" y="').concat(i,'" width="').concat(this.width,'" height="').concat(this.height,'" styles="').concat(this.getSvgStyles(),'" />\n')],this.fill=e}return"fill"!==this.paintFirst?n.concat(s,e):n.concat(e,s)}getSrc(e){let t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e6(e,{crossOrigin:t,signal:r}).then(e=>{void 0!==t&&this.set({crossOrigin:t}),this.setElement(e)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){let e=this.resizeFilter,t=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.x,n=r.y,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>t&&n>t){this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,this._lastScaleY=n;return}let o=eB(),a=s.width,l=s.height;o.width=a,o.height=l,this._element=o,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=n,sK().applyFilters([e],s,a,l,this._element),this._filterScalingX=o.width/this._originalElement.width,this._filterScalingY=o.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.filters||[];if(e=e.filter(e=>e&&!e.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),0===e.length){this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,this._filterScalingY=1;return}let t=this._originalElement,r=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(this._element===this._originalElement){let e=eB();e.width=r,e.height=i,this._element=e,this._filteredEl=e}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1);sK().applyFilters(e,this._originalElement,r,i,this._element),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){let t=this._element;if(!t)return;let r=this._filterScalingX,i=this._filterScalingY,n=this.width,s=this.height,o=Math.max(this.cropX,0),a=Math.max(this.cropY,0),l=t.naturalWidth||t.width,h=t.naturalHeight||t.height,c=o*r,u=a*i;t&&e.drawImage(t,c,u,Math.min(n*r,l-c),Math.min(s*i,h-u),-n/2,-s/2,Math.min(n,l/r-o),Math.min(s,h/i-a))}_needsResize(){let e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.getOriginalSize();this.width=e||r.width,this.height=t||r.height}parsePreserveAspectRatioAttribute(){let e=tg(this.preserveAspectRatio||""),t=this.width,r=this.height,i={width:t,height:r},n=this._element.width,s=this._element.height,o=1,a=1,l=0,h=0,c=0,u=0,d;return e&&(e.alignX!==ey||e.alignY!==ey)?("meet"===e.meetOrSlice&&(d=(t-n*(o=a=i3(this._element,i)))/2,"Min"===e.alignX&&(l=-d),"Max"===e.alignX&&(l=d),d=(r-s*a)/2,"Min"===e.alignY&&(h=-d),"Max"===e.alignY&&(h=d)),"slice"===e.meetOrSlice&&(d=n-t/(o=a=i6(this._element,i)),"Mid"===e.alignX&&(c=d/2),"Max"===e.alignX&&(c=d),d=s-r/a,"Mid"===e.alignY&&(u=d/2),"Max"===e.alignY&&(u=d),n=t/o,s=r/a)):(o=t/n,a=r/s),{width:n,height:s,scaleX:o,scaleY:a,offsetLeft:l,offsetTop:h,cropX:c,cropY:u}}static fromObject(e){let{filters:t,resizeFilter:r,src:i,crossOrigin:n}=e,s=H(e,sQ),o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Promise.all([e6(i,X(X({},o),{},{crossOrigin:n})),t&&e8(t,o),r&&e8([r],o),e9(s,o)]).then(e=>{let[t,r=[],[n]=[],o={}]=e;return new this(t,X(X({},s),{},{src:i,filters:r,resizeFilter:n},o))})}static fromURL(e){let{crossOrigin:t=null,signal:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return e6(e,{crossOrigin:t,signal:r}).then(e=>new this(e,i))}static async fromElement(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=iF(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(i["xlink:href"],t,i).catch(e=>(K("log","Unable to parse Image",e),null))}}Y(sZ,"type","Image"),Y(sZ,"cacheProperties",[...rM,...sJ]),Y(sZ,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),Y(sZ,"CSS_CANVAS","canvas-img"),Y(sZ,"ATTRIBUTE_NAMES",[...io,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),eC.setClass(sZ),eC.setSVGClass(sZ),ia(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);let s0="xlink:href",s1=e=>eC.getSVGClass(e.tagName.toLowerCase().replace("svg:","")),s2=e=>new eM(e.width,e.height),s5=e=>void 0!==e.webgl,s4="precision highp float",s3="\n    ".concat(s4,";\n    varying vec2 vTexCoord;\n    uniform sampler2D uTexture;\n    void main() {\n      gl_FragColor = texture2D(uTexture, vTexCoord);\n    }"),s6=["type"],s8=["type"];class s9{get type(){return this.constructor.type}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=H(e,s6);Y(this,"vertexSource","\n    attribute vec2 aPosition;\n    varying vec2 vTexCoord;\n    void main() {\n      vTexCoord = aPosition;\n      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n    }"),Object.assign(this,this.constructor.defaults,t)}getFragmentSource(){return s3}createProgram(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.vertexSource,{WebGLProbe:{GLPrecision:i="highp"}}=en();"highp"!==i&&(t=t.replace(RegExp(s4,"g"),s4.replace("highp",i)));let n=e.createShader(e.VERTEX_SHADER),s=e.createShader(e.FRAGMENT_SHADER),o=e.createProgram();if(!n||!s||!o)throw new Q("Vertex, fragment shader or program creation error");if(e.shaderSource(n,r),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Q("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(n)));if(e.shaderSource(s,t),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Q("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.attachShader(o,n),e.attachShader(o,s),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Q('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(o)));let a=this.getUniformLocations(e,o)||{};return a.uStepW=e.getUniformLocation(o,"uStepW"),a.uStepH=e.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:this.getAttributeLocations(e,o),uniformLocations:a}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){return{}}sendAttributeData(e,t,r){let i=t.aPosition,n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}_setupFrameBuffer(e){let t=e.context;if(e.passes>1){let r=e.destinationWidth,i=e.destinationHeight;(e.sourceWidth!==r||e.sourceHeight!==i)&&(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,r,i)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;let t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){let t=this.mainParameter,r=this.constructor.defaults[t];if(!t)return!1;{let e=this[t];return Array.isArray(r)&&Array.isArray(e)?r.every((t,r)=>t===e[r]):r===e}}applyTo(e){s5(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){let t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){let t=e.context,r=this.retrieveShader(e);0===e.pass&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(r.program),this.sendAttributeData(t,r.attributeLocations,e.aPosition),t.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,r.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}getMainParameter(){return this.mainParameter?this[this.mainParameter]:void 0}setMainParameter(e){this.mainParameter&&(this[this.mainParameter]=e)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){let t=eB();t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}}toObject(){let e=this.mainParameter;return X({type:this.type},e?{[e]:this[e]}:{})}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(H(e,s8))}}Y(s9,"type","BaseFilter");let s7={multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",difference:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"\n    if (uColor.r < 0.5) {\n      gl_FragColor.r *= 2.0 * uColor.r;\n    } else {\n      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n    }\n    if (uColor.g < 0.5) {\n      gl_FragColor.g *= 2.0 * uColor.g;\n    } else {\n      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n    }\n    if (uColor.b < 0.5) {\n      gl_FragColor.b *= 2.0 * uColor.b;\n    } else {\n      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n    }\n    ",tint:"\n    gl_FragColor.rgb *= (1.0 - uColor.a);\n    gl_FragColor.rgb += uColor.rgb;\n    "};class oe extends s9{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return"\n      precision highp float;\n      uniform sampler2D uTexture;\n      uniform vec4 uColor;\n      varying vec2 vTexCoord;\n      void main() {\n        vec4 color = texture2D(uTexture, vTexCoord);\n        gl_FragColor = color;\n        if (color.a > 0.0) {\n          ".concat(s7[this.mode],"\n        }\n      }\n      ")}applyTo2d(e){let{imageData:{data:t}}=e,r=new tc(this.color).getSource(),i=r[0]*this.alpha,n=r[1]*this.alpha,s=r[2]*this.alpha,o=1-this.alpha;for(let e=0;e<t.length;e+=4){let r=t[e],a=t[e+1],l=t[e+2];switch(this.mode){case"multiply":t[e]=r*i/255,t[e+1]=a*n/255,t[e+2]=l*s/255;break;case"screen":t[e]=255-(255-r)*(255-i)/255,t[e+1]=255-(255-a)*(255-n)/255,t[e+2]=255-(255-l)*(255-s)/255;break;case"add":t[e]=r+i,t[e+1]=a+n,t[e+2]=l+s;break;case"difference":t[e]=Math.abs(r-i),t[e+1]=Math.abs(a-n),t[e+2]=Math.abs(l-s);break;case"subtract":t[e]=r-i,t[e+1]=a-n,t[e+2]=l-s;break;case"darken":t[e]=Math.min(r,i),t[e+1]=Math.min(a,n),t[e+2]=Math.min(l,s);break;case"lighten":t[e]=Math.max(r,i),t[e+1]=Math.max(a,n),t[e+2]=Math.max(l,s);break;case"overlay":t[e]=i<128?2*r*i/255:255-2*(255-r)*(255-i)/255,t[e+1]=n<128?2*a*n/255:255-2*(255-a)*(255-n)/255,t[e+2]=s<128?2*l*s/255:255-2*(255-l)*(255-s)/255;break;case"exclusion":t[e]=i+r-2*i*r/255,t[e+1]=n+a-2*n*a/255,t[e+2]=s+l-2*s*l/255;break;case"tint":t[e]=i+r*o,t[e+1]=n+a*o,t[e+2]=s+l*o}}}getUniformLocations(e,t){return{uColor:e.getUniformLocation(t,"uColor")}}sendUniformData(e,t){let r=new tc(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,e.uniform4fv(t.uColor,r)}toObject(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}Y(oe,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),Y(oe,"type","BlendColor"),eC.setClass(oe);let ot={multiply:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform sampler2D uImage;\n    uniform vec4 uColor;\n    varying vec2 vTexCoord;\n    varying vec2 vTexCoord2;\n    void main() {\n      vec4 color = texture2D(uTexture, vTexCoord);\n      vec4 color2 = texture2D(uImage, vTexCoord2);\n      color.rgba *= color2.rgba;\n      gl_FragColor = color;\n    }\n    ",mask:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform sampler2D uImage;\n    uniform vec4 uColor;\n    varying vec2 vTexCoord;\n    varying vec2 vTexCoord2;\n    void main() {\n      vec4 color = texture2D(uTexture, vTexCoord);\n      vec4 color2 = texture2D(uImage, vTexCoord2);\n      color.a = color2.a;\n      gl_FragColor = color;\n    }\n    "},or=["type","image"];class oi extends s9{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return ot[this.mode]}applyToWebGL(e){let t=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,r,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){let e=this.image,{width:t,height:r}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/r,1]}applyTo2d(e){let{imageData:{data:t,width:r,height:i},filterBackend:{resources:n}}=e,s=this.image;n.blendImage||(n.blendImage=eB());let o=n.blendImage,a=o.getContext("2d");o.width!==r||o.height!==i?(o.width=r,o.height=i):a.clearRect(0,0,r,i),a.setTransform(s.scaleX,0,0,s.scaleY,s.left,s.top),a.drawImage(s.getElement(),0,0,r,i);let l=a.getImageData(0,0,r,i).data;for(let e=0;e<t.length;e+=4){let r=t[e],i=t[e+1],n=t[e+2],s=t[e+3],o=l[e],a=l[e+1],h=l[e+2],c=l[e+3];switch(this.mode){case"multiply":t[e]=r*o/255,t[e+1]=i*a/255,t[e+2]=n*h/255,t[e+3]=s*c/255;break;case"mask":t[e+3]=c}}}getUniformLocations(e,t){return{uTransformMatrix:e.getUniformLocation(t,"uTransformMatrix"),uImage:e.getUniformLocation(t,"uImage")}}sendUniformData(e,t){let r=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,r)}toObject(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}static fromObject(e,t){let{type:r,image:i}=e,n=H(e,or);return sZ.fromObject(i,t).then(e=>new this(X(X({},n),{},{image:e})))}}Y(oi,"type","BlendImage"),Y(oi,"defaults",{mode:"multiply",alpha:1,vertexSource:"\n    attribute vec2 aPosition;\n    varying vec2 vTexCoord;\n    varying vec2 vTexCoord2;\n    uniform mat3 uTransformMatrix;\n    void main() {\n      vTexCoord = aPosition;\n      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\n      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n    }\n    "}),eC.setClass(oi);class on extends s9{getFragmentSource(){return"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform vec2 uDelta;\n    varying vec2 vTexCoord;\n    const float nSamples = 15.0;\n    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);\n    float random(vec3 scale) {\n      /* use the fragment position for a different seed per-pixel */\n      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n    }\n    void main() {\n      vec4 color = vec4(0.0);\n      float total = 0.0;\n      float offset = random(v3offset);\n      for (float t = -nSamples; t <= nSamples; t++) {\n        float percent = (t + offset - 0.5) / nSamples;\n        float weight = 1.0 - abs(percent);\n        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\n        total += weight;\n      }\n      gl_FragColor = color / total;\n    }\n  "}applyTo(e){s5(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let t,r,i,n,{ctx:s,imageData:o,filterBackend:{resources:a}}=e,{width:l,height:h}=o;a.blurLayer1||(a.blurLayer1=eB(),a.blurLayer2=eB());let c=a.blurLayer1,u=a.blurLayer2;(c.width!==l||c.height!==h)&&(u.width=c.width=l,u.height=c.height=h);let d=c.getContext("2d"),f=u.getContext("2d"),g=.03*this.blur;for(d.putImageData(o,0,0),f.clearRect(0,0,l,h),n=-15;n<=15;n++)t=(Math.random()-.5)/4,i=g*(r=n/15)*l+t,f.globalAlpha=1-Math.abs(r),f.drawImage(c,i,t),d.drawImage(u,0,0),f.globalAlpha=1,f.clearRect(0,0,u.width,u.height);for(n=-15;n<=15;n++)t=(Math.random()-.5)/4,i=g*(r=n/15)*h+t,f.globalAlpha=1-Math.abs(r),f.drawImage(c,t,i),d.drawImage(u,0,0),f.globalAlpha=1,f.clearRect(0,0,u.width,u.height);s.drawImage(c,0,0);let p=s.getImageData(0,0,c.width,c.height);return d.globalAlpha=1,d.clearRect(0,0,c.width,c.height),p}getUniformLocations(e,t){return{delta:e.getUniformLocation(t,"uDelta")}}sendUniformData(e,t){let r=this.chooseRightDelta();e.uniform2fv(t.delta,r)}chooseRightDelta(){let e=1,t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);let r=e*this.blur*.12;return this.horizontal?t[0]=r:t[1]=r,t}}Y(on,"type","Blur"),Y(on,"defaults",{blur:0,mainParameter:"blur"}),eC.setClass(on);class os extends s9{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uBrightness;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    color.rgb += uBrightness;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;if(0===this.brightness)return;let r=Math.round(255*this.brightness);for(let e=0;e<t.length;e+=4)t[e]=t[e]+r,t[e+1]=t[e+1]+r,t[e+2]=t[e+2]+r}getUniformLocations(e,t){return{uBrightness:e.getUniformLocation(t,"uBrightness")}}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}Y(os,"type","Brightness"),Y(os,"defaults",{brightness:0,mainParameter:"brightness"}),eC.setClass(os);let oo=["matrix"],oa={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0};class ol extends s9{setOptions(e){let{matrix:t}=e,r=H(e,oo);t&&(this.matrix=[...t]),Object.assign(this,r)}getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  varying vec2 vTexCoord;\n  uniform mat4 uColorMatrix;\n  uniform vec4 uConstants;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    color *= uColorMatrix;\n    color += uConstants;\n    gl_FragColor = color;\n  }"}applyTo2d(e){let t=e.imageData,r=t.data,i=this.matrix,n=this.colorsOnly;for(let e=0;e<r.length;e+=4){let t=r[e],s=r[e+1],o=r[e+2];if(n)r[e]=t*i[0]+s*i[1]+o*i[2]+255*i[4],r[e+1]=t*i[5]+s*i[6]+o*i[7]+255*i[9],r[e+2]=t*i[10]+s*i[11]+o*i[12]+255*i[14];else{let n=r[e+3];r[e]=t*i[0]+s*i[1]+o*i[2]+n*i[3]+255*i[4],r[e+1]=t*i[5]+s*i[6]+o*i[7]+n*i[8]+255*i[9],r[e+2]=t*i[10]+s*i[11]+o*i[12]+n*i[13]+255*i[14],r[e+3]=t*i[15]+s*i[16]+o*i[17]+n*i[18]+255*i[19]}}}getUniformLocations(e,t){return{uColorMatrix:e.getUniformLocation(t,"uColorMatrix"),uConstants:e.getUniformLocation(t,"uConstants")}}sendUniformData(e,t){let r=this.matrix,i=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],n=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,i),e.uniform4fv(t.uConstants,n)}}function oh(e,t){var r;let i=(Y(r=class extends ol{},"type",e),Y(r,"defaults",X(X({},oa),{},{mainParameter:void 0,matrix:t})),r);return eC.setClass(i,e),i}Y(ol,"type","ColorMatrix"),Y(ol,"defaults",oa),eC.setClass(ol),oh("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),oh("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),oh("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),oh("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),oh("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),oh("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),oh("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);let oc=["subFilters"];class ou extends s9{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{subFilters:t=[]}=e;super(H(e,oc)),this.subFilters=t}applyTo(e){s5(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return X(X({},super.toObject()),{},{subFilters:this.subFilters.map(e=>e.toObject())})}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(e=>eC.getClass(e.type).fromObject(e,t))).then(e=>new this({subFilters:e}))}}Y(ou,"type","Composed"),eC.setClass(ou);class od extends s9{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uContrast;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\n    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;\n    gl_FragColor = color;\n  }"}applyTo2d(e){let{imageData:{data:t}}=e;if(0===this.contrast)return;let r=Math.floor(255*this.contrast),i=259*(r+255)/(255*(259-r));for(let e=0;e<t.length;e+=4)t[e]=i*(t[e]-128)+128,t[e+1]=i*(t[e+1]-128)+128,t[e+2]=i*(t[e+2]-128)+128}getUniformLocations(e,t){return{uContrast:e.getUniformLocation(t,"uContrast")}}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}Y(od,"type","Contrast"),Y(od,"defaults",{contrast:0,mainParameter:"contrast"}),eC.setClass(od);let of={Convolute_3_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[9];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 3.0; h+=1.0) {\n        for (float w = 0.0; w < 3.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_3_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[9];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 3.0; h+=1.0) {\n        for (float w = 0.0; w < 3.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    ",Convolute_5_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[25];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 5.0; h+=1.0) {\n        for (float w = 0.0; w < 5.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_5_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[25];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 5.0; h+=1.0) {\n        for (float w = 0.0; w < 5.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    ",Convolute_7_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[49];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 7.0; h+=1.0) {\n        for (float w = 0.0; w < 7.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_7_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[49];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 7.0; h+=1.0) {\n        for (float w = 0.0; w < 7.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    ",Convolute_9_1:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[81];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 0);\n      for (float h = 0.0; h < 9.0; h+=1.0) {\n        for (float w = 0.0; w < 9.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\n          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n        }\n      }\n      gl_FragColor = color;\n    }\n    ",Convolute_9_0:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform float uMatrix[81];\n    uniform float uStepW;\n    uniform float uStepH;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = vec4(0, 0, 0, 1);\n      for (float h = 0.0; h < 9.0; h+=1.0) {\n        for (float w = 0.0; w < 9.0; w+=1.0) {\n          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\n          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n        }\n      }\n      float alpha = texture2D(uTexture, vTexCoord).a;\n      gl_FragColor = color;\n      gl_FragColor.a = alpha;\n    }\n    "};class og extends s9{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return of[this.getCacheKey()]}applyTo2d(e){let t,r,i,n,s,o,a,l,h,c,u,d,f;let g=e.imageData,p=g.data,m=this.matrix,v=Math.round(Math.sqrt(m.length)),y=Math.floor(v/2),x=g.width,_=g.height,b=e.ctx.createImageData(x,_),C=b.data,S=this.opaque?1:0;for(u=0;u<_;u++)for(c=0;c<x;c++){for(f=0,s=(u*x+c)*4,t=0,r=0,i=0,n=0;f<v;f++)for(d=0;d<v;d++)a=u+f-y,o=c+d-y,a<0||a>=_||o<0||o>=x||(l=(a*x+o)*4,h=m[f*v+d],t+=p[l]*h,r+=p[l+1]*h,i+=p[l+2]*h,S||(n+=p[l+3]*h));C[s]=t,C[s+1]=r,C[s+2]=i,S?C[s+3]=p[s+3]:C[s+3]=n}e.imageData=b}getUniformLocations(e,t){return{uMatrix:e.getUniformLocation(t,"uMatrix"),uOpaque:e.getUniformLocation(t,"uOpaque"),uHalfSize:e.getUniformLocation(t,"uHalfSize"),uSize:e.getUniformLocation(t,"uSize")}}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return X(X({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}Y(og,"type","Convolute"),Y(og,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),eC.setClass(og);let op=["gamma"];class om extends s9{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform vec3 uGamma;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    vec3 correction = (1.0 / uGamma);\n    color.r = pow(color.r, correction.r);\n    color.g = pow(color.g, correction.g);\n    color.b = pow(color.b, correction.b);\n    gl_FragColor = color;\n    gl_FragColor.rgb *= color.a;\n  }\n"}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gamma:t=[1,1,1]}=e;super(H(e,op)),this.gamma=t}applyTo2d(e){let{imageData:{data:t}}=e,r=this.gamma,i=1/r[0],n=1/r[1],s=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let o=this.rgbValues;for(let e=0;e<256;e++)o.r[e]=255*Math.pow(e/255,i),o.g[e]=255*Math.pow(e/255,n),o.b[e]=255*Math.pow(e/255,s);for(let e=0;e<t.length;e+=4)t[e]=o.r[t[e]],t[e+1]=o.g[t[e+1]],t[e+2]=o.b[t[e+2]]}getUniformLocations(e,t){return{uGamma:e.getUniformLocation(t,"uGamma")}}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}}Y(om,"type","Gamma"),Y(om,"defaults",{mainParameter:"gamma",gamma:[1,1,1]}),eC.setClass(om);let ov={average:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 color = texture2D(uTexture, vTexCoord);\n      float average = (color.r + color.b + color.g) / 3.0;\n      gl_FragColor = vec4(average, average, average, color.a);\n    }\n    ",lightness:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform int uMode;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 col = texture2D(uTexture, vTexCoord);\n      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\n      gl_FragColor = vec4(average, average, average, col.a);\n    }\n    ",luminosity:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform int uMode;\n    varying vec2 vTexCoord;\n    void main() {\n      vec4 col = texture2D(uTexture, vTexCoord);\n      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\n      gl_FragColor = vec4(average, average, average, col.a);\n    }\n    "};class oy extends s9{applyTo2d(e){let{imageData:{data:t}}=e;for(let e=0,r;e<t.length;e+=4){switch(this.mode){case"average":r=(t[e]+t[e+1]+t[e+2])/3;break;case"lightness":r=(Math.min(t[e],t[e+1],t[e+2])+Math.max(t[e],t[e+1],t[e+2]))/2;break;case"luminosity":r=.21*t[e]+.72*t[e+1]+.07*t[e+2]}t[e]=r,t[e+1]=r,t[e+2]=r}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return ov[this.mode]}getUniformLocations(e,t){return{uMode:e.getUniformLocation(t,"uMode")}}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}Y(oy,"type","Grayscale"),Y(oy,"defaults",{mode:"average",mainParameter:"mode"}),eC.setClass(oy);class ox extends ol{calculateMatrix(){let e=this.rotation*Math.PI,t=ek(e),r=ej(e),i=1/3,n=Math.sqrt(i)*r,s=1-t;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=t+s/3,this.matrix[1]=i*s-n,this.matrix[2]=i*s+n,this.matrix[5]=i*s+n,this.matrix[6]=t+i*s,this.matrix[7]=i*s-n,this.matrix[10]=i*s-n,this.matrix[11]=i*s+n,this.matrix[12]=t+i*s}isNeutralState(){return this.calculateMatrix(),super.isNeutralState()}applyTo(e){this.calculateMatrix(),super.applyTo(e)}}Y(ox,"type","HueRotation"),Y(ox,"defaults",{rotation:0,mainParameter:"rotation"}),eC.setClass(ox);class o_ extends s9{applyTo2d(e){let{imageData:{data:t}}=e;for(let e=0;e<t.length;e+=4)t[e]=255-t[e],t[e+1]=255-t[e+1],t[e+2]=255-t[e+2],this.alpha&&(t[e+3]=255-t[e+3])}getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform int uInvert;\n  uniform int uAlpha;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    if (uInvert == 1) {\n      if (uAlpha == 1) {\n        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);\n      } else {\n        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n      }\n    } else {\n      gl_FragColor = color;\n    }\n  }\n"}isNeutralState(){return!this.invert}getUniformLocations(e,t){return{uInvert:e.getUniformLocation(t,"uInvert"),uAlpha:e.getUniformLocation(t,"uAlpha")}}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}Y(o_,"type","Invert"),Y(o_,"defaults",{alpha:!1,invert:!0,mainParameter:"invert"}),eC.setClass(o_);class ob extends s9{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uStepH;\n  uniform float uNoise;\n  uniform float uSeed;\n  varying vec2 vTexCoord;\n  float rand(vec2 co, float seed, float vScale) {\n    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n  }\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;if(0===this.noise)return;let r=this.noise;for(let e=0;e<t.length;e+=4){let i=(.5-Math.random())*r;t[e]+=i,t[e+1]+=i,t[e+2]+=i}}getUniformLocations(e,t){return{uNoise:e.getUniformLocation(t,"uNoise"),uSeed:e.getUniformLocation(t,"uSeed")}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}toObject(){return X(X({},super.toObject()),{},{noise:this.noise})}}Y(ob,"type","Noise"),Y(ob,"defaults",{mainParameter:"noise",noise:0}),eC.setClass(ob);class oC extends s9{applyTo2d(e){let{imageData:{data:t,width:r,height:i}}=e;for(let e=0;e<i;e+=this.blocksize)for(let n=0;n<r;n+=this.blocksize){let s=4*e*r+4*n,o=t[s],a=t[s+1],l=t[s+2],h=t[s+3];for(let s=e;s<Math.min(e+this.blocksize,i);s++)for(let e=n;e<Math.min(n+this.blocksize,r);e++){let i=4*s*r+4*e;t[i]=o,t[i+1]=a,t[i+2]=l,t[i+3]=h}}}isNeutralState(){return 1===this.blocksize}getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uBlocksize;\n  uniform float uStepW;\n  uniform float uStepH;\n  varying vec2 vTexCoord;\n  void main() {\n    float blockW = uBlocksize * uStepW;\n    float blockH = uBlocksize * uStepW;\n    int posX = int(vTexCoord.x / blockW);\n    int posY = int(vTexCoord.y / blockH);\n    float fposX = float(posX);\n    float fposY = float(posY);\n    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\n    vec4 color = texture2D(uTexture, squareCoords);\n    gl_FragColor = color;\n  }\n"}getUniformLocations(e,t){return{uBlocksize:e.getUniformLocation(t,"uBlocksize"),uStepW:e.getUniformLocation(t,"uStepW"),uStepH:e.getUniformLocation(t,"uStepH")}}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}Y(oC,"type","Pixelate"),Y(oC,"defaults",{blocksize:4,mainParameter:"blocksize"}),eC.setClass(oC);class oS extends s9{getFragmentShader(){return"\nprecision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\n  gl_FragColor = texture2D(uTexture, vTexCoord);\n  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\n    gl_FragColor.a = 0.0;\n  }\n}\n"}applyTo2d(e){let{imageData:{data:t}}=e,r=255*this.distance,i=new tc(this.color).getSource(),n=[i[0]-r,i[1]-r,i[2]-r],s=[i[0]+r,i[1]+r,i[2]+r];for(let e=0;e<t.length;e+=4){let r=t[e],i=t[e+1],o=t[e+2];r>n[0]&&i>n[1]&&o>n[2]&&r<s[0]&&i<s[1]&&o<s[2]&&(t[e+3]=0)}}getUniformLocations(e,t){return{uLow:e.getUniformLocation(t,"uLow"),uHigh:e.getUniformLocation(t,"uHigh")}}sendUniformData(e,t){let r=new tc(this.color).getSource(),i=this.distance,n=[0+r[0]/255-i,0+r[1]/255-i,0+r[2]/255-i,1],s=[r[0]/255+i,r[1]/255+i,r[2]/255+i,1];e.uniform4fv(t.uLow,n),e.uniform4fv(t.uHigh,s)}toObject(){return X(X({},super.toObject()),{},{color:this.color,distance:this.distance})}}Y(oS,"type","RemoveColor"),Y(oS,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),eC.setClass(oS);class ow extends s9{getUniformLocations(e,t){return{uDelta:e.getUniformLocation(t,"uDelta"),uTaps:e.getUniformLocation(t,"uTaps")}}sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){let e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){let e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){let e=this.getFilterWindow();return this.generateShader(e)}getTaps(){let e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,r=this.getFilterWindow(),i=Array(r);for(let n=1;n<=r;n++)i[n-1]=e(n*t);return i}generateShader(e){let t=Array(e);for(let r=1;r<=e;r++)t[r-1]="".concat(r,".0 * uDelta");return"\n      ".concat(this.fragmentSourceTOP,"\n      uniform float uTaps[").concat(e,"];\n      void main() {\n        vec4 color = texture2D(uTexture, vTexCoord);\n        float sum = 1.0;\n        ").concat(t.map((e,t)=>"\n              color += texture2D(uTexture, vTexCoord + ".concat(e,") * uTaps[").concat(t,"] + texture2D(uTexture, vTexCoord - ").concat(e,") * uTaps[").concat(t,"];\n              sum += 2.0 * uTaps[").concat(t,"];\n            ")).join("\n"),"\n        gl_FragColor = color / sum;\n      }\n    ")}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){s5(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return 1===this.scaleX&&1===this.scaleY}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-.00000011920929)return 1;t*=Math.PI;let r=t/e;return Math.sin(t)/t*Math.sin(r)/r}}applyTo2d(e){let t;let r=e.imageData,i=this.scaleX,n=this.scaleY;this.rcpScaleX=1/i,this.rcpScaleY=1/n;let s=r.width,o=r.height,a=Math.round(s*i),l=Math.round(o*n);t="sliceHack"===this.resizeType?this.sliceByTwo(e,s,o,a,l):"hermite"===this.resizeType?this.hermiteFastResize(e,s,o,a,l):"bilinear"===this.resizeType?this.bilinearFiltering(e,s,o,a,l):"lanczos"===this.resizeType?this.lanczosResize(e,s,o,a,l):new ImageData(a,l),e.imageData=t}sliceByTwo(e,t,r,i,n){let s=e.imageData,o=!1,a=!1,l=.5*t,h=.5*r,c=e.filterBackend.resources,u=0,d=0,f=t,g=0;c.sliceByTwo||(c.sliceByTwo=eB());let p=c.sliceByTwo;(p.width<1.5*t||p.height<r)&&(p.width=1.5*t,p.height=r);let m=p.getContext("2d");for(m.clearRect(0,0,1.5*t,r),m.putImageData(s,0,0),i=Math.floor(i),n=Math.floor(n);!o||!a;)t=l,r=h,i<Math.floor(.5*l)?l=Math.floor(.5*l):(l=i,o=!0),n<Math.floor(.5*h)?h=Math.floor(.5*h):(h=n,a=!0),m.drawImage(p,u,d,t,r,f,g,l,h),u=f,d=g,g+=h;return m.getImageData(u,d,i,n)}lanczosResize(e,t,r,i,n){let s=e.imageData.data,o=e.ctx.createImageData(i,n),a=o.data,l=this.lanczosCreate(this.lanczosLobes),h=this.rcpScaleX,c=this.rcpScaleY,u=2/this.rcpScaleX,d=2/this.rcpScaleY,f=Math.ceil(h*this.lanczosLobes/2),g=Math.ceil(c*this.lanczosLobes/2),p={},m={x:0,y:0},v={x:0,y:0};return function e(y){let x,_,b,C,S,w,T,O,E,P,k;for(x=0,m.x=(y+.5)*h,v.x=Math.floor(m.x);x<n;x++){for(m.y=(x+.5)*c,v.y=Math.floor(m.y),S=0,w=0,T=0,O=0,E=0,_=v.x-f;_<=v.x+f;_++)if(!(_<0)&&!(_>=t)){p[P=Math.floor(1e3*Math.abs(_-m.x))]||(p[P]={});for(let e=v.y-g;e<=v.y+g;e++)e<0||e>=r||(k=Math.floor(1e3*Math.abs(e-m.y)),p[P][k]||(p[P][k]=l(Math.sqrt(Math.pow(P*u,2)+Math.pow(k*d,2))/1e3)),(b=p[P][k])>0&&(C=(e*t+_)*4,S+=b,w+=b*s[C],T+=b*s[C+1],O+=b*s[C+2],E+=b*s[C+3]))}a[C=(x*i+y)*4]=w/S,a[C+1]=T/S,a[C+2]=O/S,a[C+3]=E/S}return++y<i?e(y):o}(0)}bilinearFiltering(e,t,r,i,n){let s,o,a,l,h,c,u,d,f,g;let p=0,m=this.rcpScaleX,v=this.rcpScaleY,y=4*(t-1),x=e.imageData,_=x.data,b=e.ctx.createImageData(i,n),C=b.data;for(l=0;l<n;l++)for(h=0;h<i;h++)for(d=0,o=Math.floor(m*h),a=Math.floor(v*l),c=m*h-o,u=v*l-a,g=4*(a*t+o);d<4;d++)s=_[g+d],f=s*(1-c)*(1-u)+_[g+4+d]*c*(1-u)+_[g+y+d]*u*(1-c)+_[g+y+4+d]*c*u,C[p++]=f;return b}hermiteFastResize(e,t,r,i,n){let s=this.rcpScaleX,o=this.rcpScaleY,a=Math.ceil(s/2),l=Math.ceil(o/2),h=e.imageData,c=h.data,u=e.ctx.createImageData(i,n),d=u.data;for(let e=0;e<n;e++)for(let r=0;r<i;r++){let n=(r+e*i)*4,h=0,u=0,f=0,g=0,p=0,m=0,v=0,y=(e+.5)*o;for(let i=Math.floor(e*o);i<(e+1)*o;i++){let e=Math.abs(y-(i+.5))/l,n=(r+.5)*s,o=e*e;for(let e=Math.floor(r*s);e<(r+1)*s;e++){let r=Math.abs(n-(e+.5))/a,s=Math.sqrt(o+r*r);s>1&&s<-1||!((h=2*s*s*s-3*s*s+1)>0)||(v+=h*c[(r=4*(e+i*t))+3],f+=h,c[r+3]<255&&(h=h*c[r+3]/250),g+=h*c[r],p+=h*c[r+1],m+=h*c[r+2],u+=h)}}d[n]=g/u,d[n+1]=p/u,d[n+2]=m/u,d[n+3]=v/f}return u}toObject(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}Y(ow,"type","Resize"),Y(ow,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,fragmentSourceTOP:"\n    precision highp float;\n    uniform sampler2D uTexture;\n    uniform vec2 uDelta;\n    varying vec2 vTexCoord;\n  "}),eC.setClass(ow);class oT extends s9{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uSaturation;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    float rgMax = max(color.r, color.g);\n    float rgbMax = max(rgMax, color.b);\n    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\n    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\n    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;if(0===this.saturation)return;let r=-this.saturation;for(let e=0;e<t.length;e+=4){let i=Math.max(t[e],t[e+1],t[e+2]);t[e]+=i!==t[e]?(i-t[e])*r:0,t[e+1]+=i!==t[e+1]?(i-t[e+1])*r:0,t[e+2]+=i!==t[e+2]?(i-t[e+2])*r:0}}getUniformLocations(e,t){return{uSaturation:e.getUniformLocation(t,"uSaturation")}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}}Y(oT,"type","Saturation"),Y(oT,"defaults",{saturation:0,mainParameter:"saturation"}),eC.setClass(oT);class oO extends s9{getFragmentSource(){return"\n  precision highp float;\n  uniform sampler2D uTexture;\n  uniform float uVibrance;\n  varying vec2 vTexCoord;\n  void main() {\n    vec4 color = texture2D(uTexture, vTexCoord);\n    float max = max(color.r, max(color.g, color.b));\n    float avg = (color.r + color.g + color.b) / 3.0;\n    float amt = (abs(max - avg) * 2.0) * uVibrance;\n    color.r += max != color.r ? (max - color.r) * amt : 0.00;\n    color.g += max != color.g ? (max - color.g) * amt : 0.00;\n    color.b += max != color.b ? (max - color.b) * amt : 0.00;\n    gl_FragColor = color;\n  }\n"}applyTo2d(e){let{imageData:{data:t}}=e;if(0===this.vibrance)return;let r=-this.vibrance;for(let e=0;e<t.length;e+=4){let i=Math.max(t[e],t[e+1],t[e+2]),n=(t[e]+t[e+1]+t[e+2])/3,s=2*Math.abs(i-n)/255*r;t[e]+=i!==t[e]?(i-t[e])*s:0,t[e+1]+=i!==t[e+1]?(i-t[e+1])*s:0,t[e+2]+=i!==t[e+2]?(i-t[e+2])*s:0}}getUniformLocations(e,t){return{uVibrance:e.getUniformLocation(t,"uVibrance")}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}}Y(oO,"type","Vibrance"),Y(oO,"defaults",{vibrance:0,mainParameter:"vibrance"}),eC.setClass(oO);var oE=r(6980),oP=r(4959);let ok="image";function oj(){let e=(0,L.useContext)(oE.CanvasContext),{selectedObject:t}=(0,L.useContext)(oP.ObjectContext);function r(t){e?.add(t),i()}function i(){e?.renderAll()}function n(){let{canvasWidth:e,canvasHeight:t}=s();return{x:35*e/100,y:25*t/100}}function s(){let t=e?.getWidth()||0,r=e?.getHeight()||0;return{canvasWidth:t,canvasHeight:r}}return{downloadCanvasAsPNG:function(){let t=e?.toDataURL({multiplier:2,format:"png"});if(t){let e=window.document.createElement("a");e.href=t,e.download="apparel-design.png",e.click()}},addRectangleToCanvas:function(){let{x:e,y:t}=n(),i=new iI({left:e,top:t,fill:W,width:80,height:80});r(i)},addLineToCanvas:function(){let{x:e,y:t}=n(),i=new sl([50,100,200,200],{left:e,top:t,stroke:W,strokeWidth:2});r(i)},addCircleToCanvas:function(){let{x:e,y:t}=n(),i=new sn({left:e,top:t,fill:W,radius:40});r(i)},addTextToCanvas:function(e){let{x:t,y:i}=n(),s=new sY(e,{left:t,top:i});r(s)},addImageToCanvas:async function e(e){let t=await sZ.fromURL(e),{x:i,y:o}=n();t.setX(i),t.setY(o);let{canvasWidth:a}=s();a>0&&t.scaleToWidth(30*a/100),r(t)},deleteSelectedObjectFromCanvas:function(){e?.remove(t)},updateObjectColor:function(e,t){"line"===e.type?e.set("stroke",t):e.set("fill",t),i()}}}let oM=function(){for(var e,t,r=0,i="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,i,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(i=e(t[r]))&&(n&&(n+=" "),n+=i)}else for(i in t)t[i]&&(n&&(n+=" "),n+=i)}return n}(e))&&(i&&(i+=" "),i+=t);return i},oD=({variant:e="primary",size:t="md",as:r="button",children:i,className:n,disabled:s=!1,...o})=>R.jsx(r,{className:oM({primary:"text-white bg-blue-600 hover:bg-blue-500",secondary:"bg-white text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",naked:"text-slate-600 bg-transparent !shadow-none hover:text-slate-500"}[e],{xs:"px-2 py-1.5 text-xs",sm:"px-3 py-2",md:"px-4 py-3"}[t],n,"inline-flex items-center rounded-md px-3 py-2 text-sm font-semibold shadow-sm",s?"cursor-auto opacity-40":""),...o,children:i}),oA=L.forwardRef(function({title:e,titleId:t,...r},i){return L.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?L.createElement("title",{id:t},e):null,L.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}),oF=({isBordered:e=!0,className:t="",children:r})=>R.jsx("div",{className:oM("rounded-lg bg-white px-3 py-3",e?"border border-gray-300":"",t),children:r}),oR=({className:e})=>{let{selectedObject:t}=(0,L.useContext)(oP.ObjectContext),{deleteSelectedObjectFromCanvas:r,updateObjectColor:i}=oj(),n=!t,s=n||t?.type===ok,[o,a]=(0,L.useState)(W);return(0,L.useEffect)(function(){t?.type!==ok&&a(t?.get("fill"))},[t]),(0,R.jsxs)(oF,{className:oM("flex items-center justify-end gap-2",e),children:[R.jsx("input",{type:"color",value:o,disabled:s,className:oM("h-8 w-8",s?"opacity-40":""),onChange:function(e){let{value:r}=e.target;a(r),i(t,r)},title:"Change Color"}),R.jsx(oD,{variant:"naked",size:"sm",disabled:n,onClick:r,children:R.jsx(oA,{className:"h-6 w-6"})})]})};var oL=r(3638),oI=Object.defineProperty,oN=(e,t,r)=>t in e?oI(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oB=(e,t,r)=>(oN(e,"symbol"!=typeof t?t+"":t,r),r);class oW{constructor(){oB(this,"current",this.detect()),oB(this,"handoffState","pending"),oB(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"server"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}}let oU=new oW,oX=(e,t)=>{oU.isServer?(0,L.useEffect)(e,t):(0,L.useLayoutEffect)(e,t)};function oY(e){let t=(0,L.useRef)(e);return oX(()=>{t.current=e},[e]),t}let oH=function(e){let t=oY(e);return L.useCallback((...e)=>t.current(...e),[t])};function oz(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))}function oV(e){return oU.isServer?null:e instanceof Node?e.ownerDocument:null!=e&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}function oG(...e){return(0,L.useMemo)(()=>oV(...e),[...e])}function oq(){let e;let t=(e="undefined"==typeof document,"useSyncExternalStore"in I&&(0,I.useSyncExternalStore)(()=>()=>{},()=>!1,()=>!e)),[r,i]=L.useState(oU.isHandoffComplete);return r&&!1===oU.isHandoffComplete&&i(!1),L.useEffect(()=>{!0!==r&&i(!0)},[r]),L.useEffect(()=>oU.handoff(),[]),!t&&r}let o$=Symbol();function oK(e,t=!0){return Object.assign(e,{[o$]:t})}function oQ(...e){let t=(0,L.useRef)(e);(0,L.useEffect)(()=>{t.current=e},[e]);let r=oH(e=>{for(let r of t.current)null!=r&&("function"==typeof r?r(e):r.current=e)});return e.every(e=>null==e||(null==e?void 0:e[o$]))?void 0:r}let oJ=(0,L.createContext)(!1);function oZ(...e){return Array.from(new Set(e.flatMap(e=>"string"==typeof e?e.split(" "):[]))).filter(Boolean).join(" ")}function o0(e,t,...r){if(e in t){let i=t[e];return"function"==typeof i?i(...r):i}let i=Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(e=>`"${e}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,o0),i}var o1=((a=o1||{})[a.None=0]="None",a[a.RenderStrategy=1]="RenderStrategy",a[a.Static=2]="Static",a),o2=((l=o2||{})[l.Unmount=0]="Unmount",l[l.Hidden=1]="Hidden",l);function o5({ourProps:e,theirProps:t,slot:r,defaultTag:i,features:n,visible:s=!0,name:o,mergeRefs:a}){a=null!=a?a:o3;let l=o6(t,e);if(s)return o4(l,r,i,o,a);let h=null!=n?n:0;if(2&h){let{static:e=!1,...t}=l;if(e)return o4(t,r,i,o,a)}if(1&h){let{unmount:e=!0,...t}=l;return o0(e?0:1,{0:()=>null,1:()=>o4({...t,hidden:!0,style:{display:"none"}},r,i,o,a)})}return o4(l,r,i,o,a)}function o4(e,t={},r,i,n){let{as:s=r,children:o,refName:a="ref",...l}=o7(e,["unmount","static"]),h=void 0!==e.ref?{[a]:e.ref}:{},c="function"==typeof o?o(t):o;"className"in l&&l.className&&"function"==typeof l.className&&(l.className=l.className(t));let u={};if(t){let e=!1,r=[];for(let[i,n]of Object.entries(t))"boolean"==typeof n&&(e=!0),!0===n&&r.push(i);e&&(u["data-headlessui-state"]=r.join(" "))}if(s===L.Fragment&&Object.keys(o9(l)).length>0){if(!(0,L.isValidElement)(c)||Array.isArray(c)&&c.length>1)throw Error(['Passing props on "Fragment"!',"",`The current component <${i} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(l).map(e=>`  - ${e}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(e=>`  - ${e}`).join(`
`)].join(`
`));let e=c.props,t="function"==typeof(null==e?void 0:e.className)?(...t)=>oZ(null==e?void 0:e.className(...t),l.className):oZ(null==e?void 0:e.className,l.className);return(0,L.cloneElement)(c,Object.assign({},o6(c.props,o9(o7(l,["ref"]))),u,h,{ref:n(c.ref,h.ref)},t?{className:t}:{}))}return(0,L.createElement)(s,Object.assign({},o7(l,["ref"]),s!==L.Fragment&&h,s!==L.Fragment&&u),c)}function o3(...e){return e.every(e=>null==e)?void 0:t=>{for(let r of e)null!=r&&("function"==typeof r?r(t):r.current=t)}}function o6(...e){if(0===e.length)return{};if(1===e.length)return e[0];let t={},r={};for(let i of e)for(let e in i)e.startsWith("on")&&"function"==typeof i[e]?(null!=r[e]||(r[e]=[]),r[e].push(i[e])):t[e]=i[e];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(r).map(e=>[e,void 0])));for(let e in r)Object.assign(t,{[e](t,...i){for(let n of r[e]){if((t instanceof Event||(null==t?void 0:t.nativeEvent)instanceof Event)&&t.defaultPrevented)return;n(t,...i)}}});return t}function o8(e){var t;return Object.assign((0,L.forwardRef)(e),{displayName:null!=(t=e.displayName)?t:e.name})}function o9(e){let t=Object.assign({},e);for(let e in t)void 0===t[e]&&delete t[e];return t}function o7(e,t=[]){let r=Object.assign({},e);for(let e of t)e in r&&delete r[e];return r}let ae=L.Fragment,at=L.Fragment,ar=(0,L.createContext)(null),ai=(0,L.createContext)(null);Object.assign(o8(function(e,t){let r,i,n=(0,L.useRef)(null),s=oQ(oK(e=>{n.current=e}),t),o=oG(n),a=function(e){let t=(0,L.useContext)(oJ),r=(0,L.useContext)(ar),i=oG(e),[n,s]=(0,L.useState)(()=>{if(!t&&null!==r||oU.isServer)return null;let e=null==i?void 0:i.getElementById("headlessui-portal-root");if(e)return e;if(null===i)return null;let n=i.createElement("div");return n.setAttribute("id","headlessui-portal-root"),i.body.appendChild(n)});return(0,L.useEffect)(()=>{null!==n&&(null!=i&&i.body.contains(n)||null==i||i.body.appendChild(n))},[n,i]),(0,L.useEffect)(()=>{t||null!==r&&s(r.current)},[r,s,t]),n}(n),[l]=(0,L.useState)(()=>{var e;return oU.isServer?null:null!=(e=null==o?void 0:o.createElement("div"))?e:null}),h=(0,L.useContext)(ai),c=oq();return oX(()=>{!a||!l||a.contains(l)||(l.setAttribute("data-headlessui-portal",""),a.appendChild(l))},[a,l]),oX(()=>{if(l&&h)return h.register(l)},[h,l]),r=oH(()=>{var e;a&&l&&(l instanceof Node&&a.contains(l)&&a.removeChild(l),a.childNodes.length<=0&&(null==(e=a.parentElement)||e.removeChild(a)))}),i=(0,L.useRef)(!1),(0,L.useEffect)(()=>(i.current=!1,()=>{i.current=!0,oz(()=>{i.current&&r()})}),[r]),c&&a&&l?(0,oL.createPortal)(o5({ourProps:{ref:s},theirProps:e,defaultTag:ae,name:"Portal"}),l):null}),{Group:o8(function(e,t){let{target:r,...i}=e,n={ref:oQ(t)};return L.createElement(ar.Provider,{value:r},o5({ourProps:n,theirProps:i,defaultTag:at,name:"Popover.Group"}))})});let an=null!=(F=L.useId)?F:function(){let e=oq(),[t,r]=L.useState(e?()=>oU.nextId():null);return oX(()=>{null===t&&r(oU.nextId())},[t]),null!=t?""+t:void 0},as=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var ao=((h=ao||{})[h.First=1]="First",h[h.Previous=2]="Previous",h[h.Next=4]="Next",h[h.Last=8]="Last",h[h.WrapAround=16]="WrapAround",h[h.NoScroll=32]="NoScroll",h),aa=((c=aa||{})[c.Error=0]="Error",c[c.Overflow=1]="Overflow",c[c.Success=2]="Success",c[c.Underflow=3]="Underflow",c),al=((u=al||{})[u.Previous=-1]="Previous",u[u.Next=1]="Next",u);function ah(e=document.body){return null==e?[]:Array.from(e.querySelectorAll(as)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var ac=((d=ac||{})[d.Strict=0]="Strict",d[d.Loose=1]="Loose",d);function au(e,t=0){var r;return e!==(null==(r=oV(e))?void 0:r.body)&&o0(t,{0:()=>e.matches(as),1(){let t=e;for(;null!==t;){if(t.matches(as))return!0;t=t.parentElement}return!1}})}var ad=((f=ad||{})[f.Keyboard=0]="Keyboard",f[f.Mouse=1]="Mouse",f);function af(e,t=e=>e){return e.slice().sort((e,r)=>{let i=t(e),n=t(r);if(null===i||null===n)return 0;let s=i.compareDocumentPosition(n);return s&Node.DOCUMENT_POSITION_FOLLOWING?-1:s&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function ag(e,t,{sorted:r=!0,relativeTo:i=null,skipElements:n=[]}={}){var s,o,a;let l=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,h=Array.isArray(e)?r?af(e):e:ah(e);n.length>0&&h.length>1&&(h=h.filter(e=>!n.includes(e))),i=null!=i?i:l.activeElement;let c=(()=>{if(5&t)return 1;if(10&t)return -1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,h.indexOf(i))-1;if(4&t)return Math.max(0,h.indexOf(i))+1;if(8&t)return h.length-1;throw Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=32&t?{preventScroll:!0}:{},f=0,g=h.length,p;do{if(f>=g||f+g<=0)return 0;let e=u+f;if(16&t)e=(e+g)%g;else{if(e<0)return 3;if(e>=g)return 1}null==(p=h[e])||p.focus(d),f+=c}while(p!==l.activeElement);return 6&t&&null!=(a=null==(o=null==(s=p)?void 0:s.matches)?void 0:o.call(s,"textarea,input"))&&a&&p.select(),2}function ap(e,t,r){let i=oY(t);(0,L.useEffect)(()=>{function t(e){i.current(e)}return document.addEventListener(e,t,r),()=>document.removeEventListener(e,t,r)},[e,r])}function am(e,t,r){let i=oY(t);(0,L.useEffect)(()=>{function t(e){i.current(e)}return window.addEventListener(e,t,r),()=>window.removeEventListener(e,t,r)},[e,r])}function av(e){var t;if(e.type)return e.type;let r=null!=(t=e.as)?t:"button";if("string"==typeof r&&"button"===r.toLowerCase())return"button"}function ay(e,t){let[r,i]=(0,L.useState)(()=>av(e));return oX(()=>{i(av(e))},[e.type,e.as]),oX(()=>{r||t.current&&t.current instanceof HTMLButtonElement&&!t.current.hasAttribute("type")&&i("button")},[r,t]),r}var ax=((g=ax||{})[g.None=1]="None",g[g.Focusable=2]="Focusable",g[g.Hidden=4]="Hidden",g);let a_=o8(function(e,t){var r;let{features:i=1,...n}=e;return o5({ourProps:{ref:t,"aria-hidden":(2&i)==2||(null!=(r=n["aria-hidden"])?r:void 0),style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(4&i)==4&&(2&i)!=2&&{display:"none"}}},theirProps:n,slot:{},defaultTag:"div",name:"Hidden"})});var ab=((p=ab||{})[p.Forwards=0]="Forwards",p[p.Backwards=1]="Backwards",p);function aC(){let e=(0,L.useRef)(0);return am("keydown",t=>{"Tab"===t.key&&(e.current=t.shiftKey?1:0)},!0),e}let aS=(0,L.createContext)(null);aS.displayName="OpenClosedContext";var aw=((m=aw||{})[m.Open=1]="Open",m[m.Closed=2]="Closed",m[m.Closing=4]="Closing",m[m.Opening=8]="Opening",m);function aT(){return(0,L.useContext)(aS)}function aO({value:e,children:t}){return L.createElement(aS.Provider,{value:e},t)}function aE(e){let t=e.parentElement,r=null;for(;t&&!(t instanceof HTMLFieldSetElement);)t instanceof HTMLLegendElement&&(r=t),t=t.parentElement;let i=(null==t?void 0:t.getAttribute("disabled"))==="";return!(i&&function(e){if(!e)return!1;let t=e.previousElementSibling;for(;null!==t;){if(t instanceof HTMLLegendElement)return!1;t=t.previousElementSibling}return!0}(r))&&i}var aP=((v=aP||{}).Space=" ",v.Enter="Enter",v.Escape="Escape",v.Backspace="Backspace",v.Delete="Delete",v.ArrowLeft="ArrowLeft",v.ArrowUp="ArrowUp",v.ArrowRight="ArrowRight",v.ArrowDown="ArrowDown",v.Home="Home",v.End="End",v.PageUp="PageUp",v.PageDown="PageDown",v.Tab="Tab",v),ak=((y=ak||{})[y.Open=0]="Open",y[y.Closed=1]="Closed",y),aj=((x=aj||{})[x.TogglePopover=0]="TogglePopover",x[x.ClosePopover=1]="ClosePopover",x[x.SetButton=2]="SetButton",x[x.SetButtonId=3]="SetButtonId",x[x.SetPanel=4]="SetPanel",x[x.SetPanelId=5]="SetPanelId",x);let aM={0:e=>{let t={...e,popoverState:o0(e.popoverState,{0:1,1:0})};return 0===t.popoverState&&(t.__demoMode=!1),t},1:e=>1===e.popoverState?e:{...e,popoverState:1},2:(e,t)=>e.button===t.button?e:{...e,button:t.button},3:(e,t)=>e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId},4:(e,t)=>e.panel===t.panel?e:{...e,panel:t.panel},5:(e,t)=>e.panelId===t.panelId?e:{...e,panelId:t.panelId}},aD=(0,L.createContext)(null);function aA(e){let t=(0,L.useContext)(aD);if(null===t){let t=Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,aA),t}return t}aD.displayName="PopoverContext";let aF=(0,L.createContext)(null);function aR(e){let t=(0,L.useContext)(aF);if(null===t){let t=Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,aR),t}return t}aF.displayName="PopoverAPIContext";let aL=(0,L.createContext)(null);function aI(){return(0,L.useContext)(aL)}aL.displayName="PopoverGroupContext";let aN=(0,L.createContext)(null);function aB(e,t){return o0(t.type,aM,e,t)}aN.displayName="PopoverPanelContext";let aW=o1.RenderStrategy|o1.Static,aU=o1.RenderStrategy|o1.Static,aX=Object.assign(o8(function(e,t){var r,i,n;let s,o,a,l,h,c;let{__demoMode:u=!1,...d}=e,f=(0,L.useRef)(null),g=oQ(t,oK(e=>{f.current=e})),p=(0,L.useRef)([]),m=(0,L.useReducer)(aB,{__demoMode:u,popoverState:u?0:1,buttons:p,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:(0,L.createRef)(),afterPanelSentinel:(0,L.createRef)()}),[{popoverState:v,button:y,buttonId:x,panel:_,panelId:b,beforePanelSentinel:C,afterPanelSentinel:S},w]=m,T=oG(null!=(r=f.current)?r:y),O=(0,L.useMemo)(()=>{if(!y||!_)return!1;for(let e of document.querySelectorAll("body > *"))if(Number(null==e?void 0:e.contains(y))^Number(null==e?void 0:e.contains(_)))return!0;let e=ah(),t=e.indexOf(y),r=(t+e.length-1)%e.length,i=(t+1)%e.length,n=e[r],s=e[i];return!_.contains(n)&&!_.contains(s)},[y,_]),E=oY(x),P=oY(b),k=(0,L.useMemo)(()=>({buttonId:E,panelId:P,close:()=>w({type:1})}),[E,P,w]),j=aI(),M=null==j?void 0:j.registerPopover,D=oH(()=>{var e;return null!=(e=null==j?void 0:j.isFocusWithinPopoverGroup())?e:(null==T?void 0:T.activeElement)&&((null==y?void 0:y.contains(T.activeElement))||(null==_?void 0:_.contains(T.activeElement)))});(0,L.useEffect)(()=>null==M?void 0:M(k),[M,k]);let[A,F]=(s=(0,L.useContext)(ai),o=(0,L.useRef)([]),a=oH(e=>(o.current.push(e),s&&s.register(e),()=>l(e))),l=oH(e=>{let t=o.current.indexOf(e);-1!==t&&o.current.splice(t,1),s&&s.unregister(e)}),h=(0,L.useMemo)(()=>({register:a,unregister:l,portals:o}),[a,l,o]),[o,(0,L.useMemo)(()=>function({children:e}){return L.createElement(ai.Provider,{value:h},e)},[h])]),R=function({defaultContainers:e=[],portals:t,mainTreeNodeRef:r}={}){var i;let n=(0,L.useRef)(null!=(i=null==r?void 0:r.current)?i:null),s=oG(n),o=oH(()=>{var r,i,o;let a=[];for(let t of e)null!==t&&(t instanceof HTMLElement?a.push(t):"current"in t&&t.current instanceof HTMLElement&&a.push(t.current));if(null!=t&&t.current)for(let e of t.current)a.push(e);for(let e of null!=(r=null==s?void 0:s.querySelectorAll("html > *, body > *"))?r:[])e!==document.body&&e!==document.head&&e instanceof HTMLElement&&"headlessui-portal-root"!==e.id&&(e.contains(n.current)||e.contains(null==(o=null==(i=n.current)?void 0:i.getRootNode())?void 0:o.host)||a.some(t=>e.contains(t))||a.push(e));return a});return{resolveContainers:o,contains:oH(e=>o().some(t=>t.contains(e))),mainTreeNodeRef:n,MainTreeNode:(0,L.useMemo)(()=>function(){return null!=r?null:L.createElement(a_,{features:ax.Hidden,ref:n})},[n,r])}}({mainTreeNodeRef:null==j?void 0:j.mainTreeNodeRef,portals:A,defaultContainers:[y,_]});i=null==T?void 0:T.defaultView,n="focus",c=oY(e=>{var t,r,i,n;e.target!==window&&e.target instanceof HTMLElement&&0===v&&(D()||y&&_&&(R.contains(e.target)||null!=(r=null==(t=C.current)?void 0:t.contains)&&r.call(t,e.target)||null!=(n=null==(i=S.current)?void 0:i.contains)&&n.call(i,e.target)||w({type:1})))}),(0,L.useEffect)(()=>{function e(e){c.current(e)}return(i=null!=i?i:window).addEventListener(n,e,!0),()=>i.removeEventListener(n,e,!0)},[i,n,!0]),function(e,t,r=!0){let i=(0,L.useRef)(!1);function n(r,n){if(!i.current||r.defaultPrevented)return;let s=n(r);if(null!==s&&s.getRootNode().contains(s)&&s.isConnected){for(let t of function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(e)){if(null===t)continue;let e=t instanceof HTMLElement?t:t.current;if(null!=e&&e.contains(s)||r.composed&&r.composedPath().includes(e))return}return au(s,ac.Loose)||-1===s.tabIndex||r.preventDefault(),t(r,s)}}(0,L.useEffect)(()=>{requestAnimationFrame(()=>{i.current=r})},[r]);let s=(0,L.useRef)(null);ap("pointerdown",e=>{var t,r;i.current&&(s.current=(null==(r=null==(t=e.composedPath)?void 0:t.call(e))?void 0:r[0])||e.target)},!0),ap("mousedown",e=>{var t,r;i.current&&(s.current=(null==(r=null==(t=e.composedPath)?void 0:t.call(e))?void 0:r[0])||e.target)},!0),ap("click",e=>{/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0||/Android/gi.test(window.navigator.userAgent)||s.current&&(n(e,()=>s.current),s.current=null)},!0),ap("touchend",e=>n(e,()=>e.target instanceof HTMLElement?e.target:null),!0),am("blur",e=>n(e,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}(R.resolveContainers,(e,t)=>{w({type:1}),au(t,ac.Loose)||(e.preventDefault(),null==y||y.focus())},0===v);let I=oH(e=>{w({type:1});let t=e?e instanceof HTMLElement?e:"current"in e&&e.current instanceof HTMLElement?e.current:y:y;null==t||t.focus()}),N=(0,L.useMemo)(()=>({close:I,isPortalled:O}),[I,O]),B=(0,L.useMemo)(()=>({open:0===v,close:I}),[v,I]);return L.createElement(aN.Provider,{value:null},L.createElement(aD.Provider,{value:m},L.createElement(aF.Provider,{value:N},L.createElement(aO,{value:o0(v,{0:aw.Open,1:aw.Closed})},L.createElement(F,null,o5({ourProps:{ref:g},theirProps:d,slot:B,defaultTag:"div",name:"Popover"}),L.createElement(R.MainTreeNode,null))))))}),{Button:o8(function(e,t){let r=an(),{id:i=`headlessui-popover-button-${r}`,...n}=e,[s,o]=aA("Popover.Button"),{isPortalled:a}=aR("Popover.Button"),l=(0,L.useRef)(null),h=`headlessui-focus-sentinel-${an()}`,c=aI(),u=null==c?void 0:c.closeOthers,d=null!==(0,L.useContext)(aN);(0,L.useEffect)(()=>{if(!d)return o({type:3,buttonId:i}),()=>{o({type:3,buttonId:null})}},[d,i,o]);let[f]=(0,L.useState)(()=>Symbol()),g=oQ(l,t,d?null:e=>{if(e)s.buttons.current.push(f);else{let e=s.buttons.current.indexOf(f);-1!==e&&s.buttons.current.splice(e,1)}s.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),e&&o({type:2,button:e})}),p=oQ(l,t),m=oG(l),v=oH(e=>{var t,r,i;if(d){if(1===s.popoverState)return;switch(e.key){case aP.Space:case aP.Enter:e.preventDefault(),null==(r=(t=e.target).click)||r.call(t),o({type:1}),null==(i=s.button)||i.focus()}}else switch(e.key){case aP.Space:case aP.Enter:e.preventDefault(),e.stopPropagation(),1===s.popoverState&&(null==u||u(s.buttonId)),o({type:0});break;case aP.Escape:if(0!==s.popoverState)return null==u?void 0:u(s.buttonId);if(!l.current||null!=m&&m.activeElement&&!l.current.contains(m.activeElement))return;e.preventDefault(),e.stopPropagation(),o({type:1})}}),y=oH(e=>{d||e.key===aP.Space&&e.preventDefault()}),x=oH(t=>{var r,i;aE(t.currentTarget)||e.disabled||(d?(o({type:1}),null==(r=s.button)||r.focus()):(t.preventDefault(),t.stopPropagation(),1===s.popoverState&&(null==u||u(s.buttonId)),o({type:0}),null==(i=s.button)||i.focus()))}),_=oH(e=>{e.preventDefault(),e.stopPropagation()}),b=0===s.popoverState,C=(0,L.useMemo)(()=>({open:b}),[b]),S=ay(e,l),w=d?{ref:p,type:S,onKeyDown:v,onClick:x}:{ref:g,id:s.buttonId,type:S,"aria-expanded":0===s.popoverState,"aria-controls":s.panel?s.panelId:void 0,onKeyDown:v,onKeyUp:y,onClick:x,onMouseDown:_},T=aC(),O=oH(()=>{let e=s.panel;e&&o0(T.current,{[ab.Forwards]:()=>ag(e,ao.First),[ab.Backwards]:()=>ag(e,ao.Last)})===aa.Error&&ag(ah().filter(e=>"true"!==e.dataset.headlessuiFocusGuard),o0(T.current,{[ab.Forwards]:ao.Next,[ab.Backwards]:ao.Previous}),{relativeTo:s.button})});return L.createElement(L.Fragment,null,o5({ourProps:w,theirProps:n,slot:C,defaultTag:"button",name:"Popover.Button"}),b&&!d&&a&&L.createElement(a_,{id:h,features:ax.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:O}))}),Overlay:o8(function(e,t){let r=an(),{id:i=`headlessui-popover-overlay-${r}`,...n}=e,[{popoverState:s},o]=aA("Popover.Overlay"),a=oQ(t),l=aT(),h=null!==l?(l&aw.Open)===aw.Open:0===s;return o5({ourProps:{ref:a,id:i,"aria-hidden":!0,onClick:oH(e=>{if(aE(e.currentTarget))return e.preventDefault();o({type:1})})},theirProps:n,slot:(0,L.useMemo)(()=>({open:0===s}),[s]),defaultTag:"div",features:aW,visible:h,name:"Popover.Overlay"})}),Panel:o8(function(e,t){let r,i;let n=an(),{id:s=`headlessui-popover-panel-${n}`,focus:o=!1,...a}=e,[l,h]=aA("Popover.Panel"),{close:c,isPortalled:u}=aR("Popover.Panel"),d=`headlessui-focus-sentinel-before-${an()}`,f=`headlessui-focus-sentinel-after-${an()}`,g=(0,L.useRef)(null),p=oQ(g,t,e=>{h({type:4,panel:e})}),m=oG(g),v=(r=(0,L.useRef)([]),i=(0,L.useCallback)(e=>{for(let t of r.current)null!=t&&("function"==typeof t?t(e):t.current=e)},[]),(...e)=>{if(!e.every(e=>null==e))return r.current=e,i});oX(()=>(h({type:5,panelId:s}),()=>{h({type:5,panelId:null})}),[s,h]);let y=aT(),x=null!==y?(y&aw.Open)===aw.Open:0===l.popoverState,_=oH(e=>{var t;if(e.key===aP.Escape){if(0!==l.popoverState||!g.current||null!=m&&m.activeElement&&!g.current.contains(m.activeElement))return;e.preventDefault(),e.stopPropagation(),h({type:1}),null==(t=l.button)||t.focus()}});(0,L.useEffect)(()=>{var t;e.static||1===l.popoverState&&(null==(t=e.unmount)||t)&&h({type:4,panel:null})},[l.popoverState,e.unmount,e.static,h]),(0,L.useEffect)(()=>{if(l.__demoMode||!o||0!==l.popoverState||!g.current)return;let e=null==m?void 0:m.activeElement;g.current.contains(e)||ag(g.current,ao.First)},[l.__demoMode,o,g,l.popoverState]);let b=(0,L.useMemo)(()=>({open:0===l.popoverState,close:c}),[l,c]),C={ref:p,id:s,onKeyDown:_,onBlur:o&&0===l.popoverState?e=>{var t,r,i,n,s;let o=e.relatedTarget;o&&g.current&&(null!=(t=g.current)&&t.contains(o)||(h({type:1}),(null!=(i=null==(r=l.beforePanelSentinel.current)?void 0:r.contains)&&i.call(r,o)||null!=(s=null==(n=l.afterPanelSentinel.current)?void 0:n.contains)&&s.call(n,o))&&o.focus({preventScroll:!0})))}:void 0,tabIndex:-1},S=aC(),w=oH(()=>{let e=g.current;e&&o0(S.current,{[ab.Forwards]:()=>{var t;ag(e,ao.First)===aa.Error&&(null==(t=l.afterPanelSentinel.current)||t.focus())},[ab.Backwards]:()=>{var e;null==(e=l.button)||e.focus({preventScroll:!0})}})}),T=oH(()=>{let e=g.current;e&&o0(S.current,{[ab.Forwards]:()=>{var e;if(!l.button)return;let t=ah(),r=t.indexOf(l.button),i=t.slice(0,r+1),n=[...t.slice(r+1),...i];for(let t of n.slice())if("true"===t.dataset.headlessuiFocusGuard||null!=(e=l.panel)&&e.contains(t)){let e=n.indexOf(t);-1!==e&&n.splice(e,1)}ag(n,ao.First,{sorted:!1})},[ab.Backwards]:()=>{var t;ag(e,ao.Previous)===aa.Error&&(null==(t=l.button)||t.focus())}})});return L.createElement(aN.Provider,{value:s},x&&u&&L.createElement(a_,{id:d,ref:l.beforePanelSentinel,features:ax.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:w}),o5({mergeRefs:v,ourProps:C,theirProps:a,slot:b,defaultTag:"div",features:aU,visible:x,name:"Popover.Panel"}),x&&u&&L.createElement(a_,{id:f,ref:l.afterPanelSentinel,features:ax.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:T}))}),Group:o8(function(e,t){let r;let i=(0,L.useRef)(null),n=oQ(i,t),[s,o]=(0,L.useState)([]),a={mainTreeNodeRef:r=(0,L.useRef)(null),MainTreeNode:(0,L.useMemo)(()=>function(){return L.createElement(a_,{features:ax.Hidden,ref:r})},[r])},l=oH(e=>{o(t=>{let r=t.indexOf(e);if(-1!==r){let e=t.slice();return e.splice(r,1),e}return t})}),h=oH(e=>(o(t=>[...t,e]),()=>l(e))),c=oH(()=>{var e;let t=oV(i);if(!t)return!1;let r=t.activeElement;return!!(null!=(e=i.current)&&e.contains(r))||s.some(e=>{var i,n;return(null==(i=t.getElementById(e.buttonId.current))?void 0:i.contains(r))||(null==(n=t.getElementById(e.panelId.current))?void 0:n.contains(r))})}),u=oH(e=>{for(let t of s)t.buttonId.current!==e&&t.close()}),d=(0,L.useMemo)(()=>({registerPopover:h,unregisterPopover:l,isFocusWithinPopoverGroup:c,closeOthers:u,mainTreeNodeRef:a.mainTreeNodeRef}),[h,l,c,u,a.mainTreeNodeRef]),f=(0,L.useMemo)(()=>({}),[]);return L.createElement(aL.Provider,{value:d},o5({ourProps:{ref:n},theirProps:e,slot:f,defaultTag:"div",name:"Popover.Group"}),L.createElement(a.MainTreeNode,null))})});function aY(){let e=[],t={addEventListener:(e,r,i,n)=>(e.addEventListener(r,i,n),t.add(()=>e.removeEventListener(r,i,n))),requestAnimationFrame(...e){let r=requestAnimationFrame(...e);return t.add(()=>cancelAnimationFrame(r))},nextFrame:(...e)=>t.requestAnimationFrame(()=>t.requestAnimationFrame(...e)),setTimeout(...e){let r=setTimeout(...e);return t.add(()=>clearTimeout(r))},microTask(...e){let r={current:!0};return oz(()=>{r.current&&e[0]()}),t.add(()=>{r.current=!1})},style(e,t,r){let i=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:r}),this.add(()=>{Object.assign(e.style,{[t]:i})})},group(e){let t=aY();return e(t),this.add(()=>t.dispose())},add:t=>(e.push(t),()=>{let r=e.indexOf(t);if(r>=0)for(let t of e.splice(r,1))t()}),dispose(){for(let t of e.splice(0))t()}};return t}function aH(){let[e]=(0,L.useState)(aY);return(0,L.useEffect)(()=>()=>e.dispose(),[e]),e}function az(){let e=(0,L.useRef)(!1);return oX(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function aV(e,...t){e&&t.length>0&&e.classList.add(...t)}function aG(e,...t){e&&t.length>0&&e.classList.remove(...t)}function aq(e=""){return e.split(/\s+/).filter(e=>e.length>1)}let a$=(0,L.createContext)(null);a$.displayName="TransitionContext";var aK=((_=aK||{}).Visible="visible",_.Hidden="hidden",_);let aQ=(0,L.createContext)(null);function aJ(e){return"children"in e?aJ(e.children):e.current.filter(({el:e})=>null!==e.current).filter(({state:e})=>"visible"===e).length>0}function aZ(e,t){let r=oY(e),i=(0,L.useRef)([]),n=az(),s=aH(),o=oH((e,t=o2.Hidden)=>{let o=i.current.findIndex(({el:t})=>t===e);-1!==o&&(o0(t,{[o2.Unmount](){i.current.splice(o,1)},[o2.Hidden](){i.current[o].state="hidden"}}),s.microTask(()=>{var e;!aJ(i)&&n.current&&(null==(e=r.current)||e.call(r))}))}),a=oH(e=>{let t=i.current.find(({el:t})=>t===e);return t?"visible"!==t.state&&(t.state="visible"):i.current.push({el:e,state:"visible"}),()=>o(e,o2.Unmount)}),l=(0,L.useRef)([]),h=(0,L.useRef)(Promise.resolve()),c=(0,L.useRef)({enter:[],leave:[],idle:[]}),u=oH((e,r,i)=>{l.current.splice(0),t&&(t.chains.current[r]=t.chains.current[r].filter(([t])=>t!==e)),null==t||t.chains.current[r].push([e,new Promise(e=>{l.current.push(e)})]),null==t||t.chains.current[r].push([e,new Promise(e=>{Promise.all(c.current[r].map(([e,t])=>t)).then(()=>e())})]),"enter"===r?h.current=h.current.then(()=>null==t?void 0:t.wait.current).then(()=>i(r)):i(r)}),d=oH((e,t,r)=>{Promise.all(c.current[t].splice(0).map(([e,t])=>t)).then(()=>{var e;null==(e=l.current.shift())||e()}).then(()=>r(t))});return(0,L.useMemo)(()=>({children:i,register:a,unregister:o,onStart:u,onStop:d,wait:h,chains:c}),[a,o,i,u,d,c,h])}function a0(){}aQ.displayName="NestingContext";let a1=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function a2(e){var t;let r={};for(let i of a1)r[i]=null!=(t=e[i])?t:a0;return r}let a5=o1.RenderStrategy,a4=o8(function(e,t){let{show:r,appear:i=!1,unmount:n=!0,...s}=e,o=(0,L.useRef)(null),a=oQ(o,t);oq();let l=aT();if(void 0===r&&null!==l&&(r=(l&aw.Open)===aw.Open),![!0,!1].includes(r))throw Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,c]=(0,L.useState)(r?"visible":"hidden"),u=aZ(()=>{c("hidden")}),[d,f]=(0,L.useState)(!0),g=(0,L.useRef)([r]);oX(()=>{!1!==d&&g.current[g.current.length-1]!==r&&(g.current.push(r),f(!1))},[g,r]);let p=(0,L.useMemo)(()=>({show:r,appear:i,initial:d}),[r,i,d]);(0,L.useEffect)(()=>{if(r)c("visible");else if(aJ(u)){let e=o.current;if(!e)return;let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&c("hidden")}else c("hidden")},[r,u]);let m={unmount:n},v=oH(()=>{var t;d&&f(!1),null==(t=e.beforeEnter)||t.call(e)}),y=oH(()=>{var t;d&&f(!1),null==(t=e.beforeLeave)||t.call(e)});return L.createElement(aQ.Provider,{value:u},L.createElement(a$.Provider,{value:p},o5({ourProps:{...m,as:L.Fragment,children:L.createElement(a3,{ref:a,...m,...s,beforeEnter:v,beforeLeave:y})},theirProps:{},defaultTag:L.Fragment,features:a5,visible:"visible"===h,name:"Transition"})))}),a3=o8(function(e,t){var r,i,n;let s;let{beforeEnter:o,afterEnter:a,beforeLeave:l,afterLeave:h,enter:c,enterFrom:u,enterTo:d,entered:f,leave:g,leaveFrom:p,leaveTo:m,...v}=e,y=(0,L.useRef)(null),x=oQ(y,t),_=null==(r=v.unmount)||r?o2.Unmount:o2.Hidden,{show:b,appear:C,initial:S}=function(){let e=(0,L.useContext)(a$);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[w,T]=(0,L.useState)(b?"visible":"hidden"),O=function(){let e=(0,L.useContext)(aQ);if(null===e)throw Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:E,unregister:P}=O;(0,L.useEffect)(()=>E(y),[E,y]),(0,L.useEffect)(()=>{if(_===o2.Hidden&&y.current){if(b&&"visible"!==w){T("visible");return}return o0(w,{hidden:()=>P(y),visible:()=>E(y)})}},[w,y,E,P,b,_]);let k=oY({base:aq(v.className),enter:aq(c),enterFrom:aq(u),enterTo:aq(d),entered:aq(f),leave:aq(g),leaveFrom:aq(p),leaveTo:aq(m)}),j=(n={beforeEnter:o,afterEnter:a,beforeLeave:l,afterLeave:h},s=(0,L.useRef)(a2(n)),(0,L.useEffect)(()=>{s.current=a2(n)},[n]),s),M=oq();(0,L.useEffect)(()=>{if(M&&"visible"===w&&null===y.current)throw Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[y,w,M]);let D=C&&b&&S,A=M&&(!S||C)?b?"enter":"leave":"idle",F=function(e=0){let[t,r]=(0,L.useState)(e),i=az(),n=(0,L.useCallback)(e=>{i.current&&r(t=>t|e)},[t,i]),s=(0,L.useCallback)(e=>!!(t&e),[t]);return{flags:t,addFlag:n,hasFlag:s,removeFlag:(0,L.useCallback)(e=>{i.current&&r(t=>t&~e)},[r,i]),toggleFlag:(0,L.useCallback)(e=>{i.current&&r(t=>t^e)},[r])}}(0),R=oH(e=>o0(e,{enter:()=>{F.addFlag(aw.Opening),j.current.beforeEnter()},leave:()=>{F.addFlag(aw.Closing),j.current.beforeLeave()},idle:()=>{}})),I=oH(e=>o0(e,{enter:()=>{F.removeFlag(aw.Opening),j.current.afterEnter()},leave:()=>{F.removeFlag(aw.Closing),j.current.afterLeave()},idle:()=>{}})),N=aZ(()=>{T("hidden"),P(y)},O),B=(0,L.useRef)(!1);!function({immediate:e,container:t,direction:r,classes:i,onStart:n,onStop:s}){let o=az(),a=aH(),l=oY(r);oX(()=>{e&&(l.current="enter")},[e]),oX(()=>{let e=aY();a.add(e.dispose);let r=t.current;if(r&&"idle"!==l.current&&o.current){var h,c,u;let t,o,a,d,f,g,p;return e.dispose(),n.current(l.current),e.add((h=i.current,c="enter"===l.current,u=()=>{e.dispose(),s.current(l.current)},o=c?"enter":"leave",a=aY(),d=void 0!==u?(t={called:!1},(...e)=>{if(!t.called)return t.called=!0,u(...e)}):()=>{},"enter"===o&&(r.removeAttribute("hidden"),r.style.display=""),f=o0(o,{enter:()=>h.enter,leave:()=>h.leave}),g=o0(o,{enter:()=>h.enterTo,leave:()=>h.leaveTo}),p=o0(o,{enter:()=>h.enterFrom,leave:()=>h.leaveFrom}),aG(r,...h.base,...h.enter,...h.enterTo,...h.enterFrom,...h.leave,...h.leaveFrom,...h.leaveTo,...h.entered),aV(r,...h.base,...f,...p),a.nextFrame(()=>{aG(r,...h.base,...f,...p),aV(r,...h.base,...f,...g),function(e,t){let r=aY();if(!e)return r.dispose;let{transitionDuration:i,transitionDelay:n}=getComputedStyle(e),[s,o]=[i,n].map(e=>{let[t=0]=e.split(",").filter(Boolean).map(e=>e.includes("ms")?parseFloat(e):1e3*parseFloat(e)).sort((e,t)=>t-e);return t}),a=s+o;if(0!==a){r.group(r=>{r.setTimeout(()=>{t(),r.dispose()},a),r.addEventListener(e,"transitionrun",e=>{e.target===e.currentTarget&&r.dispose()})});let i=r.addEventListener(e,"transitionend",e=>{e.target===e.currentTarget&&(t(),i())})}else t();r.add(()=>t()),r.dispose}(r,()=>(aG(r,...h.base,...f),aV(r,...h.base,...h.entered),d()))}),a.dispose)),e.dispose}},[r])}({immediate:D,container:y,classes:k,direction:A,onStart:oY(e=>{B.current=!0,N.onStart(y,e,R)}),onStop:oY(e=>{B.current=!1,N.onStop(y,e,I),"leave"!==e||aJ(N)||(T("hidden"),P(y))})});let W=v;return D?W={...W,className:oZ(v.className,...k.current.enter,...k.current.enterFrom)}:B.current&&(W.className=oZ(v.className,null==(i=y.current)?void 0:i.className),""===W.className&&delete W.className),L.createElement(aQ.Provider,{value:N},L.createElement(aO,{value:o0(w,{visible:aw.Open,hidden:aw.Closed})|F.flags},o5({ourProps:{ref:x},theirProps:W,defaultTag:"div",features:a5,visible:"visible"===w,name:"Transition.Child"})))}),a6=o8(function(e,t){let r=null!==(0,L.useContext)(a$),i=null!==aT();return L.createElement(L.Fragment,null,!r&&i?L.createElement(a4,{ref:t,...e}):L.createElement(a3,{ref:t,...e}))}),a8=Object.assign(a4,{Child:a6,Root:a4}),a9=L.forwardRef(function({title:e,titleId:t,...r},i){return L.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?L.createElement("title",{id:t},e):null,L.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}),a7=e=>{let{className:t,size:r="md",color:i="black"}=e;return R.jsx("span",{className:oM("inline-block rounded-full border-2 bg-blue-900",{black:"bg-gray-900",gray:"bg-gray-500",navy:"bg-blue-800",white:"bg-white"}[i],{md:"h-9 w-9",sm:"h-5 w-5"}[r],t),title:i})},le=e=>{let t=(0,L.useContext)(B.ApparelContext),r=(0,L.useContext)(B.ApparelDispatchContext);return R.jsx(oF,{className:e.className,children:(0,R.jsxs)("div",{className:"flex gap-3",children:[(0,R.jsxs)(aX,{className:"relative",children:[R.jsx(aX.Button,{children:(0,R.jsxs)(oD,{variant:"secondary",as:"a",children:[R.jsx(a7,{size:"sm",className:"mr-2",color:t.color})," ","Apparel Color"]})}),R.jsx(a8,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,R.jsxs)(aX.Panel,{className:"absolute z-10 w-52 rounded-lg bg-white px-4 py-3 shadow-lg ring-1 ring-black/5",children:[R.jsx("p",{className:"mb-4 text-sm font-normal text-gray-500",children:"Choose one"}),R.jsx("div",{className:"flex gap-2",children:["black","white","gray","navy"].map((e,t)=>R.jsx("button",{type:"button",onClick:()=>{r({type:"color-changed",payload:e})},children:R.jsx(a7,{color:e})},`${e}-${t}`))})]})})]}),(0,R.jsxs)(aX,{className:"relative",children:[R.jsx(aX.Button,{children:R.jsx(oD,{variant:"secondary",as:"a",children:"Apparel Type"})}),R.jsx(a8,{enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,R.jsxs)(aX.Panel,{className:"absolute z-10 w-52 rounded-lg bg-white py-1 shadow-lg ring-1 ring-black/5",children:[R.jsx("p",{className:"px-4 py-3 text-sm font-normal text-gray-500",children:"Choose one"}),R.jsx("div",{children:["tshirt","hoodie"].map((e,i)=>{let n=e===t.type;return(0,R.jsxs)("button",{type:"button",className:oM("flex w-full justify-between bg-white px-4 py-2 text-left hover:bg-slate-100",n?"bg-slate-100":"bg-white"),onClick:()=>{r({type:"type-changed",payload:e})},children:[R.jsx("span",{className:"first-letter:uppercase",children:e}),n&&R.jsx(a9,{width:24,height:24})]},`${e}-${i}`)})})]})})]})]})})},lt=()=>(0,R.jsxs)("footer",{className:"mt-14 text-center",children:["\xa9 ",new Date().getFullYear()," - Tri Hargianto ",R.jsx("br",{})]});var lr=r(3978);let li=({apparel:e,color:t="black",gender:r="male",side:i="front"})=>{let n=(0,L.useContext)(oE.CanvasDispatchContext),s=(0,L.useContext)(oP.ObjectDispatchContext),o=(0,L.useRef)(null),{is2XLargeScreen:a,isLargeScreen:l,isXLargeScreen:h}=function(){let e=(0,lr.useMediaQuery)({query:"(min-width: 768px)"}),t=(0,lr.useMediaQuery)({query:"(min-width: 1024px)"}),r=(0,lr.useMediaQuery)({query:"(min-width: 1280px)"}),i=(0,lr.useMediaQuery)({query:"(min-width: 1536px)"});return{isMediumScreen:e,isLargeScreen:t,isXLargeScreen:r,is2XLargeScreen:i}}(),c=340,u=453;return a?(c=552,u=736):h?(c=472,u=629):l&&(c=488,u=651),(0,L.useEffect)(()=>{let a=new n$(o.current,{width:c,height:u});return sZ.fromURL(`/apparels/${e}/${e}-${r}-${t}-${i}.png`).then(e=>{e.scaleToWidth(c),e.scaleToHeight(u),a.set("backgroundImage",e),a.renderAll()}),n({type:"canvas-updated",payload:a}),a.on("mouse:down",e=>{e.target&&s({type:"object-selected",payload:e.target})}),a.on("selection:updated",e=>{s({type:"object-selected",payload:e.selected?.[0]||null})}),a.on("selection:cleared",()=>{s({type:"object-selected",payload:null})}),()=>{a.dispose()}},[e,t,n,s,r,i]),R.jsx("canvas",{ref:o})};var ln=r(8465),ls=r.n(ln);function lo({onFocus:e}){let[t,r]=(0,L.useState)(!0),i=az();return t?L.createElement(a_,{as:"button",type:"button",features:ax.Focusable,onFocus:t=>{t.preventDefault();let n,s=50;n=requestAnimationFrame(function t(){if(s--<=0){n&&cancelAnimationFrame(n);return}if(e()){if(cancelAnimationFrame(n),!i.current)return;r(!1);return}n=requestAnimationFrame(t)})}}):null}let la=L.createContext(null);function ll({children:e}){let t=L.useRef({groups:new Map,get(e,t){var r;let i=this.groups.get(e);i||(i=new Map,this.groups.set(e,i));let n=null!=(r=i.get(t))?r:0;return i.set(t,n+1),[Array.from(i.keys()).indexOf(t),function(){let e=i.get(t);e>1?i.set(t,e-1):i.delete(t)}]}});return L.createElement(la.Provider,{value:t},e)}function lh(e){let t=L.useContext(la);if(!t)throw Error("You must wrap your component in a <StableCollection>");let r=function(){var e,t,r;let i=null!=(r=null==(t=null==(e=L.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)?void 0:e.ReactCurrentOwner)?void 0:t.current)?r:null;if(!i)return Symbol();let n=[],s=i;for(;s;)n.push(s.index),s=s.return;return"$."+n.join(".")}(),[i,n]=t.current.get(e,r);return L.useEffect(()=>n,[]),i}var lc=((b=lc||{})[b.Forwards=0]="Forwards",b[b.Backwards=1]="Backwards",b),lu=((C=lu||{})[C.Less=-1]="Less",C[C.Equal=0]="Equal",C[C.Greater=1]="Greater",C),ld=((S=ld||{})[S.SetSelectedIndex=0]="SetSelectedIndex",S[S.RegisterTab=1]="RegisterTab",S[S.UnregisterTab=2]="UnregisterTab",S[S.RegisterPanel=3]="RegisterPanel",S[S.UnregisterPanel=4]="UnregisterPanel",S);let lf={0(e,t){var r;let i=af(e.tabs,e=>e.current),n=af(e.panels,e=>e.current),s=i.filter(e=>{var t;return!(null!=(t=e.current)&&t.hasAttribute("disabled"))}),o={...e,tabs:i,panels:n};if(t.index<0||t.index>i.length-1){let r=o0(Math.sign(t.index-e.selectedIndex),{[-1]:()=>1,0:()=>o0(Math.sign(t.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(0===s.length)return o;let n=o0(r,{0:()=>i.indexOf(s[0]),1:()=>i.indexOf(s[s.length-1])});return{...o,selectedIndex:-1===n?e.selectedIndex:n}}let a=i.slice(0,t.index),l=[...i.slice(t.index),...a].find(e=>s.includes(e));if(!l)return o;let h=null!=(r=i.indexOf(l))?r:e.selectedIndex;return -1===h&&(h=e.selectedIndex),{...o,selectedIndex:h}},1(e,t){var r;if(e.tabs.includes(t.tab))return e;let i=e.tabs[e.selectedIndex],n=af([...e.tabs,t.tab],e=>e.current),s=null!=(r=n.indexOf(i))?r:e.selectedIndex;return -1===s&&(s=e.selectedIndex),{...e,tabs:n,selectedIndex:s}},2:(e,t)=>({...e,tabs:e.tabs.filter(e=>e!==t.tab)}),3:(e,t)=>e.panels.includes(t.panel)?e:{...e,panels:af([...e.panels,t.panel],e=>e.current)},4:(e,t)=>({...e,panels:e.panels.filter(e=>e!==t.panel)})},lg=(0,L.createContext)(null);function lp(e){let t=(0,L.useContext)(lg);if(null===t){let t=Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,lp),t}return t}lg.displayName="TabsDataContext";let lm=(0,L.createContext)(null);function lv(e){let t=(0,L.useContext)(lm);if(null===t){let t=Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,lv),t}return t}function ly(e,t){return o0(t.type,lf,e,t)}lm.displayName="TabsActionsContext";let lx=L.Fragment,l_=o1.RenderStrategy|o1.Static,lb=Object.assign(o8(function(e,t){var r,i;let n=an(),{id:s=`headlessui-tabs-tab-${n}`,...o}=e,{orientation:a,activation:l,selectedIndex:h,tabs:c,panels:u}=lp("Tab"),d=lv("Tab"),f=lp("Tab"),g=(0,L.useRef)(null),p=oQ(g,t);oX(()=>d.registerTab(g),[d,g]);let m=lh("tabs"),v=c.indexOf(g);-1===v&&(v=m);let y=v===h,x=oH(e=>{var t;let r=e();if(r===aa.Success&&"auto"===l){let e=null==(t=oV(g))?void 0:t.activeElement,r=f.tabs.findIndex(t=>t.current===e);-1!==r&&d.change(r)}return r}),_=oH(e=>{let t=c.map(e=>e.current).filter(Boolean);if(e.key===aP.Space||e.key===aP.Enter){e.preventDefault(),e.stopPropagation(),d.change(v);return}switch(e.key){case aP.Home:case aP.PageUp:return e.preventDefault(),e.stopPropagation(),x(()=>ag(t,ao.First));case aP.End:case aP.PageDown:return e.preventDefault(),e.stopPropagation(),x(()=>ag(t,ao.Last))}if(x(()=>o0(a,{vertical:()=>e.key===aP.ArrowUp?ag(t,ao.Previous|ao.WrapAround):e.key===aP.ArrowDown?ag(t,ao.Next|ao.WrapAround):aa.Error,horizontal:()=>e.key===aP.ArrowLeft?ag(t,ao.Previous|ao.WrapAround):e.key===aP.ArrowRight?ag(t,ao.Next|ao.WrapAround):aa.Error}))===aa.Success)return e.preventDefault()}),b=(0,L.useRef)(!1),C=oH(()=>{var e;b.current||(b.current=!0,null==(e=g.current)||e.focus({preventScroll:!0}),d.change(v),oz(()=>{b.current=!1}))}),S=oH(e=>{e.preventDefault()}),w=(0,L.useMemo)(()=>({selected:y}),[y]);return o5({ourProps:{ref:p,onKeyDown:_,onMouseDown:S,onClick:C,id:s,role:"tab",type:ay(e,g),"aria-controls":null==(i=null==(r=u[v])?void 0:r.current)?void 0:i.id,"aria-selected":y,tabIndex:y?0:-1},theirProps:o,slot:w,defaultTag:"button",name:"Tabs.Tab"})}),{Group:o8(function(e,t){let{defaultIndex:r=0,vertical:i=!1,manual:n=!1,onChange:s,selectedIndex:o=null,...a}=e,l=i?"vertical":"horizontal",h=n?"manual":"auto",c=null!==o,u=oQ(t),[d,f]=(0,L.useReducer)(ly,{selectedIndex:null!=o?o:r,tabs:[],panels:[]}),g=(0,L.useMemo)(()=>({selectedIndex:d.selectedIndex}),[d.selectedIndex]),p=oY(s||(()=>{})),m=oY(d.tabs),v=(0,L.useMemo)(()=>({orientation:l,activation:h,...d}),[l,h,d]),y=oH(e=>(f({type:1,tab:e}),()=>f({type:2,tab:e}))),x=oH(e=>(f({type:3,panel:e}),()=>f({type:4,panel:e}))),_=oH(e=>{b.current!==e&&p.current(e),c||f({type:0,index:e})}),b=oY(c?e.selectedIndex:d.selectedIndex),C=(0,L.useMemo)(()=>({registerTab:y,registerPanel:x,change:_}),[]);return oX(()=>{f({type:0,index:null!=o?o:r})},[o]),oX(()=>{if(void 0===b.current||d.tabs.length<=0)return;let e=af(d.tabs,e=>e.current);e.some((e,t)=>d.tabs[t]!==e)&&_(e.indexOf(d.tabs[b.current]))}),L.createElement(ll,null,L.createElement(lm.Provider,{value:C},L.createElement(lg.Provider,{value:v},v.tabs.length<=0&&L.createElement(lo,{onFocus:()=>{var e,t;for(let r of m.current)if((null==(e=r.current)?void 0:e.tabIndex)===0)return null==(t=r.current)||t.focus(),!0;return!1}}),o5({ourProps:{ref:u},theirProps:a,slot:g,defaultTag:lx,name:"Tabs"}))))}),List:o8(function(e,t){let{orientation:r,selectedIndex:i}=lp("Tab.List");return o5({ourProps:{ref:oQ(t),role:"tablist","aria-orientation":r},theirProps:e,slot:{selectedIndex:i},defaultTag:"div",name:"Tabs.List"})}),Panels:o8(function(e,t){let{selectedIndex:r}=lp("Tab.Panels");return o5({ourProps:{ref:oQ(t)},theirProps:e,slot:(0,L.useMemo)(()=>({selectedIndex:r}),[r]),defaultTag:"div",name:"Tabs.Panels"})}),Panel:o8(function(e,t){var r,i,n,s;let o=an(),{id:a=`headlessui-tabs-panel-${o}`,tabIndex:l=0,...h}=e,{selectedIndex:c,tabs:u,panels:d}=lp("Tab.Panel"),f=lv("Tab.Panel"),g=(0,L.useRef)(null),p=oQ(g,t);oX(()=>f.registerPanel(g),[f,g]);let m=lh("panels"),v=d.indexOf(g);-1===v&&(v=m);let y=v===c,x=(0,L.useMemo)(()=>({selected:y}),[y]),_={ref:p,id:a,role:"tabpanel","aria-labelledby":null==(i=null==(r=u[v])?void 0:r.current)?void 0:i.id,tabIndex:y?l:-1};return y||null!=(n=h.unmount)&&!n||null!=(s=h.static)&&s?o5({ourProps:_,theirProps:h,slot:x,defaultTag:"div",features:l_,visible:y,name:"Tabs.Panel"}):L.createElement(a_,{as:"span","aria-hidden":"true",..._})})}),lC=({label:e="",size:t="md",placeholder:r="Type here...",value:i="",className:n="",onChange:s=e=>e})=>(0,R.jsxs)(R.Fragment,{children:[e&&R.jsx("label",{htmlFor:"input",className:"mb-2 block text-sm font-medium leading-6 text-gray-900",children:e}),R.jsx("input",{type:"text",placeholder:r,className:oM("block w-full rounded-md border-0 px-3 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400",{xs:"px-2 py-1.5 text-xs",sm:"px-3 py-2",md:"px-4 py-3"}[t],n),value:i,onChange:s})]}),lS=({...e})=>R.jsx("div",{className:"group aspect-square w-full cursor-pointer",...e,children:R.jsx("div",{className:"aspect-square w-full rounded-full bg-gray-500 group-hover:bg-gray-400",title:"circle"})}),lw=({...e})=>R.jsx("div",{className:"group flex aspect-square w-full cursor-pointer items-center justify-center",...e,children:R.jsx("div",{className:"h-1 w-full bg-gray-500 group-hover:bg-gray-400 ",title:"line"})}),lT=({...e})=>R.jsx("div",{className:"group aspect-square w-full cursor-pointer",...e,children:R.jsx("div",{className:"aspect-square w-full bg-gray-500 group-hover:bg-gray-400",title:"rectangle"})}),lO=({onClick:e=e=>e})=>(0,R.jsxs)("div",{className:"flex items-center justify-center gap-5",children:[R.jsx(lS,{onClick:()=>e("circle")}),R.jsx(lT,{onClick:()=>e("rectangle")}),R.jsx(lw,{onClick:()=>e("line")})]}),lE=ls()(async()=>{},{loadableGenerated:{modules:["/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/components/03-organisms/ApparelAssetBar/ApparelAssetBar.tsx -> emoji-picker-react"]},ssr:!1}),lP=({className:e})=>{let[t,r]=(0,L.useState)(""),{addTextToCanvas:i,addImageToCanvas:n,addCircleToCanvas:s,addRectangleToCanvas:o,addLineToCanvas:a}=oj();return R.jsx("div",{className:e,children:(0,R.jsxs)(lb.Group,{children:[R.jsx(lb.List,{className:"flex space-x-1 rounded-xl bg-blue-900/20 p-1",children:["Text","Emoji","Shape","Image"].map((e,t)=>R.jsx(lb,{className:({selected:e})=>oM("w-full rounded-lg py-2.5 text-sm font-medium leading-5","ring-white/60 ring-offset-2 ring-offset-blue-400 focus:outline-none",e?"bg-white text-gray-700 shadow":"text-blue-100 hover:bg-white/[0.12] hover:text-white"),children:e},`${e}-${t}`))}),(0,R.jsxs)(lb.Panels,{className:"my-3",children:[R.jsx(lb.Panel,{children:R.jsx(oF,{isBordered:!1,children:(0,R.jsxs)("div",{className:"flex gap-2",children:[R.jsx(lC,{placeholder:"Type your text here...",value:t,onChange:e=>r(e.target.value)}),R.jsx(oD,{className:"min-w-fit",onClick:function(){i(t),r("")},children:"+ Add Text"})]})})}),R.jsx(lb.Panel,{unmount:!1,children:R.jsx(oF,{isBordered:!1,children:R.jsx(lE,{width:"100%",lazyLoadEmojis:!0,previewConfig:{defaultCaption:"Choose your emoji"},onEmojiClick:function(e){n(e.imageUrl)}})})}),R.jsx(lb.Panel,{children:R.jsx(oF,{isBordered:!1,children:R.jsx("div",{className:"w-[200px] p-2",children:R.jsx(lO,{onClick:function(e){switch(e){case"circle":s();break;case"line":a();break;case"rectangle":o();break;default:throw Error("`shape` is not defined")}}})})})}),R.jsx(lb.Panel,{children:R.jsx(oF,{isBordered:!1,children:R.jsx("div",{className:"flex w-full items-center justify-center",children:(0,R.jsxs)("label",{className:"flex h-64 w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 hover:bg-gray-100",children:[(0,R.jsxs)("div",{className:"flex flex-col items-center justify-center pb-6 pt-5",children:[R.jsx("svg",{className:"mb-4 h-8 w-8 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 16",children:R.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"})}),R.jsx("p",{className:"mb-2 text-sm text-gray-500",children:R.jsx("span",{className:"font-semibold",children:"Click to upload"})}),R.jsx("p",{className:"text-xs text-gray-500",children:"PNG or JPG"})]}),R.jsx("input",{type:"file",className:"hidden",accept:"image/png, image/jpeg",onChange:function(e){if(e.target.files&&e.target.files[0]){let t=new FileReader;t.onload=function(e){let t=e?.target?.result;t&&n(t)},t.readAsDataURL(e.target.files[0])}}})]})})})})]})]})})};function lk(){let e=(0,L.useContext)(B.ApparelContext),{downloadCanvasAsPNG:t}=oj();return R.jsx(R.Fragment,{children:R.jsx("div",{className:"container mx-auto px-4 lg:px-0 xl:px-10 2xl:px-44",children:(0,R.jsxs)("div",{className:"py-10",children:[R.jsx(oR,{className:"mb-3 lg:mb-10"}),(0,R.jsxs)("div",{className:"flex flex-wrap",children:[R.jsx("div",{className:"flex w-full items-start justify-center lg:w-1/2 lg:pr-10",children:R.jsx(li,{apparel:e.type,color:e.color})}),(0,R.jsxs)("div",{className:"w-full lg:w-1/2",children:[R.jsx("p",{className:"text-lg text-gray-600",children:"Assets and Resources"}),R.jsx(lP,{className:"mt-3"}),R.jsx("p",{className:"mt-5 text-lg text-gray-600 lg:mt-8",children:"Change Apparel"}),R.jsx(le,{className:"mt-3"}),R.jsx("div",{className:"mt-6 flex gap-5 lg:mt-8",children:(0,R.jsxs)(oD,{variant:"primary",size:"md",onClick:function(){t()},children:[R.jsx(N,{className:"h-5 w-5"}),R.jsx("span",{className:"ml-2",children:"Save as image"})]})})]})]}),R.jsx(lt,{})]})})})}},2727:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ApparelContext:()=>o,ApparelDispatchContext:()=>a,ApparelProvider:()=>l});var i=r(3854),n=r(4218);let s={color:"black",type:"tshirt"},o=(0,n.createContext)(s),a=(0,n.createContext)(e=>e);function l({children:e}){let[t,r]=(0,n.useReducer)(h,s);return i.jsx(o.Provider,{value:t,children:i.jsx(a.Provider,{value:r,children:e})})}function h(e,t){switch(t.type){case"color-changed":return{...e,color:t.payload};case"type-changed":return{...e,type:t.payload};default:throw Error("Unknown action: "+t.type)}}},6980:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CanvasContext:()=>s,CanvasDispatchContext:()=>o,CanvasProvider:()=>a});var i=r(3854),n=r(4218);let s=(0,n.createContext)(null),o=(0,n.createContext)(e=>e);function a({children:e}){let[t,r]=(0,n.useReducer)(l,null);return i.jsx(s.Provider,{value:t,children:i.jsx(o.Provider,{value:r,children:e})})}function l(e,t){if("canvas-updated"===t.type)return t.payload;throw Error("Unknown action: "+t.type)}},4959:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ObjectContext:()=>o,ObjectDispatchContext:()=>a,ObjectProvider:()=>l});var i=r(3854),n=r(4218);let s={selectedObject:null},o=(0,n.createContext)(s),a=(0,n.createContext)(e=>e);function l({children:e}){let[t,r]=(0,n.useReducer)(h,s);return i.jsx(o.Provider,{value:t,children:i.jsx(a.Provider,{value:r,children:e})})}function h(e,t){if("object-selected"===t.type)return{...e,selectedObject:t.payload};throw Error("Unknown action: "+t.type)}},9001:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{RSC_HEADER:function(){return r},ACTION:function(){return i},NEXT_ROUTER_STATE_TREE:function(){return n},NEXT_ROUTER_PREFETCH_HEADER:function(){return s},NEXT_URL:function(){return o},RSC_CONTENT_TYPE_HEADER:function(){return a},RSC_VARY_HEADER:function(){return l},FLIGHT_PARAMETERS:function(){return h},NEXT_RSC_UNION_QUERY:function(){return c}});let r="RSC",i="Next-Action",n="Next-Router-State-Tree",s="Next-Router-Prefetch",o="Next-Url",a="text/x-component",l=r+", "+n+", "+s+", "+o,h=[[r],[n],[s]],c="_rsc";("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8712:e=>{"use strict";(()=>{"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var t={};(()=>{/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */t.parse=function(t,r){if("string"!=typeof t)throw TypeError("argument str must be a string");for(var n={},s=t.split(i),o=(r||{}).decode||e,a=0;a<s.length;a++){var l=s[a],h=l.indexOf("=");if(!(h<0)){var c=l.substr(0,h).trim(),u=l.substr(++h,l.length).trim();'"'==u[0]&&(u=u.slice(1,-1)),void 0==n[c]&&(n[c]=function(e,t){try{return t(e)}catch(t){return e}}(u,o))}}return n},t.serialize=function(e,t,i){var s=i||{},o=s.encode||r;if("function"!=typeof o)throw TypeError("option encode is invalid");if(!n.test(e))throw TypeError("argument name is invalid");var a=o(t);if(a&&!n.test(a))throw TypeError("argument val is invalid");var l=e+"="+a;if(null!=s.maxAge){var h=s.maxAge-0;if(isNaN(h)||!isFinite(h))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(h)}if(s.domain){if(!n.test(s.domain))throw TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!n.test(s.path))throw TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if("function"!=typeof s.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch("string"==typeof s.sameSite?s.sameSite.toLowerCase():s.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var e=decodeURIComponent,r=encodeURIComponent,i=/; */,n=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),e.exports=t})()},9481:(e,t)=>{"use strict";function r(e,t){void 0===t&&(t={});for(var r=function(e){for(var t=[],r=0;r<e.length;){var i=e[r];if("*"===i||"+"===i||"?"===i){t.push({type:"MODIFIER",index:r,value:e[r++]});continue}if("\\"===i){t.push({type:"ESCAPED_CHAR",index:r++,value:e[r++]});continue}if("{"===i){t.push({type:"OPEN",index:r,value:e[r++]});continue}if("}"===i){t.push({type:"CLOSE",index:r,value:e[r++]});continue}if(":"===i){for(var n="",s=r+1;s<e.length;){var o=e.charCodeAt(s);if(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||95===o){n+=e[s++];continue}break}if(!n)throw TypeError("Missing parameter name at "+r);t.push({type:"NAME",index:r,value:n}),r=s;continue}if("("===i){var a=1,l="",s=r+1;if("?"===e[s])throw TypeError('Pattern cannot start with "?" at '+s);for(;s<e.length;){if("\\"===e[s]){l+=e[s++]+e[s++];continue}if(")"===e[s]){if(0==--a){s++;break}}else if("("===e[s]&&(a++,"?"!==e[s+1]))throw TypeError("Capturing groups are not allowed at "+s);l+=e[s++]}if(a)throw TypeError("Unbalanced pattern at "+r);if(!l)throw TypeError("Missing pattern at "+r);t.push({type:"PATTERN",index:r,value:l}),r=s;continue}t.push({type:"CHAR",index:r,value:e[r++]})}return t.push({type:"END",index:r,value:""}),t}(e),i=t.prefixes,n=void 0===i?"./":i,o="[^"+s(t.delimiter||"/#?")+"]+?",a=[],l=0,h=0,c="",u=function(e){if(h<r.length&&r[h].type===e)return r[h++].value},d=function(e){var t=u(e);if(void 0!==t)return t;var i=r[h];throw TypeError("Unexpected "+i.type+" at "+i.index+", expected "+e)},f=function(){for(var e,t="";e=u("CHAR")||u("ESCAPED_CHAR");)t+=e;return t};h<r.length;){var g=u("CHAR"),p=u("NAME"),m=u("PATTERN");if(p||m){var v=g||"";-1===n.indexOf(v)&&(c+=v,v=""),c&&(a.push(c),c=""),a.push({name:p||l++,prefix:v,suffix:"",pattern:m||o,modifier:u("MODIFIER")||""});continue}var y=g||u("ESCAPED_CHAR");if(y){c+=y;continue}if(c&&(a.push(c),c=""),u("OPEN")){var v=f(),x=u("NAME")||"",_=u("PATTERN")||"",b=f();d("CLOSE"),a.push({name:x||(_?l++:""),pattern:x&&!_?o:_,prefix:v,suffix:b,modifier:u("MODIFIER")||""});continue}d("END")}return a}function i(e,t){void 0===t&&(t={});var r=o(t),i=t.encode,n=void 0===i?function(e){return e}:i,s=t.validate,a=void 0===s||s,l=e.map(function(e){if("object"==typeof e)return RegExp("^(?:"+e.pattern+")$",r)});return function(t){for(var r="",i=0;i<e.length;i++){var s=e[i];if("string"==typeof s){r+=s;continue}var o=t?t[s.name]:void 0,h="?"===s.modifier||"*"===s.modifier,c="*"===s.modifier||"+"===s.modifier;if(Array.isArray(o)){if(!c)throw TypeError('Expected "'+s.name+'" to not repeat, but got an array');if(0===o.length){if(h)continue;throw TypeError('Expected "'+s.name+'" to not be empty')}for(var u=0;u<o.length;u++){var d=n(o[u],s);if(a&&!l[i].test(d))throw TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but got "'+d+'"');r+=s.prefix+d+s.suffix}continue}if("string"==typeof o||"number"==typeof o){var d=n(String(o),s);if(a&&!l[i].test(d))throw TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but got "'+d+'"');r+=s.prefix+d+s.suffix;continue}if(!h){var f=c?"an array":"a string";throw TypeError('Expected "'+s.name+'" to be '+f)}}return r}}function n(e,t,r){void 0===r&&(r={});var i=r.decode,n=void 0===i?function(e){return e}:i;return function(r){var i=e.exec(r);if(!i)return!1;for(var s=i[0],o=i.index,a=Object.create(null),l=1;l<i.length;l++)!function(e){if(void 0!==i[e]){var r=t[e-1];"*"===r.modifier||"+"===r.modifier?a[r.name]=i[e].split(r.prefix+r.suffix).map(function(e){return n(e,r)}):a[r.name]=n(i[e],r)}}(l);return{path:s,index:o,params:a}}}function s(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function o(e){return e&&e.sensitive?"":"i"}function a(e,t,r){void 0===r&&(r={});for(var i=r.strict,n=void 0!==i&&i,a=r.start,l=r.end,h=r.encode,c=void 0===h?function(e){return e}:h,u="["+s(r.endsWith||"")+"]|$",d="["+s(r.delimiter||"/#?")+"]",f=void 0===a||a?"^":"",g=0;g<e.length;g++){var p=e[g];if("string"==typeof p)f+=s(c(p));else{var m=s(c(p.prefix)),v=s(c(p.suffix));if(p.pattern){if(t&&t.push(p),m||v){if("+"===p.modifier||"*"===p.modifier){var y="*"===p.modifier?"?":"";f+="(?:"+m+"((?:"+p.pattern+")(?:"+v+m+"(?:"+p.pattern+"))*)"+v+")"+y}else f+="(?:"+m+"("+p.pattern+")"+v+")"+p.modifier}else f+="("+p.pattern+")"+p.modifier}else f+="(?:"+m+v+")"+p.modifier}}if(void 0===l||l)n||(f+=d+"?"),f+=r.endsWith?"(?="+u+")":"$";else{var x=e[e.length-1],_="string"==typeof x?d.indexOf(x[x.length-1])>-1:void 0===x;n||(f+="(?:"+d+"(?="+u+"))?"),_||(f+="(?="+d+"|"+u+")")}return new RegExp(f,o(r))}function l(e,t,i){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\((?!\?)/g);if(r)for(var i=0;i<r.length;i++)t.push({name:i,prefix:"",suffix:"",modifier:"",pattern:""});return e}(e,t):Array.isArray(e)?RegExp("(?:"+e.map(function(e){return l(e,t,i).source}).join("|")+")",o(i)):a(r(e,i),t,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=r,t.compile=function(e,t){return i(r(e,t),t)},t.tokensToFunction=i,t.match=function(e,t){var r=[];return n(l(e,r,t),r,t)},t.regexpToFunction=n,t.tokensToRegexp=a,t.pathToRegexp=l},8531:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{fillMetadataSegment:function(){return u},normalizeMetadataRoute:function(){return d}});let i=r(4608),n=function(e){return e&&e.__esModule?e:{default:e}}(r(5585)),s=r(1239),o=r(4018),a=r(6614),l=r(1478),h=r(7819);function c(e){let t="";return(e.includes("(")&&e.includes(")")||e.includes("@"))&&(t=(0,a.djb2Hash)(e).toString(36).slice(0,6)),t}function u(e,t,r){let i=(0,l.normalizeAppPath)(e),a=(0,o.getNamedRouteRegex)(i,!1),u=(0,s.interpolateDynamicPath)(i,t,a),d=c(e),f=d?`-${d}`:"",{name:g,ext:p}=n.default.parse(r);return(0,h.normalizePathSep)(n.default.join(u,`${g}${f}${p}`))}function d(e){if(!(0,i.isMetadataRoute)(e))return e;let t=e,r="";if("/robots"===e)t+=".txt";else if("/manifest"===e)t+=".webmanifest";else if(e.endsWith("/sitemap"))t+=".xml";else{let t=e.slice(0,-(n.default.basename(e).length+1));r=c(t)}if(!t.endsWith("/route")){let{dir:s,name:o,ext:a}=n.default.parse(t),l=(0,i.isStaticMetadataRoute)(e);t=n.default.posix.join(s,`${o}${r?`-${r}`:""}${a}`,l?"":"[[...__metadata_id__]]","route")}return t}},4608:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{STATIC_METADATA_IMAGES:function(){return n},isMetadataRouteFile:function(){return a},isStaticMetadataRouteFile:function(){return l},isStaticMetadataRoute:function(){return h},isMetadataRoute:function(){return c}});let i=r(7819),n={icon:{filename:"icon",extensions:["ico","jpg","jpeg","png","svg"]},apple:{filename:"apple-icon",extensions:["jpg","jpeg","png"]},favicon:{filename:"favicon",extensions:["ico"]},openGraph:{filename:"opengraph-image",extensions:["jpg","jpeg","png","gif"]},twitter:{filename:"twitter-image",extensions:["jpg","jpeg","png","gif"]}},s=["js","jsx","ts","tsx"],o=e=>`(?:${e.join("|")})`;function a(e,t,r){let s=[RegExp(`^[\\\\/]robots${r?`\\.${o(t.concat("txt"))}$`:""}`),RegExp(`^[\\\\/]manifest${r?`\\.${o(t.concat("webmanifest","json"))}$`:""}`),RegExp("^[\\\\/]favicon\\.ico$"),RegExp(`[\\\\/]sitemap${r?`\\.${o(t.concat("xml"))}$`:""}`),RegExp(`[\\\\/]${n.icon.filename}\\d?${r?`\\.${o(t.concat(n.icon.extensions))}$`:""}`),RegExp(`[\\\\/]${n.apple.filename}\\d?${r?`\\.${o(t.concat(n.apple.extensions))}$`:""}`),RegExp(`[\\\\/]${n.openGraph.filename}\\d?${r?`\\.${o(t.concat(n.openGraph.extensions))}$`:""}`),RegExp(`[\\\\/]${n.twitter.filename}\\d?${r?`\\.${o(t.concat(n.twitter.extensions))}$`:""}`)],a=(0,i.normalizePathSep)(e);return s.some(e=>e.test(a))}function l(e){return a(e,[],!0)}function h(e){return"/robots"===e||"/manifest"===e||l(e)}function c(e){let t=e.replace(/^\/?app\//,"").replace(/\/route$/,"");return"/"!==t[0]&&(t="/"+t),!t.endsWith("/page")&&a(t,s,!1)}},4427:(e,t,r)=>{"use strict";function i(e){return function(){let{cookie:t}=e;if(!t)return{};let{parse:i}=r(8712);return i(Array.isArray(t)?t.join("; "):t)}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getCookieParser",{enumerable:!0,get:function(){return i}})},7302:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{INTERCEPTION_ROUTE_MARKERS:function(){return n},isInterceptionRouteAppPath:function(){return s},extractInterceptionRouteInformation:function(){return o}});let i=r(1478),n=["(..)(..)","(.)","(..)","(...)"];function s(e){return void 0!==e.split("/").find(e=>n.find(t=>e.startsWith(t)))}function o(e){let t,r,s;for(let i of e.split("/"))if(r=n.find(e=>i.startsWith(e))){[t,s]=e.split(r,2);break}if(!t||!r||!s)throw Error(`Invalid interception route: ${e}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`);switch(t=(0,i.normalizeAppPath)(t),r){case"(.)":s="/"===t?`/${s}`:t+"/"+s;break;case"(..)":if("/"===t)throw Error(`Invalid interception route: ${e}. Cannot use (..) marker at the root level, use (.) instead.`);s=t.split("/").slice(0,-1).concat(s).join("/");break;case"(...)":s="/"+s;break;case"(..)(..)":let o=t.split("/");if(o.length<=2)throw Error(`Invalid interception route: ${e}. Cannot use (..)(..) marker at the root level or one level up.`);s=o.slice(0,-2).concat(s).join("/");break;default:throw Error("Invariant: unexpected marker")}return{interceptingRoute:t,interceptedRoute:s}}},1239:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{normalizeVercelUrl:function(){return d},interpolateDynamicPath:function(){return f},getUtils:function(){return g}});let i=r(7310),n=r(5259),s=r(9302),o=r(4018),a=r(4893),l=r(1731),h=r(4419),c=r(1478),u=r(9368);function d(e,t,r,n,s){if(n&&t&&s){let t=(0,i.parse)(e.url,!0);for(let e of(delete t.search,Object.keys(t.query)))(e!==u.NEXT_QUERY_PARAM_PREFIX&&e.startsWith(u.NEXT_QUERY_PARAM_PREFIX)||(r||Object.keys(s.groups)).includes(e))&&delete t.query[e];e.url=(0,i.format)(t)}}function f(e,t,r){if(!r)return e;for(let i of Object.keys(r.groups)){let{optional:n,repeat:s}=r.groups[i],o=`[${s?"...":""}${i}]`;n&&(o=`[${o}]`);let a=e.indexOf(o);if(a>-1){let r;let n=t[i];r=Array.isArray(n)?n.map(e=>e&&encodeURIComponent(e)).join("/"):n?encodeURIComponent(n):"",e=e.slice(0,a)+r+e.slice(a+o.length)}}return e}function g({page:e,i18n:t,basePath:r,rewrites:i,pageIsDynamic:g,trailingSlash:p,caseSensitive:m}){let v,y,x;return g&&(v=(0,o.getNamedRouteRegex)(e,!1),x=(y=(0,a.getRouteMatcher)(v))(e)),{handleRewrites:function(o,a){let c={},u=a.pathname,d=i=>{let h=(0,s.getPathMatch)(i.source+(p?"(/)?":""),{removeUnnamedParams:!0,strict:!0,sensitive:!!m}),d=h(a.pathname);if((i.has||i.missing)&&d){let e=(0,l.matchHas)(o,a.query,i.has,i.missing);e?Object.assign(d,e):d=!1}if(d){let{parsedDestination:s,destQuery:o}=(0,l.prepareDestination)({appendParamsToQuery:!0,destination:i.destination,params:d,query:a.query});if(s.protocol)return!0;if(Object.assign(c,o,d),Object.assign(a.query,s.query),delete s.query,Object.assign(a,s),u=a.pathname,r&&(u=u.replace(RegExp(`^${r}`),"")||"/"),t){let e=(0,n.normalizeLocalePath)(u,t.locales);u=e.pathname,a.query.nextInternalLocale=e.detectedLocale||d.nextInternalLocale}if(u===e)return!0;if(g&&y){let e=y(u);if(e)return a.query={...a.query,...e},!0}}return!1};for(let e of i.beforeFiles||[])d(e);if(u!==e){let t=!1;for(let e of i.afterFiles||[])if(t=d(e))break;if(!t&&!(()=>{let t=(0,h.removeTrailingSlash)(u||"");return t===(0,h.removeTrailingSlash)(e)||(null==y?void 0:y(t))})()){for(let e of i.fallback||[])if(t=d(e))break}}return c},defaultRouteRegex:v,dynamicRouteMatcher:y,defaultRouteMatches:x,getParamsFromRouteMatches:function(e,r,i){return(0,a.getRouteMatcher)(function(){let{groups:e,routeKeys:n}=v;return{re:{exec:s=>{let o=Object.fromEntries(new URLSearchParams(s)),a=t&&i&&o["1"]===i;for(let e of Object.keys(o)){let t=o[e];if(e!==u.NEXT_QUERY_PARAM_PREFIX&&e.startsWith(u.NEXT_QUERY_PARAM_PREFIX)){let r=e.substring(u.NEXT_QUERY_PARAM_PREFIX.length);o[r]=t,delete o[e]}}let l=Object.keys(n||{}),h=e=>{if(t){let n=Array.isArray(e),s=n?e[0]:e;if("string"==typeof s&&t.locales.some(e=>e.toLowerCase()===s.toLowerCase()&&(i=e,r.locale=i,!0)))return n&&e.splice(0,1),!n||0===e.length}return!1};return l.every(e=>o[e])?l.reduce((t,r)=>{let i=null==n?void 0:n[r];return i&&!h(o[r])&&(t[e[i].pos]=o[r]),t},{}):Object.keys(o).reduce((e,t)=>{if(!h(o[t])){let r=t;return a&&(r=parseInt(t,10)-1+""),Object.assign(e,{[r]:o[t]})}return e},{})}},groups:e}}())(e.headers["x-now-route-matches"])},normalizeDynamicRouteParams:function(e,t){let r=!0;return v?{params:e=Object.keys(v.groups).reduce((i,n)=>{let s=e[n];"string"==typeof s&&(s=(0,c.normalizeRscURL)(s)),Array.isArray(s)&&(s=s.map(e=>("string"==typeof e&&(e=(0,c.normalizeRscURL)(e)),e)));let o=x[n],a=v.groups[n].optional,l=Array.isArray(o)?o.some(e=>Array.isArray(s)?s.some(t=>t.includes(e)):null==s?void 0:s.includes(e)):null==s?void 0:s.includes(o);return(l||void 0===s&&!(a&&t))&&(r=!1),a&&(!s||Array.isArray(s)&&1===s.length&&("index"===s[0]||s[0]===`[[...${n}]]`))&&(s=void 0,delete e[n]),s&&"string"==typeof s&&v.groups[n].repeat&&(s=s.split("/")),s&&(i[n]=s),i},{}),hasValidParams:r}:{params:e,hasValidParams:!1}},normalizeVercelUrl:(e,t,r)=>d(e,t,r,g,v),interpolateDynamicPath:(e,t)=>f(e,t,v)}}},9789:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"escapeStringRegexp",{enumerable:!0,get:function(){return n}});let r=/[|\\{}()[\]^$+*?.-]/,i=/[|\\{}()[\]^$+*?.-]/g;function n(e){return r.test(e)?e.replace(i,"\\$&"):e}},6614:(e,t)=>{"use strict";function r(e){let t=5381;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);t=(t<<5)+t+i&4294967295}return t>>>0}function i(e){return r(e).toString(36).slice(0,5)}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{djb2Hash:function(){return r},hexHash:function(){return i}})},5259:(e,t)=>{"use strict";function r(e,t){let r;let i=e.split("/");return(t||[]).some(t=>!!i[1]&&i[1].toLowerCase()===t.toLowerCase()&&(r=t,i.splice(1,1),e=i.join("/")||"/",!0)),{pathname:e,detectedLocale:r}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizeLocalePath",{enumerable:!0,get:function(){return r}})},5585:(e,t,r)=>{"use strict";let i;i=r(1017),e.exports=i},9701:(e,t)=>{"use strict";function r(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureLeadingSlash",{enumerable:!0,get:function(){return r}})},7819:(e,t)=>{"use strict";function r(e){return e.replace(/\\/g,"/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizePathSep",{enumerable:!0,get:function(){return r}})},1478:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{normalizeAppPath:function(){return s},normalizeRscURL:function(){return o}});let i=r(9701),n=r(2219);function s(e){return(0,i.ensureLeadingSlash)(e.split("/").reduce((e,t,r,i)=>!t||(0,n.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&r===i.length-1?e:e+"/"+t,""))}function o(e){return e.replace(/\.rsc($|\?)/,"$1")}},129:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseRelativeUrl",{enumerable:!0,get:function(){return n}}),r(351);let i=r(6024);function n(e,t){let r=new URL("http://n"),n=t?new URL(t,r):e.startsWith(".")?new URL("http://n"):r,{pathname:s,searchParams:o,search:a,hash:l,href:h,origin:c}=new URL(e,n);if(c!==r.origin)throw Error("invariant: invalid relative URL, router received "+e);return{pathname:s,query:(0,i.searchParamsToUrlQuery)(o),search:a,hash:l,href:h.slice(r.origin.length)}}},6940:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parseUrl",{enumerable:!0,get:function(){return s}});let i=r(6024),n=r(129);function s(e){if(e.startsWith("/"))return(0,n.parseRelativeUrl)(e);let t=new URL(e);return{hash:t.hash,hostname:t.hostname,href:t.href,pathname:t.pathname,port:t.port,protocol:t.protocol,query:(0,i.searchParamsToUrlQuery)(t.searchParams),search:t.search}}},9302:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getPathMatch",{enumerable:!0,get:function(){return n}});let i=r(9481);function n(e,t){let r=[],n=(0,i.pathToRegexp)(e,r,{delimiter:"/",sensitive:"boolean"==typeof(null==t?void 0:t.sensitive)&&t.sensitive,strict:null==t?void 0:t.strict}),s=(0,i.regexpToFunction)((null==t?void 0:t.regexModifier)?new RegExp(t.regexModifier(n.source),n.flags):n,r);return(e,i)=>{if("string"!=typeof e)return!1;let n=s(e);if(!n)return!1;if(null==t?void 0:t.removeUnnamedParams)for(let e of r)"number"==typeof e.name&&delete n.params[e.name];return{...i,...n.params}}}},1731:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{matchHas:function(){return c},compileNonPath:function(){return u},prepareDestination:function(){return d}});let i=r(9481),n=r(9789),s=r(6940),o=r(7302),a=r(9001),l=r(4427);function h(e){return e.replace(/__ESC_COLON_/gi,":")}function c(e,t,r,i){void 0===r&&(r=[]),void 0===i&&(i=[]);let n={},s=r=>{let i;let s=r.key;switch(r.type){case"header":s=s.toLowerCase(),i=e.headers[s];break;case"cookie":if("cookies"in e)i=e.cookies[r.key];else{let t=(0,l.getCookieParser)(e.headers)();i=t[r.key]}break;case"query":i=t[s];break;case"host":{let{host:t}=(null==e?void 0:e.headers)||{},r=null==t?void 0:t.split(":",1)[0].toLowerCase();i=r}}if(!r.value&&i)return n[function(e){let t="";for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);(i>64&&i<91||i>96&&i<123)&&(t+=e[r])}return t}(s)]=i,!0;if(i){let e=RegExp("^"+r.value+"$"),t=Array.isArray(i)?i.slice(-1)[0].match(e):i.match(e);if(t)return Array.isArray(t)&&(t.groups?Object.keys(t.groups).forEach(e=>{n[e]=t.groups[e]}):"host"===r.type&&t[0]&&(n.host=t[0])),!0}return!1},o=r.every(e=>s(e))&&!i.some(e=>s(e));return!!o&&n}function u(e,t){if(!e.includes(":"))return e;for(let r of Object.keys(t))e.includes(":"+r)&&(e=e.replace(RegExp(":"+r+"\\*","g"),":"+r+"--ESCAPED_PARAM_ASTERISKS").replace(RegExp(":"+r+"\\?","g"),":"+r+"--ESCAPED_PARAM_QUESTION").replace(RegExp(":"+r+"\\+","g"),":"+r+"--ESCAPED_PARAM_PLUS").replace(RegExp(":"+r+"(?!\\w)","g"),"--ESCAPED_PARAM_COLON"+r));return e=e.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,i.compile)("/"+e,{validate:!1})(t).slice(1)}function d(e){let t;let r=Object.assign({},e.query);delete r.__nextLocale,delete r.__nextDefaultLocale,delete r.__nextDataReq,delete r.__nextInferredLocaleFromDefault,delete r[a.NEXT_RSC_UNION_QUERY];let l=e.destination;for(let t of Object.keys({...e.params,...r}))l=l.replace(RegExp(":"+(0,n.escapeStringRegexp)(t),"g"),"__ESC_COLON_"+t);let c=(0,s.parseUrl)(l),d=c.query,f=h(""+c.pathname+(c.hash||"")),g=h(c.hostname||""),p=[],m=[];(0,i.pathToRegexp)(f,p),(0,i.pathToRegexp)(g,m);let v=[];p.forEach(e=>v.push(e.name)),m.forEach(e=>v.push(e.name));let y=(0,i.compile)(f,{validate:!1}),x=(0,i.compile)(g,{validate:!1});for(let[t,r]of Object.entries(d))Array.isArray(r)?d[t]=r.map(t=>u(h(t),e.params)):"string"==typeof r&&(d[t]=u(h(r),e.params));let _=Object.keys(e.params).filter(e=>"nextInternalLocale"!==e);if(e.appendParamsToQuery&&!_.some(e=>v.includes(e)))for(let t of _)t in d||(d[t]=e.params[t]);if((0,o.isInterceptionRouteAppPath)(f))for(let t of f.split("/")){let r=o.INTERCEPTION_ROUTE_MARKERS.find(e=>t.startsWith(e));if(r){e.params["0"]=r;break}}try{t=y(e.params);let[r,i]=t.split("#",2);c.hostname=x(e.params),c.pathname=r,c.hash=(i?"#":"")+(i||""),delete c.search}catch(e){if(e.message.match(/Expected .*? to not repeat, but got an array/))throw Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match");throw e}return c.query={...r,...c.query},{newUrl:t,destQuery:d,parsedDestination:c}}},6024:(e,t)=>{"use strict";function r(e){let t={};return e.forEach((e,r)=>{void 0===t[r]?t[r]=e:Array.isArray(t[r])?t[r].push(e):t[r]=[t[r],e]}),t}function i(e){return"string"!=typeof e&&("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function n(e){let t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[r,n]=e;Array.isArray(n)?n.forEach(e=>t.append(r,i(e))):t.set(r,i(n))}),t}function s(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return r.forEach(t=>{Array.from(t.keys()).forEach(t=>e.delete(t)),t.forEach((t,r)=>e.append(r,t))}),e}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{searchParamsToUrlQuery:function(){return r},urlQueryToSearchParams:function(){return n},assign:function(){return s}})},4419:(e,t)=>{"use strict";function r(e){return e.replace(/\/$/,"")||"/"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removeTrailingSlash",{enumerable:!0,get:function(){return r}})},4893:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getRouteMatcher",{enumerable:!0,get:function(){return n}});let i=r(351);function n(e){let{re:t,groups:r}=e;return e=>{let n=t.exec(e);if(!n)return!1;let s=e=>{try{return decodeURIComponent(e)}catch(e){throw new i.DecodeError("failed to decode param")}},o={};return Object.keys(r).forEach(e=>{let t=r[e],i=n[t.pos];void 0!==i&&(o[e]=~i.indexOf("/")?i.split("/").map(e=>s(e)):t.repeat?[s(i)]:s(i))}),o}}},4018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getRouteRegex:function(){return l},getNamedRouteRegex:function(){return u},getNamedMiddlewareRegex:function(){return d}});let i=r(7302),n=r(9789),s=r(4419);function o(e){let t=e.startsWith("[")&&e.endsWith("]");t&&(e=e.slice(1,-1));let r=e.startsWith("...");return r&&(e=e.slice(3)),{key:e,repeat:r,optional:t}}function a(e){let t=(0,s.removeTrailingSlash)(e).slice(1).split("/"),r={},a=1;return{parameterizedRoute:t.map(e=>{let t=i.INTERCEPTION_ROUTE_MARKERS.find(t=>e.startsWith(t)),s=e.match(/\[((?:\[.*\])|.+)\]/);if(t&&s){let{key:e,optional:i,repeat:l}=o(s[1]);return r[e]={pos:a++,repeat:l,optional:i},"/"+(0,n.escapeStringRegexp)(t)+"([^/]+?)"}if(!s)return"/"+(0,n.escapeStringRegexp)(e);{let{key:e,repeat:t,optional:i}=o(s[1]);return r[e]={pos:a++,repeat:t,optional:i},t?i?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)"}}).join(""),groups:r}}function l(e){let{parameterizedRoute:t,groups:r}=a(e);return{re:RegExp("^"+t+"(?:/)?$"),groups:r}}function h(e){let{getSafeRouteKey:t,segment:r,routeKeys:i,keyPrefix:n}=e,{key:s,optional:a,repeat:l}=o(r),h=s.replace(/\W/g,"");n&&(h=""+n+h);let c=!1;return(0===h.length||h.length>30)&&(c=!0),isNaN(parseInt(h.slice(0,1)))||(c=!0),c&&(h=t()),n?i[h]=""+n+s:i[h]=""+s,l?a?"(?:/(?<"+h+">.+?))?":"/(?<"+h+">.+?)":"/(?<"+h+">[^/]+?)"}function c(e,t){let r;let o=(0,s.removeTrailingSlash)(e).slice(1).split("/"),a=(r=0,()=>{let e="",t=++r;for(;t>0;)e+=String.fromCharCode(97+(t-1)%26),t=Math.floor((t-1)/26);return e}),l={};return{namedParameterizedRoute:o.map(e=>{let r=i.INTERCEPTION_ROUTE_MARKERS.some(t=>e.startsWith(t)),s=e.match(/\[((?:\[.*\])|.+)\]/);return r&&s?h({getSafeRouteKey:a,segment:s[1],routeKeys:l,keyPrefix:t?"nxtI":void 0}):s?h({getSafeRouteKey:a,segment:s[1],routeKeys:l,keyPrefix:t?"nxtP":void 0}):"/"+(0,n.escapeStringRegexp)(e)}).join(""),routeKeys:l}}function u(e,t){let r=c(e,t);return{...l(e),namedRegex:"^"+r.namedParameterizedRoute+"(?:/)?$",routeKeys:r.routeKeys}}function d(e,t){let{parameterizedRoute:r}=a(e),{catchAll:i=!0}=t;if("/"===r)return{namedRegex:"^/"+(i?".*":"")+"$"};let{namedParameterizedRoute:n}=c(e,!1);return{namedRegex:"^"+n+(i?"(?:(/.*)?)":"")+"$"}}},2219:(e,t)=>{"use strict";function r(e){return"("===e[0]&&e.endsWith(")")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isGroupSegment",{enumerable:!0,get:function(){return r}})},351:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{WEB_VITALS:function(){return r},execOnce:function(){return i},isAbsoluteUrl:function(){return s},getLocationOrigin:function(){return o},getURL:function(){return a},getDisplayName:function(){return l},isResSent:function(){return h},normalizeRepeatedSlashes:function(){return c},loadGetInitialProps:function(){return u},SP:function(){return d},ST:function(){return f},DecodeError:function(){return g},NormalizeError:function(){return p},PageNotFoundError:function(){return m},MissingStaticPage:function(){return v},MiddlewareNotFoundError:function(){return y},stringifyError:function(){return x}});let r=["CLS","FCP","FID","INP","LCP","TTFB"];function i(e){let t,r=!1;return function(){for(var i=arguments.length,n=Array(i),s=0;s<i;s++)n[s]=arguments[s];return r||(r=!0,t=e(...n)),t}}let n=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,s=e=>n.test(e);function o(){let{protocol:e,hostname:t,port:r}=window.location;return e+"//"+t+(r?":"+r:"")}function a(){let{href:e}=window.location,t=o();return e.substring(t.length)}function l(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function h(e){return e.finished||e.headersSent}function c(e){let t=e.split("?"),r=t[0];return r.replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?"+t.slice(1).join("?"):"")}async function u(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await u(t.Component,t.ctx)}:{};let i=await e.getInitialProps(t);if(r&&h(r))return i;if(!i){let t='"'+l(e)+'.getInitialProps()" should resolve to an object. But found "'+i+'" instead.';throw Error(t)}return i}let d="undefined"!=typeof performance,f=d&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class g extends Error{}class p extends Error{}class m extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class v extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: "+e+" "+t}}class y extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function x(e){return JSON.stringify({message:e.message,stack:e.stack})}},8154:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w,metadata:()=>S});var i=r(4656),n=r(8242),s=r.n(n),o=r(5153);let a=(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/CanvasContext.tsx`),{__esModule:l,$$typeof:h}=a;a.default,(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/CanvasContext.tsx#CanvasContext`),(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/CanvasContext.tsx#CanvasDispatchContext`);let c=(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/CanvasContext.tsx#CanvasProvider`),u=(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ObjectContext.tsx`),{__esModule:d,$$typeof:f}=u;u.default,(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ObjectContext.tsx#ObjectContext`),(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ObjectContext.tsx#ObjectDispatchContext`);let g=(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ObjectContext.tsx#ObjectProvider`),p=(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ApparelContext.tsx`),{__esModule:m,$$typeof:v}=p;p.default,(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ApparelContext.tsx#ApparelContext`),(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ApparelContext.tsx#ApparelDispatchContext`);let y=(0,o.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/contexts/ApparelContext.tsx#ApparelProvider`);var x=r(8639),_=r.n(x);let b=()=>(0,i.jsxs)("h1",{className:"font-bold text-xl",children:[i.jsx(_(),{src:"/icons/emoji-socks.png",alt:"Logo icon",width:24,height:24,className:"inline-block mr-1.5"})," ","Apparel ",i.jsx("span",{className:"text-gray-400",children:"Customizer"})]}),C=()=>i.jsx("nav",{className:"p-4 bg-white border-b border-gray-300",children:i.jsx("div",{className:"container mx-auto lg:px-40 xl:px-64",children:i.jsx(b,{})})});r(5023);let S={title:"Apparel Customizer",description:"Design your apparel"};function w({children:e}){return i.jsx("html",{lang:"en",children:i.jsx("body",{className:s().className,children:i.jsx(y,{children:i.jsx(g,{children:(0,i.jsxs)(c,{children:[i.jsx(C,{}),e]})})})})})}},8203:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>o,__esModule:()=>s,default:()=>l});var i=r(5153);let n=(0,i.createProxy)(String.raw`/Users/sammanivisharagmail.com/Desktop/w/TshirtCustomizer2/src/app/page.tsx`),{__esModule:s,$$typeof:o}=n,a=n.default,l=a},3881:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var i=r(8531);let n=e=>{let t=(0,i.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"16x16",url:t+""}]}},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[271,558],()=>r(1538));module.exports=i})();